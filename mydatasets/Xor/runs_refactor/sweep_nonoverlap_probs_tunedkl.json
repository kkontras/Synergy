{
  "results": {
    "pu1=0.0000|pu2=0.0000|pred=0.0000|psyn=1.0000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.0,
          "syn": 1.0,
          "u1": 0.0,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.95275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.95275,
            "val_best_fusion_loss": 0.11492401838302613,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95275,
                "test_acc_syn": 0.95275,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.11492401838302613
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9495,
                "test_acc_syn": 0.9495,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.13008717715740203
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8665,
                "test_acc_syn": 0.8665,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.27994709968566894
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8535,
                "test_acc_syn": 0.8535,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.4226339864730835
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.77675,
                "test_acc_syn": 0.77675,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.6866228151321411
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.95925,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.95925,
            "val_best_fusion_loss": 0.10489784419536591,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.97225,
                "test_acc_syn": 0.97225,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.10839562863111496
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.95925,
                "test_acc_syn": 0.95925,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.10489784419536591
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.82725,
                "test_acc_syn": 0.82725,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.3763944435119629
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8635,
                "test_acc_syn": 0.8635,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.42463059186935426
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.76075,
                "test_acc_syn": 0.76075,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.6868612670898437
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.9685,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.9685,
            "val_best_fusion_loss": 0.08958127519115805,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9685,
                "test_acc_syn": 0.9685,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.08958127519115805
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.96,
                "test_acc_syn": 0.96,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.10258083373308181
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.861,
                "test_acc_syn": 0.861,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.3315326189994812
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.90525,
                "test_acc_syn": 0.90525,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.2562414073944092
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.76175,
                "test_acc_syn": 0.76175,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.6865035104751587
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.954,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.954
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.97025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.97025
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.96925,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.96925
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.954,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.954,
            "val_best_fusion_loss": 0.11162691235542298,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95325,
                "test_acc_syn": 0.95325,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.11500958025455475
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.954,
                "test_acc_syn": 0.954,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.11162691235542298
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.86025,
                "test_acc_syn": 0.86025,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.24736981242895126
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.888,
                "test_acc_syn": 0.888,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.22387696743011476
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.85725,
                "test_acc_syn": 0.85725,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.44878158807754515
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.9595,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.9595,
            "val_best_fusion_loss": 0.09740995950996875,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.972,
                "test_acc_syn": 0.972,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.10791771084070206
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9595,
                "test_acc_syn": 0.9595,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.09740995950996875
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.85575,
                "test_acc_syn": 0.85575,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.34306112766265867
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.878,
                "test_acc_syn": 0.878,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.2661500418186188
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.89025,
                "test_acc_syn": 0.89025,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.32106096267700196
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.96925,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.96925,
            "val_best_fusion_loss": 0.08707836490124464,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.96925,
                "test_acc_syn": 0.96925,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.08707836490124464
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.96275,
                "test_acc_syn": 0.96275,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.10628146678209305
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8665,
                "test_acc_syn": 0.8665,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.27759203910827634
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.90725,
                "test_acc_syn": 0.90725,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.22858749508857726
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.85475,
                "test_acc_syn": 0.85475,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.40261688470840457
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.0,
        "psyn": 1.0,
        "pu1": 0.0,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.9601666666666667,
          "test_syn_std": 0.006462498656780447,
          "test_tot_mean": 0.9601666666666667,
          "test_tot_std": 0.006462498656780447
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.9644999999999998,
          "test_syn_std": 0.007435836648734732,
          "test_tot_mean": 0.9644999999999998,
          "test_tot_std": 0.007435836648734732
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.9609166666666665,
          "test_syn_std": 0.006305861470797527,
          "test_tot_mean": 0.9609166666666665,
          "test_tot_std": 0.006305861470797527
        }
      },
      "timestamp": 1766803122.6029458
    },
    "pu1=0.0000|pu2=0.0000|pred=0.1000|psyn=0.9000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.1,
          "syn": 0.9,
          "u1": 0.0,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.87325,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8819137168141593,
            "val_best_fusion_loss": 0.27584018230438234,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8955,
                "test_acc_syn": 0.9081858407079646,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.2770058786869049
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.87325,
                "test_acc_syn": 0.8819137168141593,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.27584018230438234
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.77875,
                "test_acc_syn": 0.761891592920354,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.409376300573349
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.85475,
                "test_acc_syn": 0.8584070796460177,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.3340747618675232
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.725,
                "test_acc_syn": 0.7259402654867256,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.6867356157302856
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.881,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.9001673173452315,
            "val_best_fusion_loss": 0.2553888118267059,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8925,
                "test_acc_syn": 0.9124372559955382,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.2805639624595642
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.881,
                "test_acc_syn": 0.9001673173452315,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.2553888118267059
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.86475,
                "test_acc_syn": 0.8798103736754044,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.4348167562484741
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.82875,
                "test_acc_syn": 0.8262688232013385,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.35578237056732176
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.743,
                "test_acc_syn": 0.7529280535415505,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.6885334467887878
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.87975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8980963045912654,
            "val_best_fusion_loss": 0.236561439037323,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.87975,
                "test_acc_syn": 0.8980963045912654,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.236561439037323
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.88025,
                "test_acc_syn": 0.8992161254199328,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.26989141464233396
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8465,
                "test_acc_syn": 0.8603023516237402,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.42355873823165896
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8525,
                "test_acc_syn": 0.8563829787234043,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.40235706090927126
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7025,
                "test_acc_syn": 0.7088465845464725,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.6882725954055786
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.89525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.9087389380530974
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.8935,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.9127161182375906
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.88,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.898936170212766
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 10.0,
            "seed": 0,
            "test_acc_fusion": 0.85075,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8611725663716814,
            "val_best_fusion_loss": 0.20771189361810685,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8955,
                "test_acc_syn": 0.9087389380530974,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.2766561388969421
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.88725,
                "test_acc_syn": 0.8985066371681416,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.23402717411518098
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8385,
                "test_acc_syn": 0.8396017699115044,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.31312595784664154
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.85075,
                "test_acc_syn": 0.8611725663716814,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.20771189361810685
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8505,
                "test_acc_syn": 0.8744469026548672,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.3344544064998627
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.89175,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.9104852203011712,
            "val_best_fusion_loss": 0.2665311521291733,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.89,
                "test_acc_syn": 0.9096486335750139,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.2828042936325073
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.89175,
                "test_acc_syn": 0.9104852203011712,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.2665311521291733
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.82575,
                "test_acc_syn": 0.8262688232013385,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.32848728775978087
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.85,
                "test_acc_syn": 0.8711656441717791,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.27619974374771117
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.85375,
                "test_acc_syn": 0.884829894032348,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.3320763385295868
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.8815,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.9000559910414334,
            "val_best_fusion_loss": 0.22695729732513428,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8815,
                "test_acc_syn": 0.9000559910414334,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.22695729732513428
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8815,
                "test_acc_syn": 0.9003359462486002,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.23305987119674682
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.82625,
                "test_acc_syn": 0.8230683090705487,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.3708742100000382
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.83325,
                "test_acc_syn": 0.845464725643897,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.30527480721473693
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.847,
                "test_acc_syn": 0.8723404255319149,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.37757649779319763
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.1,
        "psyn": 0.9,
        "pu1": 0.0,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.8933924462502186,
          "test_syn_std": 0.008160604371265054,
          "test_tot_mean": 0.878,
          "test_tot_std": 0.003397302851773272
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.9067970755011513,
          "test_syn_std": 0.005790789498258127,
          "test_tot_mean": 0.8895833333333333,
          "test_tot_std": 0.006813997032253198
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.8905712592380953,
          "test_syn_std": 0.02121955956860472,
          "test_tot_mean": 0.8746666666666667,
          "test_tot_std": 0.017421650004775354
        }
      },
      "timestamp": 1766805750.1620398
    },
    "pu1=0.0000|pu2=0.0000|pred=0.2000|psyn=0.8000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.2,
          "syn": 0.8,
          "u1": 0.0,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.83975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8393194706994329,
            "val_best_fusion_loss": 0.3762210202217102,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8385,
                "test_acc_syn": 0.8301827347195967,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.4120542788505554
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.83975,
                "test_acc_syn": 0.8393194706994329,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.3762210202217102
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.78425,
                "test_acc_syn": 0.7523629489603024,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.46445488214492797
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8295,
                "test_acc_syn": 0.8210459987397606,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.474332150220871
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.70325,
                "test_acc_syn": 0.6880907372400756,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.6884983825683594
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.841,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8387806411062225,
            "val_best_fusion_loss": 0.3252406072616577,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.841,
                "test_acc_syn": 0.8387806411062225,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.3252406072616577
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.84125,
                "test_acc_syn": 0.8375235700817096,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3326144027709961
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.83975,
                "test_acc_syn": 0.8331238214959146,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.4774674463272095
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.857,
                "test_acc_syn": 0.8359522313010685,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.4311120080947876
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.71075,
                "test_acc_syn": 0.688874921433061,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.6895419692993164
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.835,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8357366771159874,
            "val_best_fusion_loss": 0.333319456577301,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.813,
                "test_acc_syn": 0.7952978056426332,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.4322572326660156
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.835,
                "test_acc_syn": 0.8357366771159874,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.333319456577301
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.81325,
                "test_acc_syn": 0.7934169278996865,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.4569753360748291
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8495,
                "test_acc_syn": 0.829153605015674,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.39290518760681153
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6995,
                "test_acc_syn": 0.6952978056426332,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.6889126777648926
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.834,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8241965973534972
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.8445,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8482086737900691
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.80625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7874608150470219
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.81275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8219911783238816,
            "val_best_fusion_loss": 0.33600767970085144,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.83425,
                "test_acc_syn": 0.8254568367989918,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.410113365650177
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.81275,
                "test_acc_syn": 0.8015122873345936,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.4059136199951172
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.81275,
                "test_acc_syn": 0.8219911783238816,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.33600767970085144
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.824,
                "test_acc_syn": 0.833648393194707,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3566416496038437
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.80125,
                "test_acc_syn": 0.8371140516698172,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.4360063052177429
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.83925,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8463230672532999,
            "val_best_fusion_loss": 0.32041272163391116,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.84075,
                "test_acc_syn": 0.8397234443746072,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.32173097372055054
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.83925,
                "test_acc_syn": 0.8463230672532999,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.32041272163391116
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8395,
                "test_acc_syn": 0.8284098051539912,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3787140643596649
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.82675,
                "test_acc_syn": 0.8419233186675047,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.3296634125709534
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.81725,
                "test_acc_syn": 0.8563796354494029,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.3975482249259949
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.8375,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8316614420062696,
            "val_best_fusion_loss": 0.318634078502655,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8135,
                "test_acc_syn": 0.7956112852664576,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.4261870527267456
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8375,
                "test_acc_syn": 0.8316614420062696,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.318634078502655
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.813,
                "test_acc_syn": 0.7974921630094044,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.38349462032318116
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.82475,
                "test_acc_syn": 0.8426332288401254,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3425437092781067
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.81175,
                "test_acc_syn": 0.8404388714733543,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.4237962901592255
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.2,
        "psyn": 0.8,
        "pu1": 0.0,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.8379455963072143,
          "test_syn_std": 0.001577355873533843,
          "test_tot_mean": 0.8385833333333332,
          "test_tot_std": 0.0025846770698784768
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.8199553620635293,
          "test_syn_std": 0.0249808812635444,
          "test_tot_mean": 0.82825,
          "test_tot_std": 0.016136139563104918
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.8333252291944836,
          "test_syn_std": 0.010002877771726032,
          "test_tot_mean": 0.8298333333333333,
          "test_tot_std": 0.012100849373310798
        }
      },
      "timestamp": 1766808327.9219751
    },
    "pu1=0.0000|pu2=0.0000|pred=0.3000|psyn=0.7000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.3,
          "syn": 0.7,
          "u1": 0.0,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.819,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7869145513049696,
            "val_best_fusion_loss": 0.36428807020187376,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.747,
                "test_acc_syn": 0.671076153021094,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.4471216559410095
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.819,
                "test_acc_syn": 0.7869145513049696,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.36428807020187376
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.81025,
                "test_acc_syn": 0.7783339292098678,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.4426393985748291
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.828,
                "test_acc_syn": 0.7808366106542725,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.5373249101638794
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.70625,
                "test_acc_syn": 0.6646406864497676,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.6856833028793335
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.79575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7519741564967696,
            "val_best_fusion_loss": 0.4482252621650696,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7995,
                "test_acc_syn": 0.7412060301507538,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.49005177021026614
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.79575,
                "test_acc_syn": 0.7519741564967696,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.4482252621650696
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.784,
                "test_acc_syn": 0.7221823402727925,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.4625976490974426
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.867,
                "test_acc_syn": 0.8219669777458722,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.48476760387420653
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.716,
                "test_acc_syn": 0.6694185211773152,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.6879754614830017
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.7705,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7421090387374462,
            "val_best_fusion_loss": 0.42137397050857545,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.63925,
                "test_acc_syn": 0.48637015781922527,
                "val_best_acc_fusion": 0.72,
                "val_best_loss_fusion": 0.5859504914283753
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7705,
                "test_acc_syn": 0.7421090387374462,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.42137397050857545
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.789,
                "test_acc_syn": 0.757532281205165,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.4715544867515564
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.82225,
                "test_acc_syn": 0.776183644189383,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.5114884066581726
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7315,
                "test_acc_syn": 0.6865136298421808,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.6895922803878785
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.7735,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7079013228459063
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.8105,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7552045944005743
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.6385,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4852941176470588
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.81,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7654629960672149,
            "val_best_fusion_loss": 0.374271445274353,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7725,
                "test_acc_syn": 0.7064712191633894,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.47698412656784056
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.81,
                "test_acc_syn": 0.7654629960672149,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.374271445274353
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.80575,
                "test_acc_syn": 0.7912048623525205,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.46322625160217284
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.80525,
                "test_acc_syn": 0.8376832320343225,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.45392215609550474
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7975,
                "test_acc_syn": 0.8537718984626386,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.5177284145355224
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.791,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7957645369705671,
            "val_best_fusion_loss": 0.3987042570114136,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.824,
                "test_acc_syn": 0.7803302225412778,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.43645325779914856
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.791,
                "test_acc_syn": 0.7957645369705671,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3987042570114136
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7985,
                "test_acc_syn": 0.7792534099066762,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.4664099073410034
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8195,
                "test_acc_syn": 0.8259152907394114,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.41470875203609464
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.78475,
                "test_acc_syn": 0.8158650394831299,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.49034619331359863
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.8115,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7733142037302726,
            "val_best_fusion_loss": 0.397018678188324,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.6385,
                "test_acc_syn": 0.4852941176470588,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.586622371673584
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8115,
                "test_acc_syn": 0.7733142037302726,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.397018678188324
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.77125,
                "test_acc_syn": 0.7840746054519369,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.4817508602142334
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.78575,
                "test_acc_syn": 0.8192252510760402,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.45227438807487486
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.81075,
                "test_acc_syn": 0.8393113342898135,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.5443828797340393
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.3,
        "psyn": 0.7,
        "pu1": 0.0,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.7603325821797284,
          "test_syn_std": 0.019222919463196084,
          "test_tot_mean": 0.7950833333333334,
          "test_tot_std": 0.019805652952853855
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.6494666782978465,
          "test_syn_std": 0.11768282833651102,
          "test_tot_mean": 0.7408333333333333,
          "test_tot_std": 0.07392037758441325
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.7781805789226849,
          "test_syn_std": 0.012840224580444495,
          "test_tot_mean": 0.8041666666666667,
          "test_tot_std": 0.009330356668185597
        }
      },
      "timestamp": 1766810896.6177857
    },
    "pu1=0.0000|pu2=0.0000|pred=0.4000|psyn=0.6000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.4,
          "syn": 0.6,
          "u1": 0.0,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.80325,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7144633236634894,
            "val_best_fusion_loss": 0.46654936313629153,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.69,
                "test_acc_syn": 0.4923331951927062,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.5087484264373779
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.693,
                "test_acc_syn": 0.49316203895565686,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.4959568417072296
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.80325,
                "test_acc_syn": 0.7144633236634894,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.46654936313629153
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.796,
                "test_acc_syn": 0.7289680895151264,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.5206649959087372
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.706,
                "test_acc_syn": 0.630335681723995,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.6872020483016967
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.78725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7103305785123967,
            "val_best_fusion_loss": 0.3983162498474121,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.683,
                "test_acc_syn": 0.4863636363636364,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.5227518963813782
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.78725,
                "test_acc_syn": 0.7103305785123967,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.3983162498474121
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8045,
                "test_acc_syn": 0.7041322314049587,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.43538856506347656
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.776,
                "test_acc_syn": 0.7016528925619835,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.5565552616119385
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.67075,
                "test_acc_syn": 0.5942148760330579,
                "val_best_acc_fusion": 0.7,
                "val_best_loss_fusion": 0.6892451071739196
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.78025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6742549668874173,
            "val_best_fusion_loss": 0.453680202960968,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.6965,
                "test_acc_syn": 0.5,
                "val_best_acc_fusion": 0.715,
                "val_best_loss_fusion": 0.5206994867324829
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.76425,
                "test_acc_syn": 0.6692880794701986,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.48935813426971436
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.78025,
                "test_acc_syn": 0.6742549668874173,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.453680202960968
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.79875,
                "test_acc_syn": 0.7052980132450332,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.5625073003768921
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6695,
                "test_acc_syn": 0.6163079470198676,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.6882229685783386
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.69375,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4956485702445089
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.678,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.47892561983471077
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.6975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5016556291390728
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.79625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8114380439287194,
            "val_best_fusion_loss": 0.4317727279663086,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.69075,
                "test_acc_syn": 0.4935764608371322,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.5095531165599823
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.78925,
                "test_acc_syn": 0.7786987152921674,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.4873276090621948
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.79625,
                "test_acc_syn": 0.8114380439287194,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.4317727279663086
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.77725,
                "test_acc_syn": 0.7961044343141318,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.5036139583587647
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7405,
                "test_acc_syn": 0.7907169498549523,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.5998119783401489
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.7835,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.687603305785124,
            "val_best_fusion_loss": 0.4200854158401489,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.68325,
                "test_acc_syn": 0.4871900826446281,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.5203823709487915
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7835,
                "test_acc_syn": 0.687603305785124,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.4200854158401489
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.76075,
                "test_acc_syn": 0.7776859504132232,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.4657206130027771
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.815,
                "test_acc_syn": 0.8367768595041323,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.45207884788513186
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.71575,
                "test_acc_syn": 0.7929752066115703,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.5737709522247314
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.7885,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7392384105960265,
            "val_best_fusion_loss": 0.331823353767395,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.696,
                "test_acc_syn": 0.4991721854304636,
                "val_best_acc_fusion": 0.725,
                "val_best_loss_fusion": 0.5206758546829223
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7885,
                "test_acc_syn": 0.7392384105960265,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.331823353767395
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.77625,
                "test_acc_syn": 0.7139900662251656,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.4901489198207855
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.82425,
                "test_acc_syn": 0.8096026490066225,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.45294688940048217
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.755,
                "test_acc_syn": 0.7793874172185431,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.5827040386199951
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.4,
        "psyn": 0.6,
        "pu1": 0.0,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.6996829563544344,
          "test_syn_std": 0.018059289057103415,
          "test_tot_mean": 0.79025,
          "test_tot_std": 0.009626352718795776
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4920766064060975,
          "test_syn_std": 0.009617086356802158,
          "test_tot_mean": 0.6897500000000001,
          "test_tot_std": 0.008448372624357879
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.7460932534366232,
          "test_syn_std": 0.05078715221753218,
          "test_tot_mean": 0.7894166666666665,
          "test_tot_std": 0.005245368327285422
        }
      },
      "timestamp": 1766813448.4203234
    },
    "pu1=0.0000|pu2=0.0000|pred=0.5000|psyn=0.5000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.5,
          "syn": 0.5,
          "u1": 0.0,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.8075,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6271617497456765,
            "val_best_fusion_loss": 0.3657869458198547,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.75225,
                "test_acc_syn": 0.5,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.4371102261543274
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.794,
                "test_acc_syn": 0.633265513733469,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.37240920186042786
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8075,
                "test_acc_syn": 0.6271617497456765,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.3657869458198547
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.812,
                "test_acc_syn": 0.6561546286876907,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.4577790558338165
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6705,
                "test_acc_syn": 0.5544252288911495,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.6864696073532105
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 1,
            "test_acc_fusion": 0.7785,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6116267708842208,
            "val_best_fusion_loss": 0.434717698097229,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.736,
                "test_acc_syn": 0.4924279433317049,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.4727525520324707
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.745,
                "test_acc_syn": 0.5056179775280899,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.45490919589996337
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7785,
                "test_acc_syn": 0.6116267708842208,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.434717698097229
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.788,
                "test_acc_syn": 0.6380068392769908,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.5407627105712891
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.67125,
                "test_acc_syn": 0.5490962383976551,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.687513575553894
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.7555,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5177411294352824,
            "val_best_fusion_loss": 0.42114782214164737,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7555,
                "test_acc_syn": 0.5177411294352824,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.42114782214164737
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.75325,
                "test_acc_syn": 0.5142428785607196,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.4294260859489441
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.73775,
                "test_acc_syn": 0.5177411294352824,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.43986342430114744
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.81225,
                "test_acc_syn": 0.6941529235382309,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.49254477739334107
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.686,
                "test_acc_syn": 0.6186906546726637,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.6867478775978089
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.752,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49949135300101727
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.73525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49096238397655106
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.756,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5177411294352824
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.75075,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49745676500508645,
            "val_best_fusion_loss": 0.4333882641792297,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.751,
                "test_acc_syn": 0.49745676500508645,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.43745615720748904
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.75075,
                "test_acc_syn": 0.49745676500508645,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.4333882641792297
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.795,
                "test_acc_syn": 0.6902339776195321,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.5128682088851929
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.70375,
                "test_acc_syn": 0.8006103763987793,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.4988464164733887
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.699,
                "test_acc_syn": 0.7604272634791455,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.6090993690490722
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.73525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49145090376160233,
            "val_best_fusion_loss": 0.472180655002594,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.73525,
                "test_acc_syn": 0.49145090376160233,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.472180655002594
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7435,
                "test_acc_syn": 0.5036638983878847,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.4724344515800476
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7965,
                "test_acc_syn": 0.6595017098192477,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.5275173175334931
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.764,
                "test_acc_syn": 0.8163165608207132,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.47890165328979495
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.728,
                "test_acc_syn": 0.7313141182217879,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.6488328909873963
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.75675,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.519240379810095,
            "val_best_fusion_loss": 0.42131638765335083,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.75675,
                "test_acc_syn": 0.519240379810095,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.42131638765335083
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7615,
                "test_acc_syn": 0.5287356321839081,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.42355403661727903
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.79625,
                "test_acc_syn": 0.6831584207896052,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.45922514200210574
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.75225,
                "test_acc_syn": 0.8370814592703648,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.4773322582244873
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.66125,
                "test_acc_syn": 0.7701149425287356,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.6425560927391052
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.5,
        "psyn": 0.5,
        "pu1": 0.0,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5855098833550599,
          "test_syn_std": 0.048337610601104315,
          "test_tot_mean": 0.7805,
          "test_tot_std": 0.021275964529643948
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5027316221376169,
          "test_syn_std": 0.011169894363692702,
          "test_tot_mean": 0.7477499999999999,
          "test_tot_std": 0.008988418474162574
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5027160161922613,
          "test_syn_std": 0.011938970839224685,
          "test_tot_mean": 0.7475833333333334,
          "test_tot_std": 0.009058452161134161
        }
      },
      "timestamp": 1766816020.9252362
    },
    "pu1=0.0000|pu2=0.0000|pred=0.6000|psyn=0.4000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.6,
          "syn": 0.4,
          "u1": 0.0,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.78825,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5130272952853598,
            "val_best_fusion_loss": 0.3652876538038254,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8,
                "test_acc_syn": 0.5049627791563276,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.4312009787559509
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.79875,
                "test_acc_syn": 0.5099255583126551,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.41918579816818236
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.78825,
                "test_acc_syn": 0.5130272952853598,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.3652876538038254
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.82625,
                "test_acc_syn": 0.5825062034739454,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.3925319397449493
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.72575,
                "test_acc_syn": 0.5583126550868487,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.6853023743629456
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.7985,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5031133250311333,
            "val_best_fusion_loss": 0.3795186543464661,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.79575,
                "test_acc_syn": 0.4931506849315068,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.3839832258224487
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7985,
                "test_acc_syn": 0.5031133250311333,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.3795186543464661
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7855,
                "test_acc_syn": 0.523038605230386,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.43034424901008606
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.80825,
                "test_acc_syn": 0.5803237858032378,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.49518048763275146
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.70475,
                "test_acc_syn": 0.5217932752179327,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.6871469306945801
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.79475,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4971892567145534,
            "val_best_fusion_loss": 0.36008156776428224,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.79975,
                "test_acc_syn": 0.5065584009993754,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.3730586963891983
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.79475,
                "test_acc_syn": 0.4971892567145534,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.36008156776428224
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.78225,
                "test_acc_syn": 0.5115552779512804,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.38956899762153624
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.82075,
                "test_acc_syn": 0.6396002498438476,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.43758673906326295
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.66225,
                "test_acc_syn": 0.5446595877576514,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.6850844573974609
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.80025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5055831265508685
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.79575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4937733499377335
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.79975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5065584009993754
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.80025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5055831265508685,
            "val_best_fusion_loss": 0.43068138301372527,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.80025,
                "test_acc_syn": 0.5055831265508685,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.43068138301372527
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7965,
                "test_acc_syn": 0.5055831265508685,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.4389519184827805
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.81175,
                "test_acc_syn": 0.6327543424317618,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.5189748311042786
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.68325,
                "test_acc_syn": 0.782258064516129,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.616428370475769
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.66625,
                "test_acc_syn": 0.7810173697270472,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.6800440788269043
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.7945,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49066002490660027,
            "val_best_fusion_loss": 0.38253830671310424,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7945,
                "test_acc_syn": 0.49066002490660027,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.38253830671310424
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.79475,
                "test_acc_syn": 0.4912826899128269,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.3857986617088318
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.79425,
                "test_acc_syn": 0.4925280199252802,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.5284455323219299
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.6385,
                "test_acc_syn": 0.772104607721046,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.608477177619934
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.637,
                "test_acc_syn": 0.6581569115815691,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.6698692655563354
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.7995,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5053091817613992,
            "val_best_fusion_loss": 0.3731008106470108,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7995,
                "test_acc_syn": 0.5053091817613992,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.3731008106470108
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.797,
                "test_acc_syn": 0.49594003747657717,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.38341578125953674
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7965,
                "test_acc_syn": 0.49656464709556525,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.5188414478302001
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.716,
                "test_acc_syn": 0.7838850718301061,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.5688016819953918
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.60425,
                "test_acc_syn": 0.6964397251717677,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.6820631980895996
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.6,
        "psyn": 0.4,
        "pu1": 0.0,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5044432923436822,
          "test_syn_std": 0.006533884818489159,
          "test_tot_mean": 0.7938333333333333,
          "test_tot_std": 0.004234448671970823
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5019716258293258,
          "test_syn_std": 0.005810713424842969,
          "test_tot_mean": 0.7985833333333333,
          "test_tot_std": 0.0020138409955991125
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5005174444062893,
          "test_syn_std": 0.006971145330649594,
          "test_tot_mean": 0.7980833333333334,
          "test_tot_std": 0.0025522321385189357
        }
      },
      "timestamp": 1766818610.5768132
    },
    "pu1=0.0000|pu2=0.0000|pred=0.7000|psyn=0.3000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.7,
          "syn": 0.3,
          "u1": 0.0,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.84025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4890446976336547,
            "val_best_fusion_loss": 0.28472190141677856,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.85375,
                "test_acc_syn": 0.49079754601226994,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.3540796709060669
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8435,
                "test_acc_syn": 0.5021910604732691,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3085895252227783
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.84025,
                "test_acc_syn": 0.4890446976336547,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.28472190141677856
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.86425,
                "test_acc_syn": 0.537248028045574,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.30766850590705874
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7545,
                "test_acc_syn": 0.5074496056091148,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.6837110853195191
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 1,
            "test_acc_fusion": 0.8385,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5008077544426495,
            "val_best_fusion_loss": 0.24849833965301513,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.84575,
                "test_acc_syn": 0.5040387722132472,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.33900609582662583
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.82125,
                "test_acc_syn": 0.4862681744749596,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.26738214135169985
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8385,
                "test_acc_syn": 0.5008077544426495,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.24849833965301513
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.839,
                "test_acc_syn": 0.4878836833602585,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.2705739665031433
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7585,
                "test_acc_syn": 0.5169628432956381,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.6860576868057251
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.838,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5074503311258278,
            "val_best_fusion_loss": 0.26471321016550065,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.84475,
                "test_acc_syn": 0.49503311258278143,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.3281488597393036
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.82425,
                "test_acc_syn": 0.4793046357615894,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.3189037227630615
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.838,
                "test_acc_syn": 0.5074503311258278,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.26471321016550065
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.834,
                "test_acc_syn": 0.5422185430463576,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.34238352537155153
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.719,
                "test_acc_syn": 0.5132450331125827,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.684841296672821
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.8535,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49079754601226994
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.846,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5048465266558966
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.84375,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4917218543046358
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.85425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49079754601226994,
            "val_best_fusion_loss": 0.35177220821380617,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.85425,
                "test_acc_syn": 0.4925503943908852,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.35404483556747435
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.85425,
                "test_acc_syn": 0.49079754601226994,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.35177220821380617
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8555,
                "test_acc_syn": 0.5013146362839614,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.5034653902053833
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8385,
                "test_acc_syn": 0.537248028045574,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.6624513435363769
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.75725,
                "test_acc_syn": 0.5723049956178791,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.690471420288086
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.84475,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5024232633279483,
            "val_best_fusion_loss": 0.31242681086063384,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.84675,
                "test_acc_syn": 0.5072697899838449,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.339339839220047
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.84475,
                "test_acc_syn": 0.5024232633279483,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.31242681086063384
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.83875,
                "test_acc_syn": 0.48707592891760904,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.49324783086776736
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.82925,
                "test_acc_syn": 0.5630048465266559,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.6592751073837281
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.82525,
                "test_acc_syn": 0.5,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.689802815914154
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.844,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4917218543046358,
            "val_best_fusion_loss": 0.3282327198982239,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.844,
                "test_acc_syn": 0.4917218543046358,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.3282327198982239
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.84575,
                "test_acc_syn": 0.4991721854304636,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.33052331387996675
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8435,
                "test_acc_syn": 0.49420529801324503,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.48333505034446717
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.594,
                "test_acc_syn": 0.7102649006622517,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.6619867730140686
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6825,
                "test_acc_syn": 0.7210264900662252,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.6863573598861694
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.7,
        "psyn": 0.3,
        "pu1": 0.0,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.49910092773404396,
          "test_syn_std": 0.00761037796354241,
          "test_tot_mean": 0.8389166666666666,
          "test_tot_std": 0.00096465307523255
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.49578864232426745,
          "test_syn_std": 0.006415997603839623,
          "test_tot_mean": 0.84775,
          "test_tot_std": 0.004168333000133287
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.494980887881618,
          "test_syn_std": 0.005276065495419798,
          "test_tot_mean": 0.8476666666666666,
          "test_tot_std": 0.004665178334092787
        }
      },
      "timestamp": 1766821163.4742413
    },
    "pu1=0.0000|pu2=0.0000|pred=0.8000|psyn=0.2000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.8,
          "syn": 0.2,
          "u1": 0.0,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.881,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4882860665844636,
            "val_best_fusion_loss": 0.18722488939762116,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.89825,
                "test_acc_syn": 0.5129469790382244,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.21378889799118042
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.881,
                "test_acc_syn": 0.4882860665844636,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.18722488939762116
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.88675,
                "test_acc_syn": 0.48581997533908755,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.20111615896224977
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.88975,
                "test_acc_syn": 0.4833538840937115,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.2701404070854187
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7695,
                "test_acc_syn": 0.5030826140567201,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.6816056966781616
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 1,
            "test_acc_fusion": 0.896,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5146341463414634,
            "val_best_fusion_loss": 0.2148787796497345,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9,
                "test_acc_syn": 0.525609756097561,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.22210408210754395
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.89775,
                "test_acc_syn": 0.5195121951219512,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.21506818056106566
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.896,
                "test_acc_syn": 0.5146341463414634,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.2148787796497345
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.89975,
                "test_acc_syn": 0.5170731707317073,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.25004701018333436
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8205,
                "test_acc_syn": 0.5109756097560976,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.684960834980011
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.89625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5091575091575091,
            "val_best_fusion_loss": 0.23695172548294066,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.88975,
                "test_acc_syn": 0.47496947496947495,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.26547672510147097
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.89075,
                "test_acc_syn": 0.4713064713064713,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.253881967663765
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.89625,
                "test_acc_syn": 0.5091575091575091,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.23695172548294066
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.89575,
                "test_acc_syn": 0.503052503052503,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.28271305561065674
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7385,
                "test_acc_syn": 0.4822954822954823,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.6838998436927796
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.89825,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5129469790382244
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.899,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5207317073170732
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.89,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.47496947496947495
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.89875,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5080147965474723,
            "val_best_fusion_loss": 0.1903979194164276,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.89675,
                "test_acc_syn": 0.5067817509247842,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.21573179811239243
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.89875,
                "test_acc_syn": 0.5080147965474723,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.1903979194164276
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8915,
                "test_acc_syn": 0.5006165228113441,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.46000988245010377
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.861,
                "test_acc_syn": 0.5117139334155364,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.6577252268791198
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.89125,
                "test_acc_syn": 0.5203452527743526,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.6897332453727723
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.89925,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5158536585365854,
            "val_best_fusion_loss": 0.2181837147474289,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.899,
                "test_acc_syn": 0.5207317073170732,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.2223571014404297
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.89925,
                "test_acc_syn": 0.5158536585365854,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.2181837147474289
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.894,
                "test_acc_syn": 0.501219512195122,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.47186422944068906
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8995,
                "test_acc_syn": 0.5853658536585366,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.657123761177063
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.89575,
                "test_acc_syn": 0.5353658536585366,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.6895848989486695
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.89425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49206349206349204,
            "val_best_fusion_loss": 0.2597692322731018,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8905,
                "test_acc_syn": 0.47741147741147744,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.26530200719833374
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.89425,
                "test_acc_syn": 0.49206349206349204,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.2597692322731018
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.89075,
                "test_acc_syn": 0.4822954822954823,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.4691358709335327
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.89225,
                "test_acc_syn": 0.525030525030525,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.6586208820343018
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8865,
                "test_acc_syn": 0.4884004884004884,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.689661226272583
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.8,
        "psyn": 0.2,
        "pu1": 0.0,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5040259073611454,
          "test_syn_std": 0.01135210199236654,
          "test_tot_mean": 0.8910833333333334,
          "test_tot_std": 0.007130723821760468
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5028827204415909,
          "test_syn_std": 0.019991872568351804,
          "test_tot_mean": 0.89575,
          "test_tot_std": 0.00407737660757502
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5053106490491833,
          "test_syn_std": 0.009898731079411166,
          "test_tot_mean": 0.8974166666666666,
          "test_tot_std": 0.002248456260538687
        }
      },
      "timestamp": 1766823719.845309
    },
    "pu1=0.0000|pu2=0.0000|pred=0.9000|psyn=0.1000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.9,
          "syn": 0.1,
          "u1": 0.0,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.945,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.47593582887700536,
            "val_best_fusion_loss": 0.07569477632641793,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.94225,
                "test_acc_syn": 0.446524064171123,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.11189246900379658
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.945,
                "test_acc_syn": 0.47593582887700536,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.07569477632641793
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.94225,
                "test_acc_syn": 0.45187165775401067,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.09632098972797394
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.94975,
                "test_acc_syn": 0.48128342245989303,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.14607373952865602
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.776,
                "test_acc_syn": 0.4732620320855615,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.682182388305664
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.9425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49873417721518987,
            "val_best_fusion_loss": 0.08929196938872337,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95025,
                "test_acc_syn": 0.5367088607594936,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.11871568903326989
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9425,
                "test_acc_syn": 0.49873417721518987,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.08929196938872337
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.94525,
                "test_acc_syn": 0.5367088607594936,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.11711208522319794
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.95075,
                "test_acc_syn": 0.5063291139240507,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.11307351112365722
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.85025,
                "test_acc_syn": 0.5113924050632911,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.6838764810562133
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.9425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4533678756476684,
            "val_best_fusion_loss": 0.13994207084178925,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.951,
                "test_acc_syn": 0.5077720207253886,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.16806686639785767
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.94725,
                "test_acc_syn": 0.49740932642487046,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.18044917345046996
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9425,
                "test_acc_syn": 0.4533678756476684,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.13994207084178925
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.95125,
                "test_acc_syn": 0.5,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.14462886333465577
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7615,
                "test_acc_syn": 0.5103626943005182,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.6829774093627929
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.9425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.446524064171123
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.95075,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5417721518987342
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.95125,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5103626943005182
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.9475,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4732620320855615,
            "val_best_fusion_loss": 0.10907908305525779,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.94225,
                "test_acc_syn": 0.446524064171123,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.11203853636980057
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9475,
                "test_acc_syn": 0.4732620320855615,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.10907908305525779
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.945,
                "test_acc_syn": 0.48128342245989303,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.4255106163024902
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9295,
                "test_acc_syn": 0.4385026737967914,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.6497413492202759
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.93975,
                "test_acc_syn": 0.44919786096256686,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.6890590643882751
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.94325,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5139240506329114,
            "val_best_fusion_loss": 0.11904849663376808,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95025,
                "test_acc_syn": 0.5367088607594936,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.11970860749483109
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.94325,
                "test_acc_syn": 0.5139240506329114,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.11904849663376808
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.941,
                "test_acc_syn": 0.5113924050632911,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.4310792136192322
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.94375,
                "test_acc_syn": 0.529113924050633,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.6525338983535767
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.9405,
                "test_acc_syn": 0.5164556962025316,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.6890822172164917
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.95125,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5103626943005182,
            "val_best_fusion_loss": 0.16822426438331603,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95125,
                "test_acc_syn": 0.5103626943005182,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.16822426438331603
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.95025,
                "test_acc_syn": 0.49222797927461137,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.1790587329864502
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.93325,
                "test_acc_syn": 0.4637305699481865,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.43474906086921694
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9485,
                "test_acc_syn": 0.5025906735751295,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.6549764251708985
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.91,
                "test_acc_syn": 0.5129533678756477,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.688589117527008
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.9,
        "psyn": 0.1,
        "pu1": 0.0,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4760126272466212,
          "test_syn_std": 0.018520794672853665,
          "test_tot_mean": 0.9433333333333334,
          "test_tot_std": 0.001178511301977554
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.49955297012345845,
          "test_syn_std": 0.03962900584613717,
          "test_tot_mean": 0.9481666666666667,
          "test_tot_std": 0.004012134372403579
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.499182925672997,
          "test_syn_std": 0.018386414513800412,
          "test_tot_mean": 0.9473333333333334,
          "test_tot_std": 0.0032681119251879317
        }
      },
      "timestamp": 1766828619.5646448
    },
    "pu1=0.0000|pu2=0.0000|pred=1.0000|psyn=0.0000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 1.0,
          "syn": 0.0,
          "u1": 0.0,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 1.0,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.0009553428971412358,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 1.0,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.0009553428971412358
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9975,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.009592968933284284
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9925,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.0237600901722908
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.99875,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.0702255204319954
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8305,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.6803695774078369
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.99925,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.0006854475076397648,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.99925,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.0006854475076397648
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 1.0,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.002775093214586377
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9885,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.03717086046934128
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9945,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.15850984334945678
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.9185,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.995,
                "val_best_loss_fusion": 0.6780418705940247
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.99975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.0004115388132049702,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.99975,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.0004115388132049702
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.999,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.014003334753215312
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.993,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.04436233907938004
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.992,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.15772506952285767
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.85975,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.6760673451423646
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.99975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.9995,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.99975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 1.0,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.00015352656556252953,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 1.0,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.00015352656556252953
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.99975,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.001159924431121908
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 1.0,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.39316575169563295
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.998,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.6471498823165893
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.9935,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.6887720394134521
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.9995,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 9.524436476567644e-05,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9995,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 9.524436476567644e-05
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.99925,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.0021204189117997887
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.995,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.40224114179611203
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.996,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.6490197372436524
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.99475,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.6884797954559326
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.99975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 2.3911019450224558e-05,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.99975,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 2.3911019450224558e-05
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 1.0,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.0022720179590396583
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.99925,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.3985166263580322
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9985,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.6487008333206177
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.993,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.995,
                "val_best_loss_fusion": 0.688594000339508
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 1.0,
        "psyn": 0.0,
        "pu1": 0.0,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9996666666666667,
          "test_tot_std": 0.00031180478223117686
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9996666666666667,
          "test_tot_std": 0.00011785113019774494
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.99975,
          "test_tot_std": 0.00020412414523190904
        }
      },
      "timestamp": 1766832610.8911107
    },
    "pu1=0.1000|pu2=0.0000|pred=0.0000|psyn=0.9000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.0,
          "syn": 0.9,
          "u1": 0.1,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.87575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8957004160887656,
            "val_best_fusion_loss": 0.39756879568099973,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.87575,
                "test_acc_syn": 0.8957004160887656,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.39756879568099973
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.84475,
                "test_acc_syn": 0.8651872399445215,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.42681346416473387
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.851,
                "test_acc_syn": 0.8715672676837726,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.49996724128723147
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.83275,
                "test_acc_syn": 0.840499306518724,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.4604483556747436
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.74125,
                "test_acc_syn": 0.7459084604715672,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.6902653026580811
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.8745,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8957475994513031,
            "val_best_fusion_loss": 0.24371217846870422,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8745,
                "test_acc_syn": 0.8957475994513031,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.24371217846870422
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.877,
                "test_acc_syn": 0.8984910836762688,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.3090492177009583
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.851,
                "test_acc_syn": 0.869684499314129,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.4648556542396545
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8345,
                "test_acc_syn": 0.8458161865569273,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.3684166669845581
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.707,
                "test_acc_syn": 0.714951989026063,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.6895173025131226
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.88725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.9136212624584718,
            "val_best_fusion_loss": 0.33480325967073443,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.88725,
                "test_acc_syn": 0.9136212624584718,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.33480325967073443
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.87775,
                "test_acc_syn": 0.9039313399778516,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.4050445657968521
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.86975,
                "test_acc_syn": 0.8939645625692137,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.47383785724639893
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.82825,
                "test_acc_syn": 0.8377630121816169,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.4557772660255432
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7145,
                "test_acc_syn": 0.7242524916943521,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.689459023475647
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.87475,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8951456310679612
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.8775,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8982167352537723
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.88675,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.9122369878183831
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 100.0,
            "seed": 0,
            "test_acc_fusion": 0.834,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8646324549237171,
            "val_best_fusion_loss": 0.38671766757965087,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8775,
                "test_acc_syn": 0.8984743411927878,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.4011275339126587
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.84475,
                "test_acc_syn": 0.8629680998613037,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.41416118025779725
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.81425,
                "test_acc_syn": 0.8246879334257975,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.42400871753692626
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8245,
                "test_acc_syn": 0.8377253814147018,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.451581814289093
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.834,
                "test_acc_syn": 0.8646324549237171,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.38671766757965087
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.87525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8957475994513031,
            "val_best_fusion_loss": 0.2478119719028473,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.87525,
                "test_acc_syn": 0.8957475994513031,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.2478119719028473
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8825,
                "test_acc_syn": 0.9020576131687242,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.27647210597991945
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8365,
                "test_acc_syn": 0.8397805212620028,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.29062541484832766
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.838,
                "test_acc_syn": 0.8518518518518519,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.33277305364608767
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8415,
                "test_acc_syn": 0.872153635116598,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.3700180542469025
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.8855,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.9161129568106312,
            "val_best_fusion_loss": 0.32490297555923464,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.88925,
                "test_acc_syn": 0.9155592469545958,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.33361794233322145
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8855,
                "test_acc_syn": 0.9161129568106312,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.32490297555923464
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.834,
                "test_acc_syn": 0.8438538205980066,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.44801425337791445
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8595,
                "test_acc_syn": 0.8809523809523809,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.39689677476882934
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8465,
                "test_acc_syn": 0.877906976744186,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.3988842153549194
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.0,
        "psyn": 0.9,
        "pu1": 0.1,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.9016897593328469,
          "test_syn_std": 0.008436868759400537,
          "test_tot_mean": 0.8791666666666668,
          "test_tot_std": 0.0057385151002289116
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.9018664513800388,
          "test_syn_std": 0.0074394865299650045,
          "test_tot_mean": 0.8796666666666667,
          "test_tot_std": 0.005132954531478181
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.8921643370618838,
          "test_syn_std": 0.02116900793842596,
          "test_tot_mean": 0.8649166666666667,
          "test_tot_std": 0.022258269374674112
        }
      },
      "timestamp": 1766837273.6967099
    },
    "pu1=0.1000|pu2=0.0000|pred=0.1000|psyn=0.8000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.1,
          "syn": 0.8,
          "u1": 0.1,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.82675,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8503422526446796,
            "val_best_fusion_loss": 0.428166937828064,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7715,
                "test_acc_syn": 0.7797137523335408,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.5266657018661499
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.82675,
                "test_acc_syn": 0.8503422526446796,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.428166937828064
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.796,
                "test_acc_syn": 0.8189172370877411,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.5059742903709412
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8115,
                "test_acc_syn": 0.8148724331051649,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.527937605381012
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.70175,
                "test_acc_syn": 0.7062850031113876,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.6897660875320435
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.84025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8620364550597108,
            "val_best_fusion_loss": 0.4063777542114258,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7925,
                "test_acc_syn": 0.8117536140791954,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.44428600192070006
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.84025,
                "test_acc_syn": 0.8620364550597108,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.4063777542114258
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7995,
                "test_acc_syn": 0.8218101822752986,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.4867938685417175
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.80625,
                "test_acc_syn": 0.8274670018856065,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.46958893060684204
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.68375,
                "test_acc_syn": 0.6822752985543683,
                "val_best_acc_fusion": 0.675,
                "val_best_loss_fusion": 0.6912719058990479
              }
            ]
          },
          {
            "best_lambda_kl": 10.0,
            "seed": 2,
            "test_acc_fusion": 0.8215,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.83234652539732,
            "val_best_fusion_loss": 0.4300182795524597,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7895,
                "test_acc_syn": 0.7990028046120287,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.4920072555541992
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.818,
                "test_acc_syn": 0.8339046431910252,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.4828500294685364
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.80475,
                "test_acc_syn": 0.8236210657525709,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.5237973499298095
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8215,
                "test_acc_syn": 0.83234652539732,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.4300182795524597
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7245,
                "test_acc_syn": 0.7307572452477408,
                "val_best_acc_fusion": 0.725,
                "val_best_loss_fusion": 0.6908803462982178
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.78,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7924704418170504
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.79775,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8152105593966059
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.795,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8027422873169212
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.794,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8251400124455507,
            "val_best_fusion_loss": 0.4036624228954315,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.77975,
                "test_acc_syn": 0.791537025513379,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.518363037109375
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.809,
                "test_acc_syn": 0.8257622899813317,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.4880136501789093
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.794,
                "test_acc_syn": 0.8251400124455507,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.4036624228954315
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7845,
                "test_acc_syn": 0.813627878033603,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.510337792634964
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.78725,
                "test_acc_syn": 0.8528313627878034,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.46395918607711795
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.81625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8403519798868636,
            "val_best_fusion_loss": 0.3982528233528137,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.794,
                "test_acc_syn": 0.8117536140791954,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.44088293552398683
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.81625,
                "test_acc_syn": 0.8403519798868636,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.3982528233528137
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.793,
                "test_acc_syn": 0.8180389692017599,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.4213585901260376
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.78875,
                "test_acc_syn": 0.835323695788812,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.40645015716552735
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.791,
                "test_acc_syn": 0.8375235700817096,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.45055278778076174
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.794,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8086631349330009,
            "val_best_fusion_loss": 0.43101322174072265,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.79475,
                "test_acc_syn": 0.8027422873169212,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.4880158519744873
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.83225,
                "test_acc_syn": 0.8585229043315674,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.437682523727417
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.794,
                "test_acc_syn": 0.8086631349330009,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.43101322174072265
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.80425,
                "test_acc_syn": 0.8373325023371767,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.4372409272193909
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.81675,
                "test_acc_syn": 0.8560299158616391,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.44102250337600707
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.1,
        "psyn": 0.8,
        "pu1": 0.1,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.8482417443672369,
          "test_syn_std": 0.012211526852585705,
          "test_tot_mean": 0.8295,
          "test_tot_std": 0.00789778449946568
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.8034744295101924,
          "test_syn_std": 0.009298037822622526,
          "test_tot_mean": 0.7909166666666666,
          "test_tot_std": 0.007800462949224356
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.8247183757551384,
          "test_syn_std": 0.012940351792011267,
          "test_tot_mean": 0.8014166666666668,
          "test_tot_std": 0.010488750587600452
        }
      },
      "timestamp": 1766844685.5938475
    },
    "pu1=0.1000|pu2=0.0000|pred=0.2000|psyn=0.7000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.2,
          "syn": 0.7,
          "u1": 0.1,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.794,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7890295358649789,
            "val_best_fusion_loss": 0.4254177439212799,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.735,
                "test_acc_syn": 0.6940928270042194,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.5639043283462525
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.794,
                "test_acc_syn": 0.7890295358649789,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.4254177439212799
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7825,
                "test_acc_syn": 0.7689873417721519,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.48946043133735656
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.79825,
                "test_acc_syn": 0.7795358649789029,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.5539540708065033
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.67925,
                "test_acc_syn": 0.6603375527426161,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.6885301876068115
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.775,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7459248759744862,
            "val_best_fusion_loss": 0.5295892977714538,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.775,
                "test_acc_syn": 0.7459248759744862,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.5295892977714538
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.79125,
                "test_acc_syn": 0.7930545712260808,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.5400516271591187
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.78475,
                "test_acc_syn": 0.7873848334514528,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.5432001209259033
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.80475,
                "test_acc_syn": 0.8104181431608788,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.5339678204059601
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.67025,
                "test_acc_syn": 0.6435152374202693,
                "val_best_acc_fusion": 0.725,
                "val_best_loss_fusion": 0.6903944492340088
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.7495,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7259735619864237,
            "val_best_fusion_loss": 0.44106403350830076,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7165,
                "test_acc_syn": 0.6702393712040015,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.5914098644256591
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7495,
                "test_acc_syn": 0.7259735619864237,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.44106403350830076
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.76125,
                "test_acc_syn": 0.7617006073597713,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.5084931492805481
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.78375,
                "test_acc_syn": 0.7681314755269739,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.5616538214683533
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.67225,
                "test_acc_syn": 0.6563058235083958,
                "val_best_acc_fusion": 0.73,
                "val_best_loss_fusion": 0.6899685406684876
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.74,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7113220815752461
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.77675,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7469879518072289
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.71625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6730975348338692
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 10.0,
            "seed": 0,
            "test_acc_fusion": 0.76875,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.789732770745429,
            "val_best_fusion_loss": 0.4788425278663635,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.749,
                "test_acc_syn": 0.7285513361462729,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.5778673791885376
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7655,
                "test_acc_syn": 0.7812939521800282,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.4821804690361023
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7695,
                "test_acc_syn": 0.8157524613220816,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.48288180470466613
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.76875,
                "test_acc_syn": 0.789732770745429,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.4788425278663635
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.756,
                "test_acc_syn": 0.8143459915611815,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.5062245118618012
              }
            ]
          },
          {
            "best_lambda_kl": 10.0,
            "seed": 1,
            "test_acc_fusion": 0.768,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8153791637136782,
            "val_best_fusion_loss": 0.49586536884307864,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.786,
                "test_acc_syn": 0.7678951098511694,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.5176650762557984
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7965,
                "test_acc_syn": 0.797661233167966,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.5386302471160889
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7545,
                "test_acc_syn": 0.8040396881644224,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.5026985412836075
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.768,
                "test_acc_syn": 0.8153791637136782,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.49586536884307864
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.74525,
                "test_acc_syn": 0.810772501771793,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.5580113959312439
              }
            ]
          },
          {
            "best_lambda_kl": 10.0,
            "seed": 2,
            "test_acc_fusion": 0.78625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8217220435869954,
            "val_best_fusion_loss": 0.43320713520050047,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.73,
                "test_acc_syn": 0.6956055734190782,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.54031325340271
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7735,
                "test_acc_syn": 0.7627724187209718,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.4607567548751831
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.78275,
                "test_acc_syn": 0.8017148981779206,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.4837845540046692
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.78625,
                "test_acc_syn": 0.8217220435869954,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.43320713520050047
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.74725,
                "test_acc_syn": 0.8088603072525902,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.5533784699440002
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.2,
        "psyn": 0.7,
        "pu1": 0.1,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.753642657941963,
          "test_syn_std": 0.026314597714530888,
          "test_tot_mean": 0.7728333333333334,
          "test_tot_std": 0.018231535560365962
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.7104691894054481,
          "test_syn_std": 0.03017166439905954,
          "test_tot_mean": 0.7443333333333334,
          "test_tot_std": 0.024888361849578523
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.808944659348701,
          "test_syn_std": 0.013829449954119135,
          "test_tot_mean": 0.7743333333333333,
          "test_tot_std": 0.008431916877093965
        }
      },
      "timestamp": 1766848462.7265475
    },
    "pu1=0.1000|pu2=0.0000|pred=0.3000|psyn=0.6000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.3,
          "syn": 0.6,
          "u1": 0.1,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.76,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7140461215932914,
            "val_best_fusion_loss": 0.514265489578247,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.67125,
                "test_acc_syn": 0.49433962264150944,
                "val_best_acc_fusion": 0.69,
                "val_best_loss_fusion": 0.5743004250526428
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.68,
                "test_acc_syn": 0.5023060796645702,
                "val_best_acc_fusion": 0.72,
                "val_best_loss_fusion": 0.5690722775459289
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.76,
                "test_acc_syn": 0.7140461215932914,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.514265489578247
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.749,
                "test_acc_syn": 0.6964360587002096,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.5711493349075317
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6975,
                "test_acc_syn": 0.6218029350104822,
                "val_best_acc_fusion": 0.72,
                "val_best_loss_fusion": 0.6894691634178162
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 1,
            "test_acc_fusion": 0.77225,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7239540607054963,
            "val_best_fusion_loss": 0.49797106981277467,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.678,
                "test_acc_syn": 0.5287120590648072,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.5611302900314331
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.75925,
                "test_acc_syn": 0.7264150943396226,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.5022990548610687
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.77225,
                "test_acc_syn": 0.7239540607054963,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.49797106981277467
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.75875,
                "test_acc_syn": 0.7083675143560295,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.544831075668335
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.67225,
                "test_acc_syn": 0.5980311730926989,
                "val_best_acc_fusion": 0.695,
                "val_best_loss_fusion": 0.6904879117012024
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.73775,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6898242746219861,
            "val_best_fusion_loss": 0.4388003349304199,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.662,
                "test_acc_syn": 0.49203105843890477,
                "val_best_acc_fusion": 0.7,
                "val_best_loss_fusion": 0.5590242981910706
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.73775,
                "test_acc_syn": 0.6898242746219861,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.4388003349304199
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.74175,
                "test_acc_syn": 0.6902329382917859,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.48596935033798216
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.743,
                "test_acc_syn": 0.7139354311401717,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.5776704168319702
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7215,
                "test_acc_syn": 0.6501838986514099,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.6882111024856568
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.66975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4914046121593291
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.68425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5356849876948319
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.66925,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49897834082550063
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.73575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7853249475890985,
            "val_best_fusion_loss": 0.5320379495620727,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.672,
                "test_acc_syn": 0.49433962264150944,
                "val_best_acc_fusion": 0.7,
                "val_best_loss_fusion": 0.5736577653884888
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.74425,
                "test_acc_syn": 0.7828092243186583,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.5556743621826172
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.73575,
                "test_acc_syn": 0.7853249475890985,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.5320379495620727
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.76525,
                "test_acc_syn": 0.8255765199161426,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.5323793363571167
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.735,
                "test_acc_syn": 0.8050314465408805,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.5930912780761719
              }
            ]
          },
          {
            "best_lambda_kl": 10.0,
            "seed": 1,
            "test_acc_fusion": 0.74275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8252666119770303,
            "val_best_fusion_loss": 0.4622339653968811,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.68475,
                "test_acc_syn": 0.538966365873667,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.5525200772285461
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.735,
                "test_acc_syn": 0.6665299425758818,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.5227229422330857
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.764,
                "test_acc_syn": 0.7456931911402789,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.5401129150390624
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.74275,
                "test_acc_syn": 0.8252666119770303,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.4622339653968811
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7355,
                "test_acc_syn": 0.8002461033634126,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.5559928369522095
              }
            ]
          },
          {
            "best_lambda_kl": 10.0,
            "seed": 2,
            "test_acc_fusion": 0.76325,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8152840212505108,
            "val_best_fusion_loss": 0.4630726289749145,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.6685,
                "test_acc_syn": 0.4973436861463016,
                "val_best_acc_fusion": 0.705,
                "val_best_loss_fusion": 0.5589942932128906
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.75675,
                "test_acc_syn": 0.765018389865141,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.48899617671966555
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7445,
                "test_acc_syn": 0.7257866775643645,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.5153293454647064
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.76325,
                "test_acc_syn": 0.8152840212505108,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.4630726289749145
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.73325,
                "test_acc_syn": 0.785042909685329,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.6125298094749451
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.3,
        "psyn": 0.6,
        "pu1": 0.1,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.7092748189735913,
          "test_syn_std": 0.014336075033358061,
          "test_tot_mean": 0.7566666666666667,
          "test_tot_std": 0.014280425608347788
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5086893135598872,
          "test_syn_std": 0.019337617191668797,
          "test_tot_mean": 0.6744166666666667,
          "test_tot_std": 0.006956212251569754
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.8086251936055465,
          "test_syn_std": 0.01697231329201669,
          "test_tot_mean": 0.7472499999999999,
          "test_tot_std": 0.011669047376142848
        }
      },
      "timestamp": 1766851491.7434108
    },
    "pu1=0.1000|pu2=0.0000|pred=0.4000|psyn=0.5000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.4,
          "syn": 0.5,
          "u1": 0.1,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.7545,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6347517730496454,
            "val_best_fusion_loss": 0.4822623240947723,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.72575,
                "test_acc_syn": 0.5,
                "val_best_acc_fusion": 0.725,
                "val_best_loss_fusion": 0.5081914907693863
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7275,
                "test_acc_syn": 0.5075987841945289,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5130867576599121
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7545,
                "test_acc_syn": 0.6347517730496454,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.4822623240947723
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.758,
                "test_acc_syn": 0.6570415400202634,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.5440384066104889
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.70975,
                "test_acc_syn": 0.5962512664640324,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.6884394288063049
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 1,
            "test_acc_fusion": 0.74525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5904040404040404,
            "val_best_fusion_loss": 0.5138300251960755,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.73625,
                "test_acc_syn": 0.5232323232323233,
                "val_best_acc_fusion": 0.71,
                "val_best_loss_fusion": 0.5590689754486085
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.73075,
                "test_acc_syn": 0.5146464646464647,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.5354073357582092
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.74525,
                "test_acc_syn": 0.5904040404040404,
                "val_best_acc_fusion": 0.73,
                "val_best_loss_fusion": 0.5138300251960755
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.745,
                "test_acc_syn": 0.6181818181818182,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.5392763936519622
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.64225,
                "test_acc_syn": 0.5267676767676768,
                "val_best_acc_fusion": 0.715,
                "val_best_loss_fusion": 0.6881840133666992
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.75725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6422155688622755,
            "val_best_fusion_loss": 0.4425949478149414,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.71325,
                "test_acc_syn": 0.49101796407185627,
                "val_best_acc_fusion": 0.73,
                "val_best_loss_fusion": 0.5511237859725953
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.72,
                "test_acc_syn": 0.5778443113772455,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.5366601800918579
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.75725,
                "test_acc_syn": 0.6422155688622755,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.4425949478149414
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.749,
                "test_acc_syn": 0.6307385229540918,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.538146767616272
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.689,
                "test_acc_syn": 0.5988023952095808,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.6882890129089355
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.7245,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49949341438703143
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.73675,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5217171717171717
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.71475,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4935129740518962
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 10.0,
            "seed": 0,
            "test_acc_fusion": 0.704,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8049645390070922,
            "val_best_fusion_loss": 0.5024708390235901,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.72475,
                "test_acc_syn": 0.49949341438703143,
                "val_best_acc_fusion": 0.725,
                "val_best_loss_fusion": 0.5080831438302994
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.72375,
                "test_acc_syn": 0.4939209726443769,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.5081809604167938
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.76425,
                "test_acc_syn": 0.7107396149949341,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.537991635799408
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.704,
                "test_acc_syn": 0.8049645390070922,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.5024708390235901
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.687,
                "test_acc_syn": 0.7299898682877406,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.6340326714515686
              }
            ]
          },
          {
            "best_lambda_kl": 10.0,
            "seed": 1,
            "test_acc_fusion": 0.7105,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7792929292929293,
            "val_best_fusion_loss": 0.524495792388916,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.73725,
                "test_acc_syn": 0.5227272727272727,
                "val_best_acc_fusion": 0.715,
                "val_best_loss_fusion": 0.5574472063779831
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.74175,
                "test_acc_syn": 0.5207070707070707,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.5466049027442932
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.74425,
                "test_acc_syn": 0.6707070707070707,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5496577274799347
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7105,
                "test_acc_syn": 0.7792929292929293,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.524495792388916
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6855,
                "test_acc_syn": 0.7414141414141414,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.6502563667297363
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.72775,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7395209580838323,
            "val_best_fusion_loss": 0.5350967168807983,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.71275,
                "test_acc_syn": 0.48952095808383234,
                "val_best_acc_fusion": 0.73,
                "val_best_loss_fusion": 0.5507856345176697
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7145,
                "test_acc_syn": 0.49151696606786427,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5401183176040649
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.72775,
                "test_acc_syn": 0.7395209580838323,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.5350967168807983
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.682,
                "test_acc_syn": 0.7654690618762475,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.5529527974128723
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.694,
                "test_acc_syn": 0.7315369261477046,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.6492750549316406
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.4,
        "psyn": 0.5,
        "pu1": 0.1,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.6224571274386538,
          "test_syn_std": 0.0228688631596112,
          "test_tot_mean": 0.7523333333333332,
          "test_tot_std": 0.005132954531478165
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5049078533853665,
          "test_syn_std": 0.012134147511204379,
          "test_tot_mean": 0.7253333333333334,
          "test_tot_std": 0.009000771571864772
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.774592808794618,
          "test_syn_std": 0.02692314890620833,
          "test_tot_mean": 0.7140833333333333,
          "test_tot_std": 0.010021504655267884
        }
      },
      "timestamp": 1766854530.1634743
    },
    "pu1=0.1000|pu2=0.0000|pred=0.5000|psyn=0.4000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.5,
          "syn": 0.4,
          "u1": 0.1,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.75825,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5019181585677749,
            "val_best_fusion_loss": 0.4111966586112976,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.78225,
                "test_acc_syn": 0.5025575447570333,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.44699756145477293
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.77375,
                "test_acc_syn": 0.5070332480818415,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.4590571814775467
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.75825,
                "test_acc_syn": 0.5019181585677749,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.4111966586112976
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.77625,
                "test_acc_syn": 0.5843989769820972,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.48763935804367065
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.711,
                "test_acc_syn": 0.5620204603580563,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.6855104160308838
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.77575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5106516290726817,
            "val_best_fusion_loss": 0.44525511264801027,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.78125,
                "test_acc_syn": 0.5231829573934837,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.4505762028694153
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.77575,
                "test_acc_syn": 0.5106516290726817,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.44525511264801027
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7615,
                "test_acc_syn": 0.5294486215538847,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.4509879457950592
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.79425,
                "test_acc_syn": 0.5645363408521303,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.4589851856231689
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.70325,
                "test_acc_syn": 0.5482456140350878,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.6880584859848022
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.76375,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4900373599003736,
            "val_best_fusion_loss": 0.4972824048995972,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.75425,
                "test_acc_syn": 0.48194271481942713,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.5117807269096375
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.76375,
                "test_acc_syn": 0.4900373599003736,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.4972824048995972
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.74,
                "test_acc_syn": 0.547945205479452,
                "val_best_acc_fusion": 0.73,
                "val_best_loss_fusion": 0.5311125302314759
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.772,
                "test_acc_syn": 0.5709838107098381,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.5397760081291199
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.69775,
                "test_acc_syn": 0.539227895392279,
                "val_best_acc_fusion": 0.725,
                "val_best_loss_fusion": 0.6882678627967834
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.783,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5031969309462916
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.78225,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5244360902255639
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.75375,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4800747198007472
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.78025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4968030690537084,
            "val_best_fusion_loss": 0.44595582187175753,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.78325,
                "test_acc_syn": 0.5051150895140665,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.44675753116607664
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.78025,
                "test_acc_syn": 0.4968030690537084,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.44595582187175753
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.78475,
                "test_acc_syn": 0.6093350383631714,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.5254219937324524
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.6655,
                "test_acc_syn": 0.7749360613810742,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.6313966369628906
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.68025,
                "test_acc_syn": 0.7742966751918159,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.6844140720367432
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.7795,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5206766917293233,
            "val_best_fusion_loss": 0.4429438900947571,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.78175,
                "test_acc_syn": 0.5238095238095238,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.4500925660133362
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7795,
                "test_acc_syn": 0.5206766917293233,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.4429438900947571
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.776,
                "test_acc_syn": 0.6641604010025063,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.5182396483421325
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.67725,
                "test_acc_syn": 0.7944862155388471,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.5677778816223145
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.60775,
                "test_acc_syn": 0.7011278195488722,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.6875731277465821
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.7535,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4794520547945205,
            "val_best_fusion_loss": 0.5121193647384643,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7535,
                "test_acc_syn": 0.4794520547945205,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.5121193647384643
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7515,
                "test_acc_syn": 0.4788293897882939,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.5157988977432251
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.757,
                "test_acc_syn": 0.4825653798256538,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.5731381368637085
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.6475,
                "test_acc_syn": 0.7658779576587795,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.6035009431838989
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.653,
                "test_acc_syn": 0.7334993773349938,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.6824892282485961
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.5,
        "psyn": 0.4,
        "pu1": 0.1,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5008690491802766,
          "test_syn_std": 0.00844837247668825,
          "test_tot_mean": 0.7659166666666667,
          "test_tot_std": 0.007306770072261017
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5025692469908676,
          "test_syn_std": 0.01811589149251515,
          "test_tot_mean": 0.773,
          "test_tot_std": 0.013615248804190093
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.49897727185918406,
          "test_syn_std": 0.016899961360529396,
          "test_tot_mean": 0.7710833333333333,
          "test_tot_std": 0.01243706378352849
        }
      },
      "timestamp": 1766859827.5047858
    },
    "pu1=0.1000|pu2=0.0000|pred=0.6000|psyn=0.3000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.6,
          "syn": 0.3,
          "u1": 0.1,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.8055,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5065897858319605,
            "val_best_fusion_loss": 0.31577993392944337,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.832,
                "test_acc_syn": 0.5296540362438221,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.3373731827735901
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.82475,
                "test_acc_syn": 0.5131795716639209,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.33735032081604005
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8055,
                "test_acc_syn": 0.5065897858319605,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.31577993392944337
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8015,
                "test_acc_syn": 0.5230642504118617,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.49071359634399414
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7235,
                "test_acc_syn": 0.5411861614497528,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.6862073278427124
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.80875,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4886267902274642,
            "val_best_fusion_loss": 0.31395898312330245,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.80875,
                "test_acc_syn": 0.4886267902274642,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.31395898312330245
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.818,
                "test_acc_syn": 0.4776748104465038,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.31630110323429106
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.799,
                "test_acc_syn": 0.5130581297388374,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.31726623952388766
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.83125,
                "test_acc_syn": 0.5551811288963774,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.3612524175643921
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.73725,
                "test_acc_syn": 0.5130581297388374,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.6860473990440369
              }
            ]
          },
          {
            "best_lambda_kl": 10.0,
            "seed": 2,
            "test_acc_fusion": 0.80825,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4859271523178808,
            "val_best_fusion_loss": 0.3187446868419647,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.81025,
                "test_acc_syn": 0.48344370860927155,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3570109236240387
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8145,
                "test_acc_syn": 0.4826158940397351,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.3484817636013031
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.79375,
                "test_acc_syn": 0.5082781456953642,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.3627947211265564
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.80825,
                "test_acc_syn": 0.4859271523178808,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3187446868419647
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.66225,
                "test_acc_syn": 0.5223509933774835,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.6862858700752258
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.8305,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5255354200988468
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.80975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4903117101937658
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.8115,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4867549668874172
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.8295,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5230642504118617,
            "val_best_fusion_loss": 0.3289358758926392,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.832,
                "test_acc_syn": 0.5296540362438221,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.3377812767028809
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8295,
                "test_acc_syn": 0.5230642504118617,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.3289358758926392
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.80675,
                "test_acc_syn": 0.5543657331136738,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.4877833414077759
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.73375,
                "test_acc_syn": 0.6812191103789127,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.6639426922798157
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.61825,
                "test_acc_syn": 0.7355848434925865,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.6880266141891479
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.81,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4860994102780118,
            "val_best_fusion_loss": 0.31387263774871826,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.81,
                "test_acc_syn": 0.4860994102780118,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.31387263774871826
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.81225,
                "test_acc_syn": 0.481044650379107,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.3325539433956146
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.813,
                "test_acc_syn": 0.4869418702611626,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.4902225208282471
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.76625,
                "test_acc_syn": 0.6183656276326874,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.6566881036758423
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.80025,
                "test_acc_syn": 0.493681550126369,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.6901111006736755
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.7995,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.472682119205298,
            "val_best_fusion_loss": 0.3486826860904694,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.81025,
                "test_acc_syn": 0.4826158940397351,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.35708117842674253
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7995,
                "test_acc_syn": 0.472682119205298,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3486826860904694
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.804,
                "test_acc_syn": 0.4768211920529801,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.5058981132507324
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.799,
                "test_acc_syn": 0.5910596026490066,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.6616354894638061
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7045,
                "test_acc_syn": 0.5778145695364238,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.6899841332435608
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.6,
        "psyn": 0.3,
        "pu1": 0.1,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.49371457612576847,
          "test_syn_std": 0.009170615389911771,
          "test_tot_mean": 0.8075,
          "test_tot_std": 0.0014288690166235185
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5008673657266766,
          "test_syn_std": 0.017503281323189523,
          "test_tot_mean": 0.81725,
          "test_tot_std": 0.009396364545219974
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.49394859329839047,
          "test_syn_std": 0.02130410041587299,
          "test_tot_mean": 0.8130000000000001,
          "test_tot_std": 0.01242980289465606
        }
      },
      "timestamp": 1766864978.0511775
    },
    "pu1=0.1000|pu2=0.0000|pred=0.7000|psyn=0.2000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.7,
          "syn": 0.2,
          "u1": 0.1,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.849,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.46622516556291393,
            "val_best_fusion_loss": 0.252044683098793,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.87675,
                "test_acc_syn": 0.4900662251655629,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.2638047671318054
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.87575,
                "test_acc_syn": 0.48874172185430464,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.2613077449798584
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.849,
                "test_acc_syn": 0.46622516556291393,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.252044683098793
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.87225,
                "test_acc_syn": 0.5006622516556292,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.35659531235694886
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.75525,
                "test_acc_syn": 0.5231788079470199,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.6806646227836609
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.86725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49680715197956576,
            "val_best_fusion_loss": 0.26388157546520236,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.87575,
                "test_acc_syn": 0.5095785440613027,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.2681053930521011
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.86725,
                "test_acc_syn": 0.49680715197956576,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.26388157546520236
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.85975,
                "test_acc_syn": 0.49936143039591313,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.31582852721214294
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.85925,
                "test_acc_syn": 0.47509578544061304,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.360581066608429
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.759,
                "test_acc_syn": 0.5057471264367817,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.6870801424980164
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.84825,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4950859950859951,
            "val_best_fusion_loss": 0.22183017253875734,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.875,
                "test_acc_syn": 0.5171990171990172,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.2680563449859619
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.84825,
                "test_acc_syn": 0.4950859950859951,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.22183017253875734
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.84875,
                "test_acc_syn": 0.4828009828009828,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.22486457228660583
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.863,
                "test_acc_syn": 0.4987714987714988,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.28568867206573484
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.76175,
                "test_acc_syn": 0.48525798525798525,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.6822696566581726
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.8765,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4913907284768212
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.87675,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5095785440613027
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.87025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.87625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48874172185430464,
            "val_best_fusion_loss": 0.26316707611083984,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.87625,
                "test_acc_syn": 0.48874172185430464,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.26316707611083984
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8735,
                "test_acc_syn": 0.48874172185430464,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.285552624464035
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.87225,
                "test_acc_syn": 0.5072847682119205,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.47672130465507506
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.87275,
                "test_acc_syn": 0.495364238410596,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.6596669292449951
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8485,
                "test_acc_syn": 0.49271523178807947,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.6896633243560791
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.87725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5108556832694764,
            "val_best_fusion_loss": 0.2630948436260223,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.87575,
                "test_acc_syn": 0.5095785440613027,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.26891206979751586
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.87725,
                "test_acc_syn": 0.5108556832694764,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.2630948436260223
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8745,
                "test_acc_syn": 0.5210727969348659,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.4835275435447693
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.84825,
                "test_acc_syn": 0.5300127713920817,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.6617412233352661
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.784,
                "test_acc_syn": 0.5632183908045977,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.6897879910469055
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.86725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5036855036855037,
            "val_best_fusion_loss": 0.25832659482955933,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.875,
                "test_acc_syn": 0.5147420147420148,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.2690338659286499
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.86725,
                "test_acc_syn": 0.5036855036855037,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.25832659482955933
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.849,
                "test_acc_syn": 0.4975429975429975,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.46205184936523436
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.86375,
                "test_acc_syn": 0.527027027027027,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.6588970947265625
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.84575,
                "test_acc_syn": 0.48402948402948404,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.6897325801849366
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.7,
        "psyn": 0.2,
        "pu1": 0.1,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.48603943754282497,
          "test_syn_std": 0.014028414636812103,
          "test_tot_mean": 0.8548333333333332,
          "test_tot_std": 0.008785246470962302
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5003230908460413,
          "test_syn_std": 0.007428658456943326,
          "test_tot_mean": 0.8744999999999999,
          "test_tot_std": 0.003006936425444796
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5010943029364282,
          "test_syn_std": 0.009212041516747996,
          "test_tot_mean": 0.8735833333333333,
          "test_tot_std": 0.004496912521077351
        }
      },
      "timestamp": 1766869573.8615875
    },
    "pu1=0.1000|pu2=0.0000|pred=0.8000|psyn=0.1000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.8,
          "syn": 0.1,
          "u1": 0.1,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.914,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5127020785219399,
            "val_best_fusion_loss": 0.12327848196029663,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.90025,
                "test_acc_syn": 0.46882217090069284,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.20651172399520873
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.914,
                "test_acc_syn": 0.5127020785219399,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.12327848196029663
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.90325,
                "test_acc_syn": 0.47575057736720555,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.15612765282392502
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.90575,
                "test_acc_syn": 0.5011547344110855,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.25189281940460206
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.79775,
                "test_acc_syn": 0.5265588914549654,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.68116943359375
              }
            ]
          },
          {
            "best_lambda_kl": 10.0,
            "seed": 1,
            "test_acc_fusion": 0.9355,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4864864864864865,
            "val_best_fusion_loss": 0.18984373092651366,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.92725,
                "test_acc_syn": 0.4864864864864865,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.2651817750930786
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.92,
                "test_acc_syn": 0.518918918918919,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.2042921531200409
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.91175,
                "test_acc_syn": 0.4243243243243243,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.21328368544578552
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9355,
                "test_acc_syn": 0.4864864864864865,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.18984373092651366
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.79625,
                "test_acc_syn": 0.4837837837837838,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.6846668672561645
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.913,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5153846153846153,
            "val_best_fusion_loss": 0.11401080012321473,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.92525,
                "test_acc_syn": 0.4794871794871795,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.14724614053964616
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.913,
                "test_acc_syn": 0.5153846153846153,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.11401080012321473
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.919,
                "test_acc_syn": 0.5076923076923077,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.15956655383110047
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.92425,
                "test_acc_syn": 0.4717948717948718,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.16915970027446747
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.793,
                "test_acc_syn": 0.5256410256410257,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.6799691319465637
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.9,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.46882217090069284
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.9275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4864864864864865
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.92575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4846153846153846
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.914,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4942263279445728,
            "val_best_fusion_loss": 0.18167130708694457,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.90025,
                "test_acc_syn": 0.47113163972286376,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.20657366275787353
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.914,
                "test_acc_syn": 0.4942263279445728,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.18167130708694457
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9045,
                "test_acc_syn": 0.5103926096997691,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.44028940200805666
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.91425,
                "test_acc_syn": 0.49884526558891457,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.6535210919380188
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8935,
                "test_acc_syn": 0.48498845265588914,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.6893107223510743
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.9275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4864864864864865,
            "val_best_fusion_loss": 0.26598588466644285,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9275,
                "test_acc_syn": 0.4864864864864865,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.26598588466644285
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9265,
                "test_acc_syn": 0.4837837837837838,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.2718843483924866
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.92775,
                "test_acc_syn": 0.4945945945945946,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.4725495386123657
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.92875,
                "test_acc_syn": 0.527027027027027,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.6576601243019105
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.9055,
                "test_acc_syn": 0.4648648648648649,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.6895479559898376
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.9235,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48717948717948717,
            "val_best_fusion_loss": 0.13581516683101655,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.92575,
                "test_acc_syn": 0.48717948717948717,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.14712342441082002
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9235,
                "test_acc_syn": 0.48717948717948717,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.13581516683101655
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9245,
                "test_acc_syn": 0.5076923076923077,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.43214638471603395
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.91775,
                "test_acc_syn": 0.5102564102564102,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.6540159559249878
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.911,
                "test_acc_syn": 0.49743589743589745,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.6891951894760132
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.8,
        "psyn": 0.1,
        "pu1": 0.1,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5048577267976806,
          "test_syn_std": 0.013036509091359156,
          "test_tot_mean": 0.9208333333333334,
          "test_tot_std": 0.010378931651293492
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.47997468066752136,
          "test_syn_std": 0.007922925012368173,
          "test_tot_mean": 0.91775,
          "test_tot_std": 0.012571462391729378
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.48929743387018215,
          "test_syn_std": 0.003496718469989359,
          "test_tot_mean": 0.9216666666666665,
          "test_tot_std": 0.00566176258382099
        }
      },
      "timestamp": 1766872606.4204283
    },
    "pu1=0.1000|pu2=0.0000|pred=0.9000|psyn=0.0000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.9,
          "syn": 0.0,
          "u1": 0.1,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.972,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.09335716811940074,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9615,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.14866717655211686
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.972,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.09335716811940074
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.97675,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.09342027902603149
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.957,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.24353978037834167
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.83525,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.6802528810501098
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.9735,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.03863001272082329,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9735,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.03863001272082329
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.973,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.99,
                "val_best_loss_fusion": 0.05668461620807648
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.974,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.995,
                "val_best_loss_fusion": 0.09566476583480835
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.973,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.995,
                "val_best_loss_fusion": 0.12873220205307007
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.82775,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.6812157940864563
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.976,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.0648686522245407,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.972,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.99,
                "val_best_loss_fusion": 0.08134740985929965
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.976,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.99,
                "val_best_loss_fusion": 0.0648686522245407
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.977,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.99,
                "val_best_loss_fusion": 0.10502180933952332
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.96425,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.2014314079284668
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.796,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.995,
                "val_best_loss_fusion": 0.6804225254058838
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.9615,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.9735,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.97225,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.97475,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.10462353658862412,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9615,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.14847165629267692
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.97475,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.10462353658862412
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.963,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.41592267274856565
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9735,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.6492158246040344
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.96575,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.6888180303573609
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.973,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.038016007393598554,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.973,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.038016007393598554
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9745,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.042887771725654604
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.971,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.4148427212238312
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.95725,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.6503637552261352
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8865,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.6886103582382203
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.06565471231937409,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.97175,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.99,
                "val_best_loss_fusion": 0.08152902349829674
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.975,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.06565471231937409
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9755,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.99,
                "val_best_loss_fusion": 0.40711899995803835
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.973,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.6522492122650146
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.9595,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.6889888262748718
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.9,
        "psyn": 0.0,
        "pu1": 0.1,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9738333333333333,
          "test_tot_std": 0.0016499158227686087
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9690833333333333,
          "test_tot_std": 0.005386454203730759
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9742500000000001,
          "test_tot_std": 0.0008897565210026152
        }
      },
      "timestamp": 1766879439.5706835
    },
    "pu1=0.2000|pu2=0.0000|pred=0.0000|psyn=0.8000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.0,
          "syn": 0.8,
          "u1": 0.2,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.84675,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.869006581009088,
            "val_best_fusion_loss": 0.39126886367797853,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8495,
                "test_acc_syn": 0.8755875900971483,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.5049500441551209
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.84675,
                "test_acc_syn": 0.869006581009088,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.39126886367797853
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8315,
                "test_acc_syn": 0.8589783766844249,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.4691678082942963
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8535,
                "test_acc_syn": 0.8539642745220933,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.40619779586791993
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.73,
                "test_acc_syn": 0.7264180507677844,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.6892261171340942
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.8275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8347286821705426,
            "val_best_fusion_loss": 0.3386256206035614,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.815,
                "test_acc_syn": 0.8229457364341085,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.39635975122451783
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8275,
                "test_acc_syn": 0.8347286821705426,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.3386256206035614
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7935,
                "test_acc_syn": 0.8034108527131782,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.4657901954650879
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8255,
                "test_acc_syn": 0.8018604651162791,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.4829580068588257
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.69075,
                "test_acc_syn": 0.6831007751937984,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.6895054912567139
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.83725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8480775242263208,
            "val_best_fusion_loss": 0.33241348683834077,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.83725,
                "test_acc_syn": 0.8480775242263208,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.33241348683834077
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.83325,
                "test_acc_syn": 0.8427633635511097,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3602818900346756
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.83075,
                "test_acc_syn": 0.8452641450453267,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.45260889172554014
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.85,
                "test_acc_syn": 0.8512035010940919,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.3984394121170044
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.73075,
                "test_acc_syn": 0.7249140356361363,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.6872030878067017
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.8495,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8755875900971483
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.816,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8248062015503876
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.833,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8449515473585495
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.8355,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8357881541836415,
            "val_best_fusion_loss": 0.3934939932823181,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.84975,
                "test_acc_syn": 0.8752742087120025,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.49864475965499877
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.82925,
                "test_acc_syn": 0.8574114697586963,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.3996903872489929
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8355,
                "test_acc_syn": 0.8357881541836415,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.3934939932823181
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.83625,
                "test_acc_syn": 0.8608586649952993,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.4115973961353302
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.80375,
                "test_acc_syn": 0.8514572234409276,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.42507866382598875
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 1,
            "test_acc_fusion": 0.79775,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8226356589147287,
            "val_best_fusion_loss": 0.32172508716583254,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8145,
                "test_acc_syn": 0.8235658914728682,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3971357405185699
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.82875,
                "test_acc_syn": 0.838139534883721,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.3413438141345978
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.79775,
                "test_acc_syn": 0.8226356589147287,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.32172508716583254
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.81075,
                "test_acc_syn": 0.8350387596899225,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3455589461326599
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7765,
                "test_acc_syn": 0.8186046511627907,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.4950584554672241
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.834,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8546420756486403,
            "val_best_fusion_loss": 0.32923887968063353,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.83375,
                "test_acc_syn": 0.8449515473585495,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.34712947249412535
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.834,
                "test_acc_syn": 0.8546420756486403,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.32923887968063353
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8455,
                "test_acc_syn": 0.8437011566114411,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.3751060891151428
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.83,
                "test_acc_syn": 0.8408877774304471,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3664960813522339
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8095,
                "test_acc_syn": 0.8446389496717724,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.42731155693531037
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.0,
        "psyn": 0.8,
        "pu1": 0.2,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.8506042624686504,
          "test_syn_std": 0.014107489542918355,
          "test_tot_mean": 0.8371666666666666,
          "test_tot_std": 0.00785900050190155
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.8484484463353619,
          "test_syn_std": 0.020878355339518335,
          "test_tot_mean": 0.8328333333333333,
          "test_tot_std": 0.01367682549261913
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.8376886295823368,
          "test_syn_std": 0.013135487126914083,
          "test_tot_mean": 0.8224166666666667,
          "test_tot_std": 0.017452713892750972
        }
      },
      "timestamp": 1766884390.0065093
    },
    "pu1=0.2000|pu2=0.0000|pred=0.1000|psyn=0.7000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.1,
          "syn": 0.7,
          "u1": 0.2,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.7595,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.722972972972973,
            "val_best_fusion_loss": 0.5081050431728363,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.705,
                "test_acc_syn": 0.6468705547652916,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.6349198055267334
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7595,
                "test_acc_syn": 0.722972972972973,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.5081050431728363
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.77,
                "test_acc_syn": 0.7663584637268848,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.5425714659690857
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7145,
                "test_acc_syn": 0.697724039829303,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.5901671361923218
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.68275,
                "test_acc_syn": 0.6667852062588905,
                "val_best_acc_fusion": 0.71,
                "val_best_loss_fusion": 0.6898263144493103
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.77125,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7616175948918056,
            "val_best_fusion_loss": 0.4435060214996338,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.77125,
                "test_acc_syn": 0.7616175948918056,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.4435060214996338
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7605,
                "test_acc_syn": 0.7484923731819795,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.45355824947357176
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.761,
                "test_acc_syn": 0.7573607662291593,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.5097248697280884
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.77375,
                "test_acc_syn": 0.7829017382050373,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.557395133972168
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.653,
                "test_acc_syn": 0.6236253990776871,
                "val_best_acc_fusion": 0.7,
                "val_best_loss_fusion": 0.6906787824630737
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.7285,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7308791994281629,
            "val_best_fusion_loss": 0.5011859273910523,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.76,
                "test_acc_syn": 0.7398141529664046,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.5109708547592163
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.77325,
                "test_acc_syn": 0.7694781987133666,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.5062711620330811
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7285,
                "test_acc_syn": 0.7308791994281629,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.5011859273910523
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.805,
                "test_acc_syn": 0.8027162258756254,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.5013784956932068
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.66825,
                "test_acc_syn": 0.6540385989992852,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.6889662790298462
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.68275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6116642958748222
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.7745,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7651649521106776
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.75725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7365975696926376
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 10.0,
            "seed": 0,
            "test_acc_fusion": 0.758,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8079658605974396,
            "val_best_fusion_loss": 0.46060697436332704,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.6865,
                "test_acc_syn": 0.6155761024182077,
                "val_best_acc_fusion": 0.73,
                "val_best_loss_fusion": 0.6494949376583099
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.71675,
                "test_acc_syn": 0.6817211948790897,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.581557211279869
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.74475,
                "test_acc_syn": 0.7919630156472262,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.463606960773468
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.758,
                "test_acc_syn": 0.8079658605974396,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.46060697436332704
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7305,
                "test_acc_syn": 0.7965860597439545,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.5402918291091919
              }
            ]
          },
          {
            "best_lambda_kl": 10.0,
            "seed": 1,
            "test_acc_fusion": 0.792,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8630720113515431,
            "val_best_fusion_loss": 0.35895203828811645,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.75825,
                "test_acc_syn": 0.736786094359702,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.4502038717269897
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.76675,
                "test_acc_syn": 0.7960269599148634,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.4269136667251587
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.714,
                "test_acc_syn": 0.7680028378857751,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.4602592658996582
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.792,
                "test_acc_syn": 0.8630720113515431,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.35895203828811645
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.759,
                "test_acc_syn": 0.8041858815182689,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.5361881732940674
              }
            ]
          },
          {
            "best_lambda_kl": 10.0,
            "seed": 2,
            "test_acc_fusion": 0.77325,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8037884203002145,
            "val_best_fusion_loss": 0.45315893888473513,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.75475,
                "test_acc_syn": 0.7312365975696926,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.5159524083137512
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.77225,
                "test_acc_syn": 0.7498213009292352,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.4550721788406372
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.75775,
                "test_acc_syn": 0.8009292351679771,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.4690294981002808
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.77325,
                "test_acc_syn": 0.8037884203002145,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.45315893888473513
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.756,
                "test_acc_syn": 0.8141529664045747,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.5199124801158905
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.1,
        "psyn": 0.7,
        "pu1": 0.2,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.7384899224309805,
          "test_syn_std": 0.01666921372434007,
          "test_tot_mean": 0.7530833333333332,
          "test_tot_std": 0.018032763392102573
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.7044756058927124,
          "test_syn_std": 0.06665572386015742,
          "test_tot_mean": 0.7381666666666667,
          "test_tot_std": 0.0398132794708276
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.824942097416399,
          "test_syn_std": 0.02701580407076988,
          "test_tot_mean": 0.7744166666666666,
          "test_tot_std": 0.013904935175045678
        }
      },
      "timestamp": 1766887480.8032155
    },
    "pu1=0.2000|pu2=0.0000|pred=0.2000|psyn=0.6000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.2,
          "syn": 0.6,
          "u1": 0.2,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.753,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7070665571076418,
            "val_best_fusion_loss": 0.5444230484962463,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.66325,
                "test_acc_syn": 0.4905505341002465,
                "val_best_acc_fusion": 0.715,
                "val_best_loss_fusion": 0.5509538674354553
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.665,
                "test_acc_syn": 0.5049301561216105,
                "val_best_acc_fusion": 0.72,
                "val_best_loss_fusion": 0.5484906768798828
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.753,
                "test_acc_syn": 0.7070665571076418,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.5444230484962463
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.73325,
                "test_acc_syn": 0.6869350862777321,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5980144548416138
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6715,
                "test_acc_syn": 0.6269515201314708,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.6890628147125244
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.73875,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.718595041322314,
            "val_best_fusion_loss": 0.46547368764877317,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.67025,
                "test_acc_syn": 0.506198347107438,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.5670480918884278
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.73875,
                "test_acc_syn": 0.718595041322314,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.46547368764877317
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.75775,
                "test_acc_syn": 0.7429752066115702,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.47520793437957765
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.773,
                "test_acc_syn": 0.7462809917355372,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.5755642557144165
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.653,
                "test_acc_syn": 0.5950413223140496,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.6897949171066284
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.73125,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7009500206526229,
            "val_best_fusion_loss": 0.47691725969314575,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.66375,
                "test_acc_syn": 0.5026848409748038,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.5542434597015381
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.73125,
                "test_acc_syn": 0.7009500206526229,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.47691725969314575
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.74625,
                "test_acc_syn": 0.7327550598926064,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.4793840265274048
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.697,
                "test_acc_syn": 0.6873192895497728,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.5794002723693847
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.65775,
                "test_acc_syn": 0.6224700536968195,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.6886095833778382
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.66325,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49219391947411667
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.669,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5045454545454545
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.6655,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5055762081784386
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 10.0,
            "seed": 0,
            "test_acc_fusion": 0.7445,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8171733771569433,
            "val_best_fusion_loss": 0.5265385186672211,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.66225,
                "test_acc_syn": 0.4897288414133114,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.5501059532165528
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.66325,
                "test_acc_syn": 0.5,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.5542402458190918
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.71,
                "test_acc_syn": 0.8044371405094495,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.5416298007965088
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7445,
                "test_acc_syn": 0.8171733771569433,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.5265385186672211
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.74025,
                "test_acc_syn": 0.7773212818405916,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.6058300280570984
              }
            ]
          },
          {
            "best_lambda_kl": 10.0,
            "seed": 1,
            "test_acc_fusion": 0.74475,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8095041322314049,
            "val_best_fusion_loss": 0.42031738996505735,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.6685,
                "test_acc_syn": 0.5053719008264462,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.5664081716537476
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.75575,
                "test_acc_syn": 0.7855371900826447,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.5003801131248474
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.67475,
                "test_acc_syn": 0.7504132231404959,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.47289233922958374
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.74475,
                "test_acc_syn": 0.8095041322314049,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.42031738996505735
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7255,
                "test_acc_syn": 0.7950413223140496,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.5485176920890809
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.74025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7748864105741429,
            "val_best_fusion_loss": 0.3833685964345932,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.66625,
                "test_acc_syn": 0.5059892606361008,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.5541647243499755
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.74025,
                "test_acc_syn": 0.7748864105741429,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.3833685964345932
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.739,
                "test_acc_syn": 0.7356464270962412,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.5045376086235046
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7475,
                "test_acc_syn": 0.8042131350681536,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.42306665658950804
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.71675,
                "test_acc_syn": 0.7868649318463445,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.6196345543861389
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.2,
        "psyn": 0.6,
        "pu1": 0.2,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.7088705396941929,
          "test_syn_std": 0.007315620433378212,
          "test_tot_mean": 0.741,
          "test_tot_std": 0.009020809276334373
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5007718607326699,
          "test_syn_std": 0.00608009980397089,
          "test_tot_mean": 0.6659166666666667,
          "test_tot_std": 0.0023658449277630805
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.8005213066541638,
          "test_syn_std": 0.018395022011531165,
          "test_tot_mean": 0.7431666666666668,
          "test_tot_std": 0.0020649186155606786
        }
      },
      "timestamp": 1766894270.842799
    },
    "pu1=0.2000|pu2=0.0000|pred=0.3000|psyn=0.5000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.3,
          "syn": 0.5,
          "u1": 0.2,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.72425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6485417696490361,
            "val_best_fusion_loss": 0.5107024192810059,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7085,
                "test_acc_syn": 0.4982698961937716,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.5280357456207275
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.703,
                "test_acc_syn": 0.48640632723677707,
                "val_best_acc_fusion": 0.715,
                "val_best_loss_fusion": 0.5391459369659424
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.72425,
                "test_acc_syn": 0.6485417696490361,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.5107024192810059
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7425,
                "test_acc_syn": 0.6559565002471577,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.5513950824737549
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.64025,
                "test_acc_syn": 0.5580820563519525,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.6884179401397705
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 1,
            "test_acc_fusion": 0.743,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6482035928143712,
            "val_best_fusion_loss": 0.4933068370819092,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.726,
                "test_acc_syn": 0.5179640718562875,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.5225906789302825
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.71525,
                "test_acc_syn": 0.5229540918163673,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.511218068599701
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.743,
                "test_acc_syn": 0.6482035928143712,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.4933068370819092
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.75675,
                "test_acc_syn": 0.6841317365269461,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.5566515040397644
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.61,
                "test_acc_syn": 0.5444111776447106,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.6882918405532837
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.6915,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5843703334992534,
            "val_best_fusion_loss": 0.4804053783416748,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.72025,
                "test_acc_syn": 0.5027376804380289,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.5041898941993713
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.6915,
                "test_acc_syn": 0.5843703334992534,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.4804053783416748
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.75425,
                "test_acc_syn": 0.6744649079143853,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.5010935068130493
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.753,
                "test_acc_syn": 0.6436037829766053,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.5489199113845825
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6865,
                "test_acc_syn": 0.6012941762070682,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.6880608987808228
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.70725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4962926347009392
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.72525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5159680638722555
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.72025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5017421602787456
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.708,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49332674246169056,
            "val_best_fusion_loss": 0.5255477166175843,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.70775,
                "test_acc_syn": 0.4977755808205635,
                "val_best_acc_fusion": 0.73,
                "val_best_loss_fusion": 0.5283044981956482
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.708,
                "test_acc_syn": 0.49332674246169056,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.5255477166175843
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.73925,
                "test_acc_syn": 0.6866040533860603,
                "val_best_acc_fusion": 0.73,
                "val_best_loss_fusion": 0.5745251870155335
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.70375,
                "test_acc_syn": 0.7513593672763222,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.5733384323120118
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.67925,
                "test_acc_syn": 0.7483934750370737,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.6488425755500793
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.72425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5154690618762475,
            "val_best_fusion_loss": 0.5245762157440186,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.72425,
                "test_acc_syn": 0.5154690618762475,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.5245762157440186
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.727,
                "test_acc_syn": 0.5199600798403193,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5450694060325623
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.723,
                "test_acc_syn": 0.7365269461077845,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.5459240102767944
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.69125,
                "test_acc_syn": 0.7689620758483033,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.5308983087539673
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.69975,
                "test_acc_syn": 0.782435129740519,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.6350170636177063
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.7205,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5017421602787456,
            "val_best_fusion_loss": 0.5047673654556274,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7205,
                "test_acc_syn": 0.5017421602787456,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.5047673654556274
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.715,
                "test_acc_syn": 0.4997511199601792,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.5127241396903992
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.72625,
                "test_acc_syn": 0.7341961174713788,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.5252156829833985
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.71825,
                "test_acc_syn": 0.8043802887008462,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.5119985055923462
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.66375,
                "test_acc_syn": 0.7038327526132404,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.6603435850143433
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.3,
        "psyn": 0.5,
        "pu1": 0.2,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.6270385653208869,
          "test_syn_std": 0.03017131193679818,
          "test_tot_mean": 0.7195833333333334,
          "test_tot_std": 0.021282165198953682
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5046676196173134,
          "test_syn_std": 0.008294550923149523,
          "test_tot_mean": 0.7175833333333334,
          "test_tot_std": 0.0075865377844939845
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5035126548722278,
          "test_syn_std": 0.009125844822744872,
          "test_tot_mean": 0.7175833333333332,
          "test_tot_std": 0.006947221666888783
        }
      },
      "timestamp": 1766897351.3344388
    },
    "pu1=0.2000|pu2=0.0000|pred=0.4000|psyn=0.4000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.4,
          "syn": 0.4,
          "u1": 0.2,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.7615,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5965362411802437,
            "val_best_fusion_loss": 0.4773704481124878,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.77925,
                "test_acc_syn": 0.5202052597819115,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5206760764122009
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.76925,
                "test_acc_syn": 0.5022450288646568,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.5003907823562622
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7615,
                "test_acc_syn": 0.5965362411802437,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.4773704481124878
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.75825,
                "test_acc_syn": 0.5939704939063503,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.5076314461231232
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.72925,
                "test_acc_syn": 0.5702373316228352,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.6882341361045837
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.761,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4854981084489281,
            "val_best_fusion_loss": 0.492499258518219,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7605,
                "test_acc_syn": 0.48045397225725095,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.4957510805130005
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.761,
                "test_acc_syn": 0.4854981084489281,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.492499258518219
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.737,
                "test_acc_syn": 0.5315258511979823,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.5088094282150268
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.75175,
                "test_acc_syn": 0.5680958385876419,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.5760894012451172
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.67725,
                "test_acc_syn": 0.5264817150063051,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.6885917997360229
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.761,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5021645021645021,
            "val_best_fusion_loss": 0.513424117565155,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.76825,
                "test_acc_syn": 0.5009276437847866,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.5256811714172364
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.761,
                "test_acc_syn": 0.5021645021645021,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.513424117565155
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.71375,
                "test_acc_syn": 0.5064935064935064,
                "val_best_acc_fusion": 0.725,
                "val_best_loss_fusion": 0.5360895204544067
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.739,
                "test_acc_syn": 0.5918367346938775,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.5677112960815429
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.65625,
                "test_acc_syn": 0.5479282622139765,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.6891659545898438
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.779,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5208466966003849
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.76175,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4823455233291299
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.76825,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5015460729746444
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.76825,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5118665811417575,
            "val_best_fusion_loss": 0.4978272879123688,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.77875,
                "test_acc_syn": 0.5195638229634381,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5213737785816193
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.76825,
                "test_acc_syn": 0.5118665811417575,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.4978272879123688
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7575,
                "test_acc_syn": 0.6561898652982682,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.5400798606872559
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.6385,
                "test_acc_syn": 0.7697241821680565,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.6241590785980224
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.65825,
                "test_acc_syn": 0.7305965362411803,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.6744800901412964
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.7615,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48297604035308955,
            "val_best_fusion_loss": 0.4959986615180969,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7615,
                "test_acc_syn": 0.48297604035308955,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.4959986615180969
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.75325,
                "test_acc_syn": 0.4798234552332913,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.522536346912384
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.75625,
                "test_acc_syn": 0.4905422446406053,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5743324899673462
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.5965,
                "test_acc_syn": 0.7440100882723834,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.6343440580368042
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.61775,
                "test_acc_syn": 0.7187894073139974,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.68766263961792
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.76225,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49907235621521334,
            "val_best_fusion_loss": 0.52015460729599,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.76725,
                "test_acc_syn": 0.49907235621521334,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.526421959400177
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.76225,
                "test_acc_syn": 0.49907235621521334,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.52015460729599
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.71475,
                "test_acc_syn": 0.658008658008658,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.5705256223678589
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.6475,
                "test_acc_syn": 0.7742733457019171,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.5638881874084473
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.61625,
                "test_acc_syn": 0.6858379715522572,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.6801192283630371
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.4,
        "psyn": 0.4,
        "pu1": 0.2,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5280662839312247,
          "test_syn_std": 0.04889133157068852,
          "test_tot_mean": 0.7611666666666667,
          "test_tot_std": 0.00023570226039548988
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.501579430968053,
          "test_syn_std": 0.015718055867538508,
          "test_tot_mean": 0.7696666666666667,
          "test_tot_std": 0.007113172444291098
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4979716592366868,
          "test_syn_std": 0.011820166020952646,
          "test_tot_mean": 0.7639999999999999,
          "test_tot_std": 0.003020761493398654
        }
      },
      "timestamp": 1766900290.584231
    },
    "pu1=0.2000|pu2=0.0000|pred=0.5000|psyn=0.3000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.5,
          "syn": 0.3,
          "u1": 0.2,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.81725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5012744265080714,
            "val_best_fusion_loss": 0.37578511714935303,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8105,
                "test_acc_syn": 0.49787595581988103,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.377474308013916
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.81725,
                "test_acc_syn": 0.5012744265080714,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.37578511714935303
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.77525,
                "test_acc_syn": 0.4868309260832625,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.3968941593170166
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.799,
                "test_acc_syn": 0.5055225148683092,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.4753149199485779
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7205,
                "test_acc_syn": 0.5038232795242141,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.6870284748077392
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.811,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4781491002570694,
            "val_best_fusion_loss": 0.4107425099611282,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8165,
                "test_acc_syn": 0.4704370179948586,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.4137399697303772
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.811,
                "test_acc_syn": 0.4781491002570694,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.4107425099611282
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.77475,
                "test_acc_syn": 0.508140531276778,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.4531304621696472
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.763,
                "test_acc_syn": 0.5012853470437018,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.5154520034790039
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.677,
                "test_acc_syn": 0.48500428449014565,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.6881048941612243
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.8155,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5,
            "val_best_fusion_loss": 0.38400798320770263,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.815,
                "test_acc_syn": 0.5008196721311475,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.3941386413574219
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8155,
                "test_acc_syn": 0.5,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.38400798320770263
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.757,
                "test_acc_syn": 0.49754098360655735,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.4036276686191559
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.79075,
                "test_acc_syn": 0.5229508196721312,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.5081023740768432
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6805,
                "test_acc_syn": 0.5327868852459017,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.6855377435684205
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.811,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49872557349192864
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.815,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4670094258783205
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.81475,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49918032786885247
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.81,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4970263381478335,
            "val_best_fusion_loss": 0.3774702847003937,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.81,
                "test_acc_syn": 0.4970263381478335,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.3774702847003937
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.81575,
                "test_acc_syn": 0.5097706032285472,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.3879677522182465
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.81225,
                "test_acc_syn": 0.5004248088360238,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.5233184719085693
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.78425,
                "test_acc_syn": 0.49107901444350044,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.6671992111206054
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.77225,
                "test_acc_syn": 0.5165675446049278,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.6902568054199218
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.81175,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.47643530419880037,
            "val_best_fusion_loss": 0.4092842125892639,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.816,
                "test_acc_syn": 0.4704370179948586,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.41403238117694857
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.81175,
                "test_acc_syn": 0.47643530419880037,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.4092842125892639
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.80725,
                "test_acc_syn": 0.4832904884318766,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.5444950544834137
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.818,
                "test_acc_syn": 0.5158526135389888,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.6692160034179687
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.56425,
                "test_acc_syn": 0.6555269922879178,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.6904974365234375
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.80575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4819672131147541,
            "val_best_fusion_loss": 0.38035186886787414,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.81475,
                "test_acc_syn": 0.49918032786885247,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.39451395511627196
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.80575,
                "test_acc_syn": 0.4819672131147541,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.38035186886787414
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8115,
                "test_acc_syn": 0.5098360655737705,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.5205415868759156
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8125,
                "test_acc_syn": 0.5024590163934426,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.6679131603240966
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.578,
                "test_acc_syn": 0.680327868852459,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.6893548464775086
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.5,
        "psyn": 0.3,
        "pu1": 0.2,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4931411755883803,
          "test_syn_std": 0.010613757826076289,
          "test_tot_mean": 0.8145833333333333,
          "test_tot_std": 0.0026325948331552057
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.48830510907970054,
          "test_syn_std": 0.015059466405907563,
          "test_tot_mean": 0.8135833333333333,
          "test_tot_std": 0.0018295415333416346
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.48514295182046263,
          "test_syn_std": 0.00870102128173316,
          "test_tot_mean": 0.8091666666666667,
          "test_tot_std": 0.002519369409638507
        }
      },
      "timestamp": 1766902917.888553
    },
    "pu1=0.2000|pu2=0.0000|pred=0.6000|psyn=0.2000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.6,
          "syn": 0.2,
          "u1": 0.2,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.853,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4564102564102564,
            "val_best_fusion_loss": 0.33957576751708984,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.853,
                "test_acc_syn": 0.4564102564102564,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.33957576751708984
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.86075,
                "test_acc_syn": 0.4794871794871795,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.3510709095001221
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.81725,
                "test_acc_syn": 0.4666666666666667,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.34309963464736937
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8325,
                "test_acc_syn": 0.45897435897435895,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.43541927814483644
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7215,
                "test_acc_syn": 0.49230769230769234,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.6850615406036377
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.86075,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5072992700729927,
            "val_best_fusion_loss": 0.3271131932735443,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.86075,
                "test_acc_syn": 0.5072992700729927,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.3271131932735443
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.85825,
                "test_acc_syn": 0.5012165450121655,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.33169962048530577
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8305,
                "test_acc_syn": 0.49878345498783455,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.3720757699012756
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.83975,
                "test_acc_syn": 0.4768856447688564,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.4090989637374878
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.68275,
                "test_acc_syn": 0.4975669099756691,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.6879516410827636
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.81625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5054678007290401,
            "val_best_fusion_loss": 0.3580871033668518,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.852,
                "test_acc_syn": 0.47023086269744835,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.3708492755889893
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.86025,
                "test_acc_syn": 0.4896719319562576,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.3610808253288269
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.81625,
                "test_acc_syn": 0.5054678007290401,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.3580871033668518
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8475,
                "test_acc_syn": 0.5042527339003645,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.4165967261791229
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.73775,
                "test_acc_syn": 0.5151883353584447,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.6858699369430542
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.85275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.45384615384615384
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.86175,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5060827250608273
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.85175,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4690157958687728
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.853,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.45384615384615384,
            "val_best_fusion_loss": 0.3389345335960388,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.853,
                "test_acc_syn": 0.45384615384615384,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3389345335960388
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.84525,
                "test_acc_syn": 0.4653846153846154,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.37118929862976074
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8405,
                "test_acc_syn": 0.44743589743589746,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.5066175794601441
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8405,
                "test_acc_syn": 0.4512820512820513,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.6622379446029663
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8125,
                "test_acc_syn": 0.514102564102564,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.6902792501449585
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.86175,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5060827250608273,
            "val_best_fusion_loss": 0.3265030717849731,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.86175,
                "test_acc_syn": 0.5060827250608273,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.3265030717849731
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.861,
                "test_acc_syn": 0.5097323600973236,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3368921947479248
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8565,
                "test_acc_syn": 0.5072992700729927,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.5003105092048645
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.81725,
                "test_acc_syn": 0.5754257907542579,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.6627682590484619
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.82675,
                "test_acc_syn": 0.5170316301703163,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.6902521181106568
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.857,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4690157958687728,
            "val_best_fusion_loss": 0.35183431148529054,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.85175,
                "test_acc_syn": 0.47023086269744835,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.3714547419548035
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.857,
                "test_acc_syn": 0.4690157958687728,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.35183431148529054
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8405,
                "test_acc_syn": 0.47144592952612396,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.5006632268428802
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.84175,
                "test_acc_syn": 0.4823815309842041,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.6653953766822815
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.83575,
                "test_acc_syn": 0.4738760631834751,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.6904392528533936
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.6,
        "psyn": 0.2,
        "pu1": 0.2,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.48972577573742976,
          "test_syn_std": 0.0235694921599781,
          "test_tot_mean": 0.8433333333333334,
          "test_tot_std": 0.019410406716215106
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.476314891591918,
          "test_syn_std": 0.021941170461761913,
          "test_tot_mean": 0.8554166666666667,
          "test_tot_std": 0.004496912521077351
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.476314891591918,
          "test_syn_std": 0.021941170461761913,
          "test_tot_mean": 0.85725,
          "test_tot_std": 0.003576543955645837
        }
      },
      "timestamp": 1766905545.4275715
    },
    "pu1=0.2000|pu2=0.0000|pred=0.7000|psyn=0.1000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.7,
          "syn": 0.1,
          "u1": 0.2,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.9135,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5555555555555556,
            "val_best_fusion_loss": 0.1611303162574768,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.91425,
                "test_acc_syn": 0.5460992907801419,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.16194613695144652
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9135,
                "test_acc_syn": 0.5555555555555556,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.1611303162574768
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8815,
                "test_acc_syn": 0.5059101654846335,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.2509373712539673
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.898,
                "test_acc_syn": 0.5130023640661938,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.33024686455726626
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.70125,
                "test_acc_syn": 0.4846335697399527,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.682992091178894
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 1,
            "test_acc_fusion": 0.89225,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49230769230769234,
            "val_best_fusion_loss": 0.27774012565612793,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.91325,
                "test_acc_syn": 0.49230769230769234,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.32325274050235747
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8905,
                "test_acc_syn": 0.5282051282051282,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.2965893864631653
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.89225,
                "test_acc_syn": 0.49230769230769234,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.27774012565612793
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.913,
                "test_acc_syn": 0.47435897435897434,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.3522287142276764
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.75475,
                "test_acc_syn": 0.4641025641025641,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.686416563987732
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.9135,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5341463414634147,
            "val_best_fusion_loss": 0.18356439232826233,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9135,
                "test_acc_syn": 0.5341463414634147,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.18356439232826233
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.911,
                "test_acc_syn": 0.5219512195121951,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.18391955584287645
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.89575,
                "test_acc_syn": 0.5414634146341464,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.26309523165225984
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.90375,
                "test_acc_syn": 0.5024390243902439,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.31785681486129763
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.735,
                "test_acc_syn": 0.4658536585365854,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.6834980630874634
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.90875,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5271867612293144
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.91275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48717948717948717
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.91375,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5390243902439025
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.90875,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5295508274231678,
            "val_best_fusion_loss": 0.16309693098068237,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.90875,
                "test_acc_syn": 0.5295508274231678,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.16309693098068237
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.906,
                "test_acc_syn": 0.5555555555555556,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.1679703712463379
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.90625,
                "test_acc_syn": 0.5460992907801419,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.44626129388809205
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.91325,
                "test_acc_syn": 0.5602836879432624,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.655255515575409
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.89075,
                "test_acc_syn": 0.5437352245862884,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.689613196849823
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.91625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5076923076923077,
            "val_best_fusion_loss": 0.31284027338027953,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.913,
                "test_acc_syn": 0.48717948717948717,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.3230809658765793
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.91625,
                "test_acc_syn": 0.5076923076923077,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.31284027338027953
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.91025,
                "test_acc_syn": 0.5,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.4909878444671631
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8845,
                "test_acc_syn": 0.5025641025641026,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.6619216442108155
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.901,
                "test_acc_syn": 0.5025641025641026,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.6898358869552612
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.914,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5390243902439025,
            "val_best_fusion_loss": 0.18472122609615327,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.914,
                "test_acc_syn": 0.5390243902439025,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.18472122609615327
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.914,
                "test_acc_syn": 0.5073170731707317,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.22426784574985503
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.91025,
                "test_acc_syn": 0.48292682926829267,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.4517782688140869
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.90275,
                "test_acc_syn": 0.5365853658536586,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.6559549522399902
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.89475,
                "test_acc_syn": 0.5048780487804878,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.6893977737426757
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.7,
        "psyn": 0.1,
        "pu1": 0.2,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5273365297755542,
          "test_syn_std": 0.026265988182098327,
          "test_tot_mean": 0.9064166666666665,
          "test_tot_std": 0.010017346066809419
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5177968795509014,
          "test_syn_std": 0.022182589297173327,
          "test_tot_mean": 0.91175,
          "test_tot_std": 0.0021602468994692888
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.525422508453126,
          "test_syn_std": 0.013120140049907837,
          "test_tot_mean": 0.9129999999999999,
          "test_tot_std": 0.0031424512724941645
        }
      },
      "timestamp": 1766908182.1909218
    },
    "pu1=0.2000|pu2=0.0000|pred=0.8000|psyn=0.0000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.8,
          "syn": 0.0,
          "u1": 0.2,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.95575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.12434728175401688,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.96225,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.15929949313402175
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.95575,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.12434728175401688
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9745,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.1451948404312134
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.957,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.29377156376838687
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.78625,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.6831810235977173
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.96025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.050606248676776884,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.96025,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.050606248676776884
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9615,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.06433205425739288
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9685,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.1500698757171631
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.987,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.99,
                "val_best_loss_fusion": 0.20647986114025116
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.81175,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.6822174310684204
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.96025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.07302132204174995,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.96125,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.07996766783297062
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.96025,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.99,
                "val_best_loss_fusion": 0.07302132204174995
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.966,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.99,
                "val_best_loss_fusion": 0.15958814263343812
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.97225,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.99,
                "val_best_loss_fusion": 0.25480770111083983
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.763,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.6789606094360352
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.96125,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.96025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.961,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.96025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.11741069853305816,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9615,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.15964232206344606
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.96025,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.11741069853305816
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.949,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.42569287776947023
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9585,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.6508714914321899
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.9445,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.6892279052734375
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.9605,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.050010284632444384,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9605,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.050010284632444384
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9585,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.99,
                "val_best_loss_fusion": 0.051740114390850064
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.95425,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.4201822304725647
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.956,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.6521344375610352
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.85975,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.688843092918396
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.9605,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.07660662092268467,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.961,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.07856099230237305
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9605,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.07660662092268467
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.96275,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.41063743710517886
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.93925,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.6528496885299683
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.9415,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.6889924383163453
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.8,
        "psyn": 0.0,
        "pu1": 0.2,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9587499999999999,
          "test_tot_std": 0.0021213203435596706
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9608333333333333,
          "test_tot_std": 0.00042491829279938824
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9604166666666667,
          "test_tot_std": 0.00011785113019774494
        }
      },
      "timestamp": 1766910813.7558353
    },
    "pu1=0.3000|pu2=0.0000|pred=0.0000|psyn=0.7000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.0,
          "syn": 0.7,
          "u1": 0.3,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 10.0,
            "seed": 0,
            "test_acc_fusion": 0.83,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7944720056697377,
            "val_best_fusion_loss": 0.4910126614570618,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7815,
                "test_acc_syn": 0.7459248759744862,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.5209193742275238
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7865,
                "test_acc_syn": 0.7725017717930546,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.4943338096141815
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.74525,
                "test_acc_syn": 0.6711552090715804,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.5040092897415162
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.83,
                "test_acc_syn": 0.7944720056697377,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.4910126614570618
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.69825,
                "test_acc_syn": 0.663359319631467,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.6886304330825805
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.7725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7277245296414625,
            "val_best_fusion_loss": 0.44284968852996826,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7725,
                "test_acc_syn": 0.7277245296414625,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.44284968852996826
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.779,
                "test_acc_syn": 0.7578984735534257,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.46192513465881346
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.78275,
                "test_acc_syn": 0.7749378771742989,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.49668723106384277
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.82775,
                "test_acc_syn": 0.7852325168619099,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.5375104331970215
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.664,
                "test_acc_syn": 0.6020589279375221,
                "val_best_acc_fusion": 0.72,
                "val_best_loss_fusion": 0.6904012942314148
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.80425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7755395683453238,
            "val_best_fusion_loss": 0.31494509160518647,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.80425,
                "test_acc_syn": 0.7755395683453238,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.31494509160518647
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7995,
                "test_acc_syn": 0.7881294964028777,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.36209493517875674
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.799,
                "test_acc_syn": 0.7787769784172662,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.47066625833511355
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8465,
                "test_acc_syn": 0.8158273381294964,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.45976866245269776
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.69025,
                "test_acc_syn": 0.6517985611510791,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.6894870066642761
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.75975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7140326009922041
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.7635,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7156549520766773
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.80675,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7794964028776978
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 10.0,
            "seed": 0,
            "test_acc_fusion": 0.8065,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8242381289865344,
            "val_best_fusion_loss": 0.4282568395137787,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.76175,
                "test_acc_syn": 0.7186392629340893,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5453320932388306
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.773,
                "test_acc_syn": 0.739900779588944,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.4852453231811523
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7925,
                "test_acc_syn": 0.7990786676116229,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.45998495221138
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8065,
                "test_acc_syn": 0.8242381289865344,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.4282568395137787
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7625,
                "test_acc_syn": 0.81218993621545,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.5307927417755127
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.7985,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7756478523251686,
            "val_best_fusion_loss": 0.3643758201599121,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.771,
                "test_acc_syn": 0.7259495917642883,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.4460041618347168
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7985,
                "test_acc_syn": 0.7756478523251686,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.3643758201599121
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.789,
                "test_acc_syn": 0.7912673056443025,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.4787749266624451
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.80675,
                "test_acc_syn": 0.832800851970181,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.39991783142089843
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.777,
                "test_acc_syn": 0.8171813986510472,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.5189990830421448
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.80725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7809352517985612,
            "val_best_fusion_loss": 0.3012206733226776,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.80725,
                "test_acc_syn": 0.7809352517985612,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.3012206733226776
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.77575,
                "test_acc_syn": 0.737410071942446,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.3923530602455139
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.77875,
                "test_acc_syn": 0.7928057553956834,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.4240856945514679
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.80925,
                "test_acc_syn": 0.8428057553956835,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.3723545587062836
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.79775,
                "test_acc_syn": 0.85431654676259,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.5192445421218872
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.0,
        "psyn": 0.7,
        "pu1": 0.3,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.7659120345521747,
          "test_syn_std": 0.028087048548396415,
          "test_tot_mean": 0.80225,
          "test_tot_std": 0.023516837939371583
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.736394651982193,
          "test_syn_std": 0.03048473610900961,
          "test_tot_mean": 0.7766666666666667,
          "test_tot_std": 0.021327147540686764
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.7936070777034213,
          "test_syn_std": 0.02176671963233981,
          "test_tot_mean": 0.8040833333333334,
          "test_tot_std": 0.003959868123505585
        }
      },
      "timestamp": 1766913449.20159
    },
    "pu1=0.3000|pu2=0.0000|pred=0.1000|psyn=0.6000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.1,
          "syn": 0.6,
          "u1": 0.3,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.76425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.700295483326298,
            "val_best_fusion_loss": 0.5435722088813781,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.68625,
                "test_acc_syn": 0.5052764879696074,
                "val_best_acc_fusion": 0.675,
                "val_best_loss_fusion": 0.6082004356384277
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.73575,
                "test_acc_syn": 0.6897425073870832,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5856015765666962
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.76425,
                "test_acc_syn": 0.700295483326298,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.5435722088813781
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.753,
                "test_acc_syn": 0.6964964119881807,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.603237156867981
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.69625,
                "test_acc_syn": 0.6298016040523428,
                "val_best_acc_fusion": 0.73,
                "val_best_loss_fusion": 0.689645574092865
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 1,
            "test_acc_fusion": 0.73675,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6764336542486395,
            "val_best_fusion_loss": 0.5856160402297974,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.67075,
                "test_acc_syn": 0.5027208036835497,
                "val_best_acc_fusion": 0.66,
                "val_best_loss_fusion": 0.6052981376647949
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.67525,
                "test_acc_syn": 0.5156969443281708,
                "val_best_acc_fusion": 0.705,
                "val_best_loss_fusion": 0.6091911315917968
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.73675,
                "test_acc_syn": 0.6764336542486395,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.5856160402297974
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.72325,
                "test_acc_syn": 0.6785265801590624,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.6227786755561828
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6375,
                "test_acc_syn": 0.5730431142737548,
                "val_best_acc_fusion": 0.67,
                "val_best_loss_fusion": 0.690705509185791
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.73775,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6825601374570447,
            "val_best_fusion_loss": 0.5304594349861145,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.68375,
                "test_acc_syn": 0.5017182130584192,
                "val_best_acc_fusion": 0.67,
                "val_best_loss_fusion": 0.6123143744468689
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.71325,
                "test_acc_syn": 0.6907216494845361,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.54045166015625
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.73775,
                "test_acc_syn": 0.6825601374570447,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.5304594349861145
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.72775,
                "test_acc_syn": 0.6653780068728522,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.5671565675735474
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.67625,
                "test_acc_syn": 0.6305841924398625,
                "val_best_acc_fusion": 0.705,
                "val_best_loss_fusion": 0.6893249845504761
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.687,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5061207260447447
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.67075,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5027208036835497
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.6835,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5004295532646048
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 10.0,
            "seed": 0,
            "test_acc_fusion": 0.73175,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.803292528493035,
            "val_best_fusion_loss": 0.5059633016586303,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.68475,
                "test_acc_syn": 0.5040101308569016,
                "val_best_acc_fusion": 0.695,
                "val_best_loss_fusion": 0.607401876449585
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.68925,
                "test_acc_syn": 0.5111861544955677,
                "val_best_acc_fusion": 0.73,
                "val_best_loss_fusion": 0.5992778348922729
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.75,
                "test_acc_syn": 0.7361756015196286,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5519697654247284
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.73175,
                "test_acc_syn": 0.803292528493035,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.5059633016586303
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.663,
                "test_acc_syn": 0.704516673701984,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.6254005551338195
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 1,
            "test_acc_fusion": 0.72825,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7986605274173294,
            "val_best_fusion_loss": 0.5185177397727966,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.6695,
                "test_acc_syn": 0.5010464629552114,
                "val_best_acc_fusion": 0.665,
                "val_best_loss_fusion": 0.6046547889709473
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7345,
                "test_acc_syn": 0.683549602344077,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5951326942443848
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.72825,
                "test_acc_syn": 0.7986605274173294,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.5185177397727966
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.74925,
                "test_acc_syn": 0.7810799497697781,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5720777606964111
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.71875,
                "test_acc_syn": 0.7672666387609879,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.6438320016860962
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.706,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6937285223367697,
            "val_best_fusion_loss": 0.5439572668075562,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.68325,
                "test_acc_syn": 0.5004295532646048,
                "val_best_acc_fusion": 0.67,
                "val_best_loss_fusion": 0.6116478061676025
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.72525,
                "test_acc_syn": 0.7302405498281787,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.6072468376159668
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.706,
                "test_acc_syn": 0.6937285223367697,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.5439572668075562
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7355,
                "test_acc_syn": 0.7719072164948454,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.5493888461589813
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.70225,
                "test_acc_syn": 0.7637457044673539,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.5976284956932068
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.1,
        "psyn": 0.6,
        "pu1": 0.3,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.6864297583439941,
          "test_syn_std": 0.010118537314894961,
          "test_tot_mean": 0.74625,
          "test_tot_std": 0.01273446766326203
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.503090360997633,
          "test_syn_std": 0.0023380606435884172,
          "test_tot_mean": 0.6804166666666666,
          "test_tot_std": 0.006983114555045578
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.7652271927490446,
          "test_syn_std": 0.0505925472873471,
          "test_tot_mean": 0.722,
          "test_tot_std": 0.011403581308811148
        }
      },
      "timestamp": 1766916083.9237804
    },
    "pu1=0.3000|pu2=0.0000|pred=0.2000|psyn=0.5000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.2,
          "syn": 0.5,
          "u1": 0.3,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.7235,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5042950985346134,
            "val_best_fusion_loss": 0.5278591251373291,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.717,
                "test_acc_syn": 0.5012632642748863,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.5431171941757202
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7235,
                "test_acc_syn": 0.5042950985346134,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.5278591251373291
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7225,
                "test_acc_syn": 0.6387064173825164,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.5450508832931519
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7345,
                "test_acc_syn": 0.6664982314300152,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.5554089736938477
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6645,
                "test_acc_syn": 0.5816068721576554,
                "val_best_acc_fusion": 0.695,
                "val_best_loss_fusion": 0.6887318277359009
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 1,
            "test_acc_fusion": 0.718,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.620412267471091,
            "val_best_fusion_loss": 0.5367860555648803,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.715,
                "test_acc_syn": 0.48717948717948717,
                "val_best_acc_fusion": 0.71,
                "val_best_loss_fusion": 0.5691162443161011
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.71075,
                "test_acc_syn": 0.48717948717948717,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.5601784658432006
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.718,
                "test_acc_syn": 0.620412267471091,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.5367860555648803
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7425,
                "test_acc_syn": 0.6168929110105581,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.5441524386405945
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6395,
                "test_acc_syn": 0.521870286576169,
                "val_best_acc_fusion": 0.695,
                "val_best_loss_fusion": 0.6878474950790405
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.715,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.504247876061969,
            "val_best_fusion_loss": 0.526516809463501,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.715,
                "test_acc_syn": 0.504247876061969,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.526516809463501
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7195,
                "test_acc_syn": 0.5092453773113443,
                "val_best_acc_fusion": 0.72,
                "val_best_loss_fusion": 0.5346096706390381
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.70525,
                "test_acc_syn": 0.6381809095452274,
                "val_best_acc_fusion": 0.72,
                "val_best_loss_fusion": 0.5477546262741089
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7255,
                "test_acc_syn": 0.6286856571714143,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.5721441173553466
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.677,
                "test_acc_syn": 0.5837081459270365,
                "val_best_acc_fusion": 0.73,
                "val_best_loss_fusion": 0.6884499788284302
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.71475,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4987367357251137
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.717,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49120160884866765
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.7165,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5067466266866567
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 10.0,
            "seed": 0,
            "test_acc_fusion": 0.7085,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8089944416371905,
            "val_best_fusion_loss": 0.5180958318710327,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7165,
                "test_acc_syn": 0.5012632642748863,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.5431584739685058
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.72775,
                "test_acc_syn": 0.5138959070237493,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.5295134806632995
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.73925,
                "test_acc_syn": 0.6776149570490146,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.563804121017456
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7085,
                "test_acc_syn": 0.8089944416371905,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.5180958318710327
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.69,
                "test_acc_syn": 0.74077817079333,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.653718101978302
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 1,
            "test_acc_fusion": 0.721,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6546003016591252,
            "val_best_fusion_loss": 0.5411597394943237,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.71575,
                "test_acc_syn": 0.48868778280542985,
                "val_best_acc_fusion": 0.71,
                "val_best_loss_fusion": 0.5684254550933838
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.71825,
                "test_acc_syn": 0.5012569130216189,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.5549667644500732
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.721,
                "test_acc_syn": 0.6546003016591252,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.5411597394943237
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.68525,
                "test_acc_syn": 0.7762694821518351,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.5503880739212036
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.72925,
                "test_acc_syn": 0.7757667169431876,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.6373857116699219
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.71525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5062468765617192,
            "val_best_fusion_loss": 0.5262213015556335,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.71525,
                "test_acc_syn": 0.5062468765617192,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5262213015556335
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.72075,
                "test_acc_syn": 0.5172413793103449,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.5370550537109375
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.72275,
                "test_acc_syn": 0.6541729135432284,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.564678225517273
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.66125,
                "test_acc_syn": 0.7786106946526736,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.5821858596801758
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.70575,
                "test_acc_syn": 0.7631184407796102,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.641251084804535
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.2,
        "psyn": 0.5,
        "pu1": 0.3,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5429850806892245,
          "test_syn_std": 0.05474929221585742,
          "test_tot_mean": 0.7188333333333333,
          "test_tot_std": 0.003519785346990507
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.498894990420146,
          "test_syn_std": 0.006347213472972443,
          "test_tot_mean": 0.7160833333333333,
          "test_tot_std": 0.0009646530752325149
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.6566138732860116,
          "test_syn_std": 0.12360437665607188,
          "test_tot_mean": 0.7149166666666668,
          "test_tot_std": 0.005108544041331351
        }
      },
      "timestamp": 1766918734.8135903
    },
    "pu1=0.3000|pu2=0.0000|pred=0.3000|psyn=0.4000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.3,
          "syn": 0.4,
          "u1": 0.3,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.777,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.510230179028133,
            "val_best_fusion_loss": 0.4455733895301819,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.77075,
                "test_acc_syn": 0.5063938618925832,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.44589790105819704
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.777,
                "test_acc_syn": 0.510230179028133,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.4455733895301819
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.75075,
                "test_acc_syn": 0.6118925831202046,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.4745809519290924
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.753,
                "test_acc_syn": 0.6336317135549873,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.5091847515106201
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.69425,
                "test_acc_syn": 0.569693094629156,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.6865397572517395
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.77075,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5184948979591837,
            "val_best_fusion_loss": 0.5008608341217041,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7745,
                "test_acc_syn": 0.5210459183673469,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5171029663085938
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.77075,
                "test_acc_syn": 0.5184948979591837,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.5008608341217041
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.69075,
                "test_acc_syn": 0.5561224489795918,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.5158902359008789
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.73625,
                "test_acc_syn": 0.5663265306122449,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.5472985458374023
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6885,
                "test_acc_syn": 0.5395408163265306,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.6867013263702393
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.7275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.574108818011257,
            "val_best_fusion_loss": 0.46015623331069944,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.76675,
                "test_acc_syn": 0.5059412132582864,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.4740613806247711
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.76725,
                "test_acc_syn": 0.5140712945590994,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.4856285309791565
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7275,
                "test_acc_syn": 0.574108818011257,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.46015623331069944
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.749,
                "test_acc_syn": 0.5966228893058161,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.5310953080654144
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6805,
                "test_acc_syn": 0.5453408380237649,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.6854450011253357
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.7715,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5076726342710998
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.77425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5197704081632653
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.768,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5109443402126329
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.77025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5057544757033248,
            "val_best_fusion_loss": 0.44572147965431214,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.77025,
                "test_acc_syn": 0.5057544757033248,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.44572147965431214
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.77075,
                "test_acc_syn": 0.5051150895140665,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.44620452404022215
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.75525,
                "test_acc_syn": 0.6662404092071611,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.5262258386611939
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.62825,
                "test_acc_syn": 0.7691815856777494,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.6039739513397216
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.63325,
                "test_acc_syn": 0.6847826086956522,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.6758163070678711
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.777,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5274234693877551,
            "val_best_fusion_loss": 0.5081293773651123,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7735,
                "test_acc_syn": 0.5178571428571429,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.5194572496414185
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.777,
                "test_acc_syn": 0.5274234693877551,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5081293773651123
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.73025,
                "test_acc_syn": 0.5350765306122449,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.5690387678146362
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.622,
                "test_acc_syn": 0.7423469387755102,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.6254022216796875
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6165,
                "test_acc_syn": 0.7040816326530612,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.6832195043563842
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.7595,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5021888680425266,
            "val_best_fusion_loss": 0.4616492223739624,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.76675,
                "test_acc_syn": 0.5071919949968731,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.4746000647544861
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7595,
                "test_acc_syn": 0.5021888680425266,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.4616492223739624
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.71025,
                "test_acc_syn": 0.631019387116948,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.5576789045333862
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.62825,
                "test_acc_syn": 0.7892432770481551,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.6261518955230713
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6235,
                "test_acc_syn": 0.7392120075046904,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.6842836856842041
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.3,
        "psyn": 0.4,
        "pu1": 0.3,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5342779649995245,
          "test_syn_std": 0.02836604817364114,
          "test_tot_mean": 0.7584166666666667,
          "test_tot_std": 0.022009783178294953
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5127957942156659,
          "test_syn_std": 0.005109464729336502,
          "test_tot_mean": 0.7712499999999999,
          "test_tot_std": 0.0025576682088704573
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5117889377112022,
          "test_syn_std": 0.011150704762675717,
          "test_tot_mean": 0.7689166666666667,
          "test_tot_std": 0.007206285836376182
        }
      },
      "timestamp": 1766921367.211996
    },
    "pu1=0.3000|pu2=0.0000|pred=0.4000|psyn=0.3000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.4,
          "syn": 0.3,
          "u1": 0.3,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.80775,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4877637130801688,
            "val_best_fusion_loss": 0.37436877965927123,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.80775,
                "test_acc_syn": 0.4877637130801688,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.37436877965927123
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.818,
                "test_acc_syn": 0.4936708860759494,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.39171170473098754
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.76125,
                "test_acc_syn": 0.48523206751054854,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.42011953353881837
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.754,
                "test_acc_syn": 0.5172995780590718,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.47087409496307375
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.72125,
                "test_acc_syn": 0.5383966244725739,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.6863612699508667
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.81575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48375768217734855,
            "val_best_fusion_loss": 0.42806380152702334,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.81575,
                "test_acc_syn": 0.48375768217734855,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.42806380152702334
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.81275,
                "test_acc_syn": 0.47673397717295873,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.4378482127189636
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.76275,
                "test_acc_syn": 0.5030728709394205,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.45413014888763426
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.78075,
                "test_acc_syn": 0.5153643546971027,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.5638636493682861
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.66475,
                "test_acc_syn": 0.4863915715539947,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.6890291929244995
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.807,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48462783171521034,
            "val_best_fusion_loss": 0.4054132604598999,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.79975,
                "test_acc_syn": 0.48058252427184467,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.42637319684028624
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.807,
                "test_acc_syn": 0.48462783171521034,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.4054132604598999
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.80025,
                "test_acc_syn": 0.4975728155339806,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.5048977661132813
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7655,
                "test_acc_syn": 0.5105177993527508,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.5738171291351318
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.67525,
                "test_acc_syn": 0.529126213592233,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.6861840033531189
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.808,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4928270042194093
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.81525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4820017559262511
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.802,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48381877022653724
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.808,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4928270042194093,
            "val_best_fusion_loss": 0.3740561890602112,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.808,
                "test_acc_syn": 0.4928270042194093,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.3740561890602112
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.81325,
                "test_acc_syn": 0.49535864978902955,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.3974071669578552
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.812,
                "test_acc_syn": 0.4978902953586498,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.5026598310470581
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7385,
                "test_acc_syn": 0.6227848101265823,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.6658911800384522
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.56175,
                "test_acc_syn": 0.7181434599156118,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.6895975089073181
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.81325,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4881474978050922,
            "val_best_fusion_loss": 0.42705135345458983,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.81475,
                "test_acc_syn": 0.4784899034240562,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.4281188040971756
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.81325,
                "test_acc_syn": 0.4881474978050922,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.42705135345458983
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.81175,
                "test_acc_syn": 0.47761194029850745,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.5484753274917602
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.81025,
                "test_acc_syn": 0.4828797190517998,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.6699409031867981
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.793,
                "test_acc_syn": 0.495171202809482,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.6909889006614685
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.79925,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48220064724919093,
            "val_best_fusion_loss": 0.4266991984844208,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.79925,
                "test_acc_syn": 0.48220064724919093,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.4266991984844208
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.80425,
                "test_acc_syn": 0.4830097087378641,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.42795119285583494
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.79375,
                "test_acc_syn": 0.4813915857605178,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.5373659873008728
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.79925,
                "test_acc_syn": 0.5105177993527508,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.6699462890625
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.775,
                "test_acc_syn": 0.4813915857605178,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.6908796215057373
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.4,
        "psyn": 0.3,
        "pu1": 0.3,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4853830756575759,
          "test_syn_std": 0.001720439083092379,
          "test_tot_mean": 0.8101666666666666,
          "test_tot_std": 0.003959868123505555
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.48621584345739927,
          "test_syn_std": 0.004733284286674335,
          "test_tot_mean": 0.8084166666666667,
          "test_tot_std": 0.005417307654381662
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4877250497578975,
          "test_syn_std": 0.00434846427903469,
          "test_tot_mean": 0.8068333333333334,
          "test_tot_std": 0.0057747053796901445
        }
      },
      "timestamp": 1766924003.2518902
    },
    "pu1=0.3000|pu2=0.0000|pred=0.5000|psyn=0.2000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.5,
          "syn": 0.2,
          "u1": 0.3,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.85725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49601063829787234,
            "val_best_fusion_loss": 0.30814494490623473,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.85725,
                "test_acc_syn": 0.49601063829787234,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.30814494490623473
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.873,
                "test_acc_syn": 0.523936170212766,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3318082821369171
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.83675,
                "test_acc_syn": 0.5106382978723404,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.38814387321472166
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8255,
                "test_acc_syn": 0.5345744680851063,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.417077419757843
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.74975,
                "test_acc_syn": 0.5199468085106383,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.6829531979560852
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.85625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5166051660516605,
            "val_best_fusion_loss": 0.3132329559326172,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.83375,
                "test_acc_syn": 0.5375153751537516,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.33260455846786496
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.85625,
                "test_acc_syn": 0.5166051660516605,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.3132329559326172
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8185,
                "test_acc_syn": 0.5325953259532595,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.34684565901756287
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.82425,
                "test_acc_syn": 0.5092250922509225,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.4449940299987793
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.648,
                "test_acc_syn": 0.5141451414514145,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.6872820281982421
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.85025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48812351543942994,
            "val_best_fusion_loss": 0.3760289907455444,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.85575,
                "test_acc_syn": 0.498812351543943,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.409640953540802
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.85025,
                "test_acc_syn": 0.48812351543942994,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.3760289907455444
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.82425,
                "test_acc_syn": 0.501187648456057,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.40047856092453005
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.80975,
                "test_acc_syn": 0.504750593824228,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.497193763256073
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7185,
                "test_acc_syn": 0.4857482185273159,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.6870323133468628
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.856,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49069148936170215
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.83275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5362853628536285
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.8565,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.501187648456057
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.857,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49601063829787234,
            "val_best_fusion_loss": 0.30810159564018247,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.857,
                "test_acc_syn": 0.49601063829787234,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.30810159564018247
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.86825,
                "test_acc_syn": 0.511968085106383,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.336140388250351
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8585,
                "test_acc_syn": 0.5053191489361702,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.49058536529541014
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.85325,
                "test_acc_syn": 0.5039893617021277,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.6600680232048035
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.837,
                "test_acc_syn": 0.5332446808510638,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.689924201965332
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.84125,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5153751537515375,
            "val_best_fusion_loss": 0.31864784717559813,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.83275,
                "test_acc_syn": 0.5350553505535055,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.3325921368598938
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.84125,
                "test_acc_syn": 0.5153751537515375,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.31864784717559813
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.838,
                "test_acc_syn": 0.5153751537515375,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.48197408199310304
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.844,
                "test_acc_syn": 0.5264452644526445,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.661941978931427
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.836,
                "test_acc_syn": 0.5461254612546126,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.6898946237564086
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.8615,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.502375296912114,
            "val_best_fusion_loss": 0.38310935139656066,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8555,
                "test_acc_syn": 0.498812351543943,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.40967136025428774
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8615,
                "test_acc_syn": 0.502375296912114,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.38310935139656066
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.83975,
                "test_acc_syn": 0.47624703087885983,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.5069265139102935
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.83775,
                "test_acc_syn": 0.49287410926365793,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.6657008528709412
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.83975,
                "test_acc_syn": 0.498812351543943,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.6905340242385865
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.5,
        "psyn": 0.2,
        "pu1": 0.3,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5002464399296542,
          "test_syn_std": 0.012007153895272831,
          "test_tot_mean": 0.8545833333333333,
          "test_tot_std": 0.0030912061651652374
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5093881668904626,
          "test_syn_std": 0.019495926103406228,
          "test_tot_mean": 0.8484166666666667,
          "test_tot_std": 0.01107988668213214
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5045870296538413,
          "test_syn_std": 0.008058740016463731,
          "test_tot_mean": 0.8532500000000001,
          "test_tot_std": 0.008681877677092656
        }
      },
      "timestamp": 1766926640.8067608
    },
    "pu1=0.3000|pu2=0.0000|pred=0.6000|psyn=0.1000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.6,
          "syn": 0.1,
          "u1": 0.3,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.9045,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.47058823529411764,
            "val_best_fusion_loss": 0.1745824870467186,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9045,
                "test_acc_syn": 0.47058823529411764,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.1745824870467186
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.89825,
                "test_acc_syn": 0.47058823529411764,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.17700356245040894
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8685,
                "test_acc_syn": 0.47058823529411764,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.3067678290605545
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.89325,
                "test_acc_syn": 0.45588235294117646,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.3816403204202652
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7295,
                "test_acc_syn": 0.5196078431372549,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.6815108823776245
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.902,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5024390243902439,
            "val_best_fusion_loss": 0.2297899341583252,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.902,
                "test_acc_syn": 0.5024390243902439,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.2297899341583252
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.90125,
                "test_acc_syn": 0.5219512195121951,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.23898784399032594
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.82675,
                "test_acc_syn": 0.4634146341463415,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.33176804184913633
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.872,
                "test_acc_syn": 0.4902439024390244,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.4570779752731323
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7565,
                "test_acc_syn": 0.5487804878048781,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.6861335229873657
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.90575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4987593052109181,
            "val_best_fusion_loss": 0.22450038447976112,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.90575,
                "test_acc_syn": 0.4987593052109181,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.22450038447976112
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.90775,
                "test_acc_syn": 0.5186104218362283,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.22804008692502975
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.87525,
                "test_acc_syn": 0.4838709677419355,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.3189822220802307
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8975,
                "test_acc_syn": 0.5285359801488834,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.4318759274482727
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.71275,
                "test_acc_syn": 0.5161290322580645,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.6838458347320556
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.9045,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.47058823529411764
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.90225,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5097560975609756
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.90575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5012406947890818
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.9045,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4730392156862745,
            "val_best_fusion_loss": 0.17422877132892609,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9045,
                "test_acc_syn": 0.4730392156862745,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.17422877132892609
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.895,
                "test_acc_syn": 0.47794117647058826,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.18191538631916046
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.89325,
                "test_acc_syn": 0.48284313725490197,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.4541603362560272
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.87225,
                "test_acc_syn": 0.4877450980392157,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.6553944683074951
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8715,
                "test_acc_syn": 0.49754901960784315,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.6895419597625733
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.90525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4975609756097561,
            "val_best_fusion_loss": 0.22852466344833375,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9025,
                "test_acc_syn": 0.5073170731707317,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.22985547065734863
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.90525,
                "test_acc_syn": 0.4975609756097561,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.22852466344833375
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.88625,
                "test_acc_syn": 0.4878048780487805,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.4670713782310486
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.90225,
                "test_acc_syn": 0.5195121951219512,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.6593653154373169
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.82075,
                "test_acc_syn": 0.5195121951219512,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.6900244975090026
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.90525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4987593052109181,
            "val_best_fusion_loss": 0.22503605976700783,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.90525,
                "test_acc_syn": 0.4987593052109181,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.22503605976700783
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.906,
                "test_acc_syn": 0.5062034739454094,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.2567839908599854
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.89825,
                "test_acc_syn": 0.5012406947890818,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.4623486590385437
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.89975,
                "test_acc_syn": 0.4913151364764268,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.6581524014472961
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.88975,
                "test_acc_syn": 0.5062034739454094,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.6897165870666504
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.6,
        "psyn": 0.1,
        "pu1": 0.3,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4905955216317599,
          "test_syn_std": 0.0142268223966089,
          "test_tot_mean": 0.9040833333333333,
          "test_tot_std": 0.0015590239111558152
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4938616758813917,
          "test_syn_std": 0.016819984119471807,
          "test_tot_mean": 0.9041666666666668,
          "test_tot_std": 0.0014481789330819167
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.48978649883564956,
          "test_syn_std": 0.011852218304949272,
          "test_tot_mean": 0.9049999999999999,
          "test_tot_std": 0.00035355339059328715
        }
      },
      "timestamp": 1766929268.680107
    },
    "pu1=0.3000|pu2=0.0000|pred=0.7000|psyn=0.0000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.7,
          "syn": 0.0,
          "u1": 0.3,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.94825,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.12273411214351654,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95525,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.1362139278650284
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.94825,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.12273411214351654
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.951,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.2030283260345459
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.91525,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.35747669100761414
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.828,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.6796742582321167
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.95725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.08277154803276061,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.957,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.09193709999322891
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.95725,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.08277154803276061
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9535,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.20717449486255646
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.97425,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.99,
                "val_best_loss_fusion": 0.27884888112545014
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.75925,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.6838591194152832
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.95825,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.06424085517413915,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95825,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.06424085517413915
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9535,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.06809538751840591
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.95475,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.1985558021068573
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.94,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.3227002775669098
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.70525,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.679720253944397
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.95525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.9575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.9575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.95575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.12331517994403839,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95475,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.13605467051267625
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.95575,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.12331517994403839
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.94925,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.4356692910194397
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.95275,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.6496585822105407
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.928,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.6895227122306824
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.957,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.09209326520562172,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.957,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.09209326520562172
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9535,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.10457978248596192
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9425,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.4215924406051636
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.95075,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.6534419107437134
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.90075,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.6890008163452148
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.958,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.06418799072969705,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.958,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.06418799072969705
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.956,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.074002231284976
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.93475,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.41453635454177856
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.95225,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.6514686536788941
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.90925,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.6893267893791198
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.7,
        "psyn": 0.0,
        "pu1": 0.3,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9545833333333333,
          "test_tot_std": 0.004496912521077351
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.95675,
          "test_tot_std": 0.001060660171779809
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9569166666666667,
          "test_tot_std": 0.0009204467514322608
        }
      },
      "timestamp": 1766931900.922466
    },
    "pu1=0.4000|pu2=0.0000|pred=0.0000|psyn=0.6000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.0,
          "syn": 0.6,
          "u1": 0.4,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.75125,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6891213389121339,
            "val_best_fusion_loss": 0.5052082180976868,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.69825,
                "test_acc_syn": 0.499581589958159,
                "val_best_acc_fusion": 0.69,
                "val_best_loss_fusion": 0.579965147972107
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7585,
                "test_acc_syn": 0.6828451882845188,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.5618567752838135
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.75125,
                "test_acc_syn": 0.6891213389121339,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.5052082180976868
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.80175,
                "test_acc_syn": 0.7087866108786611,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.5628977251052857
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.693,
                "test_acc_syn": 0.603765690376569,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.6877069115638733
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.7395,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6950860982780345,
            "val_best_fusion_loss": 0.4670410740375519,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.726,
                "test_acc_syn": 0.6026879462410751,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.4933748197555542
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7395,
                "test_acc_syn": 0.6950860982780345,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.4670410740375519
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.76725,
                "test_acc_syn": 0.7135657286854263,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.4801400923728943
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.77275,
                "test_acc_syn": 0.7131457370852583,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.5386354780197143
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.695,
                "test_acc_syn": 0.6257874842503149,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.6878977632522583
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.77475,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7068676716917923,
            "val_best_fusion_loss": 0.4536668872833252,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.69875,
                "test_acc_syn": 0.5012562814070352,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.5688033533096314
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.719,
                "test_acc_syn": 0.6620603015075377,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.5269232749938965
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.77475,
                "test_acc_syn": 0.7068676716917923,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.4536668872833252
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.77075,
                "test_acc_syn": 0.6859296482412061,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.5571530485153198
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.67675,
                "test_acc_syn": 0.6084589614740369,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.6881402349472046
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.6995,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.501673640167364
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.69625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5401091978160437
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.69675,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5008375209380235
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.74625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.806276150627615,
            "val_best_fusion_loss": 0.4121520173549652,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.70025,
                "test_acc_syn": 0.502928870292887,
                "val_best_acc_fusion": 0.69,
                "val_best_loss_fusion": 0.5796741580963135
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.76525,
                "test_acc_syn": 0.7531380753138075,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.5358564138412476
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.74625,
                "test_acc_syn": 0.806276150627615,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.4121520173549652
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.76975,
                "test_acc_syn": 0.8246861924686193,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.4530255889892578
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.74725,
                "test_acc_syn": 0.7874476987447698,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.5924825263023377
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.7855,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7673246535069299,
            "val_best_fusion_loss": 0.4200587868690491,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7655,
                "test_acc_syn": 0.6698866022679546,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.4207892942428589
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7855,
                "test_acc_syn": 0.7673246535069299,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.4200587868690491
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7665,
                "test_acc_syn": 0.7870642587148257,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.4877122414112091
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7755,
                "test_acc_syn": 0.8139437211255774,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.4769379472732544
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.755,
                "test_acc_syn": 0.8126837463250735,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.5637954831123352
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.789,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8015075376884422,
            "val_best_fusion_loss": 0.4750521612167358,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7,
                "test_acc_syn": 0.5037688442211056,
                "val_best_acc_fusion": 0.71,
                "val_best_loss_fusion": 0.5686061811447144
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.754,
                "test_acc_syn": 0.7663316582914573,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.49623950481414797
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.789,
                "test_acc_syn": 0.8015075376884422,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.4750521612167358
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.77,
                "test_acc_syn": 0.8287269681742043,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.5087431001663208
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.76825,
                "test_acc_syn": 0.8195142378559463,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.5303177976608277
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.0,
        "psyn": 0.6,
        "pu1": 0.4,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.6970250362939869,
          "test_syn_std": 0.007373497236900724,
          "test_tot_mean": 0.7551666666666668,
          "test_tot_std": 0.014654824764864611
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5142067863071437,
          "test_syn_std": 0.01831895130411334,
          "test_tot_mean": 0.6975000000000001,
          "test_tot_std": 0.0014288690166235185
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.7917027806076624,
          "test_syn_std": 0.01734752101493682,
          "test_tot_mean": 0.7735833333333333,
          "test_tot_std": 0.019380330807863496
        }
      },
      "timestamp": 1766934527.4235694
    },
    "pu1=0.4000|pu2=0.0000|pred=0.1000|psyn=0.5000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.1,
          "syn": 0.5,
          "u1": 0.4,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.72475,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5010224948875256,
            "val_best_fusion_loss": 0.48605387926101684,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.72475,
                "test_acc_syn": 0.5010224948875256,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.48605387926101684
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.72425,
                "test_acc_syn": 0.5010224948875256,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.5016554045677185
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7535,
                "test_acc_syn": 0.6738241308793456,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.5080140519142151
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.731,
                "test_acc_syn": 0.6457055214723927,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.5500818061828613
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6655,
                "test_acc_syn": 0.5915132924335378,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.686703667640686
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 1,
            "test_acc_fusion": 0.744,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6646525679758308,
            "val_best_fusion_loss": 0.4969433069229126,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.69975,
                "test_acc_syn": 0.48942598187311176,
                "val_best_acc_fusion": 0.715,
                "val_best_loss_fusion": 0.6023618984222412
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7095,
                "test_acc_syn": 0.4828801611278953,
                "val_best_acc_fusion": 0.715,
                "val_best_loss_fusion": 0.5525268244743348
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.744,
                "test_acc_syn": 0.6646525679758308,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.4969433069229126
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.76475,
                "test_acc_syn": 0.6611278952668681,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.5087849950790405
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.66225,
                "test_acc_syn": 0.5453172205438066,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.6878950691223145
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.73275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6612265084075173,
            "val_best_fusion_loss": 0.5266200590133667,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.714,
                "test_acc_syn": 0.49159248269040556,
                "val_best_acc_fusion": 0.71,
                "val_best_loss_fusion": 0.585648455619812
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.71225,
                "test_acc_syn": 0.4797230464886251,
                "val_best_acc_fusion": 0.72,
                "val_best_loss_fusion": 0.5571376991271972
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.73275,
                "test_acc_syn": 0.6612265084075173,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.5266200590133667
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.723,
                "test_acc_syn": 0.6508407517309595,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.5661615300178527
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.67275,
                "test_acc_syn": 0.5687438180019783,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.6862738633155823
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.7255,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5025562372188139
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.70125,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4914400805639476
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.7145,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4930761622156281
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5015337423312883,
            "val_best_fusion_loss": 0.4847296714782715,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.725,
                "test_acc_syn": 0.5015337423312883,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.4847296714782715
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7235,
                "test_acc_syn": 0.49233128834355827,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.4889111232757568
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.743,
                "test_acc_syn": 0.6922290388548057,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.5392940330505371
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.69275,
                "test_acc_syn": 0.8185071574642127,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.5091233611106872
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.70375,
                "test_acc_syn": 0.7724948875255624,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.6463234233856201
              }
            ]
          },
          {
            "best_lambda_kl": 10.0,
            "seed": 1,
            "test_acc_fusion": 0.69425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.8041289023162135,
            "val_best_fusion_loss": 0.5440191578865051,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.70325,
                "test_acc_syn": 0.49244712990936557,
                "val_best_acc_fusion": 0.705,
                "val_best_loss_fusion": 0.6012593042850495
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.716,
                "test_acc_syn": 0.4949647532729104,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.567480387687683
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.715,
                "test_acc_syn": 0.7145015105740181,
                "val_best_acc_fusion": 0.72,
                "val_best_loss_fusion": 0.5609382581710816
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.69425,
                "test_acc_syn": 0.8041289023162135,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.5440191578865051
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.69075,
                "test_acc_syn": 0.7598187311178247,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.6366777014732361
              }
            ]
          },
          {
            "best_lambda_kl": 10.0,
            "seed": 2,
            "test_acc_fusion": 0.69075,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.7838773491592482,
            "val_best_fusion_loss": 0.529679160118103,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.71425,
                "test_acc_syn": 0.49060336300692386,
                "val_best_acc_fusion": 0.71,
                "val_best_loss_fusion": 0.585767433643341
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.71325,
                "test_acc_syn": 0.48714144411473786,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.5684876799583435
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.73925,
                "test_acc_syn": 0.7027695351137487,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.5742347240447998
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.69075,
                "test_acc_syn": 0.7838773491592482,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.529679160118103
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.69325,
                "test_acc_syn": 0.7472799208704253,
                "val_best_acc_fusion": 0.715,
                "val_best_loss_fusion": 0.6466321086883545
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.1,
        "psyn": 0.5,
        "pu1": 0.4,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.6089671904236246,
          "test_syn_std": 0.07634124023893088,
          "test_tot_mean": 0.7338333333333334,
          "test_tot_std": 0.007896025723249775
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4956908266661299,
          "test_syn_std": 0.004900312053697565,
          "test_tot_mean": 0.7137500000000001,
          "test_tot_std": 0.0099142153833103
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.6965133312689167,
          "test_syn_std": 0.1381190583712285,
          "test_tot_mean": 0.7033333333333333,
          "test_tot_std": 0.015387133875055763
        }
      },
      "timestamp": 1766937155.1731951
    },
    "pu1=0.4000|pu2=0.0000|pred=0.2000|psyn=0.4000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.2,
          "syn": 0.4,
          "u1": 0.4,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.7795,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5170637475853187,
            "val_best_fusion_loss": 0.4194677126407623,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7795,
                "test_acc_syn": 0.5170637475853187,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.4194677126407623
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7665,
                "test_acc_syn": 0.510624597553123,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.43529391527175904
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.732,
                "test_acc_syn": 0.6007726980038635,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.48494490146636965
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.73375,
                "test_acc_syn": 0.5846748229233741,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.5081990838050843
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.655,
                "test_acc_syn": 0.5486155827430779,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.6871337890625
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.76675,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5046267735965454,
            "val_best_fusion_loss": 0.4976398253440857,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.76275,
                "test_acc_syn": 0.500308451573103,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.5304349088668823
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.76675,
                "test_acc_syn": 0.5046267735965454,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.4976398253440857
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.75025,
                "test_acc_syn": 0.49290561381863046,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.5664050388336181
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.748,
                "test_acc_syn": 0.6051819864281308,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.5609742689132691
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6965,
                "test_acc_syn": 0.5151141270820481,
                "val_best_acc_fusion": 0.71,
                "val_best_loss_fusion": 0.6899307084083557
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.77325,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.506574827802129,
            "val_best_fusion_loss": 0.43631796598434447,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.77325,
                "test_acc_syn": 0.506574827802129,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.43631796598434447
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.775,
                "test_acc_syn": 0.5140889167188478,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.4463199138641357
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.75075,
                "test_acc_syn": 0.6123982467125861,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.4701985430717468
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.73875,
                "test_acc_syn": 0.5660613650594866,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.5065589046478272
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6655,
                "test_acc_syn": 0.5378835316217908,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.6858745241165161
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.78025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5170637475853187
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.76225,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.500308451573103
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.77275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5046963055729493
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.77975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5177076625885383,
            "val_best_fusion_loss": 0.4186835253238678,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.77975,
                "test_acc_syn": 0.5177076625885383,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.4186835253238678
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.78,
                "test_acc_syn": 0.5209272376046362,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.4313147878646851
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.73575,
                "test_acc_syn": 0.6638763683193818,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.5245562672615052
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.63625,
                "test_acc_syn": 0.7495170637475853,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.6402796483039856
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.61675,
                "test_acc_syn": 0.7411461687057308,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.6874166393280029
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.767,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5046267735965454,
            "val_best_fusion_loss": 0.5011713790893555,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.762,
                "test_acc_syn": 0.499691548426897,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.5302660703659058
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.767,
                "test_acc_syn": 0.5046267735965454,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.5011713790893555
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.715,
                "test_acc_syn": 0.6292412091301666,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.567285623550415
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.5995,
                "test_acc_syn": 0.716841455891425,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.6436930465698242
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6295,
                "test_acc_syn": 0.7174583590376311,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.6861232995986939
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.77075,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5109580463368817,
            "val_best_fusion_loss": 0.4281267094612122,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.77375,
                "test_acc_syn": 0.5084533500313086,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.4377511119842529
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.77075,
                "test_acc_syn": 0.5109580463368817,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.4281267094612122
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.74075,
                "test_acc_syn": 0.493425172197871,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.5363845837116241
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.6395,
                "test_acc_syn": 0.7914840325610519,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.5882981586456298
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.63725,
                "test_acc_syn": 0.7432686286787727,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.6843928813934326
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.2,
        "psyn": 0.4,
        "pu1": 0.4,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5094217829946643,
          "test_syn_std": 0.0054618950252687875,
          "test_tot_mean": 0.7731666666666667,
          "test_tot_std": 0.0052054992289137765
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5073561682437903,
          "test_syn_std": 0.007094182507991696,
          "test_tot_mean": 0.7717499999999999,
          "test_tot_std": 0.007382411530116709
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5110974941739884,
          "test_syn_std": 0.005341160827614505,
          "test_tot_mean": 0.7725,
          "test_tot_std": 0.0053502336397581885
        }
      },
      "timestamp": 1766939784.110028
    },
    "pu1=0.4000|pu2=0.0000|pred=0.3000|psyn=0.3000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.3,
          "syn": 0.3,
          "u1": 0.4,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.814,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5106202209005948,
            "val_best_fusion_loss": 0.3573095703125,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.814,
                "test_acc_syn": 0.5106202209005948,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.3573095703125
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.81225,
                "test_acc_syn": 0.508071367884452,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.3888263463973999
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.767,
                "test_acc_syn": 0.5216652506372133,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.4409266471862793
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.78075,
                "test_acc_syn": 0.5225148683092609,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.49837101459503175
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.675,
                "test_acc_syn": 0.49872557349192864,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.6848976230621338
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.818,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.514792899408284,
            "val_best_fusion_loss": 0.41044769048690793,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.81725,
                "test_acc_syn": 0.5190194420963652,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.42291276931762695
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.818,
                "test_acc_syn": 0.514792899408284,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.41044769048690793
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.73725,
                "test_acc_syn": 0.5105663567202029,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.5056862640380859
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.785,
                "test_acc_syn": 0.5291631445477599,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.5515786695480347
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.683,
                "test_acc_syn": 0.5164835164835165,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.6885476160049439
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.8045,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49349593495934957,
            "val_best_fusion_loss": 0.3336876076459885,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8125,
                "test_acc_syn": 0.5024390243902439,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.34941610097885134
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8045,
                "test_acc_syn": 0.49349593495934957,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.3336876076459885
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.74925,
                "test_acc_syn": 0.4943089430894309,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.4371205449104309
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.75525,
                "test_acc_syn": 0.5227642276422764,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.5142626762390137
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.694,
                "test_acc_syn": 0.5235772357723577,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.6866323137283326
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.81325,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.508071367884452
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.81625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5173288250211328
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.81275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5024390243902439
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.8135,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.508071367884452,
            "val_best_fusion_loss": 0.35740517139434813,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8135,
                "test_acc_syn": 0.508071367884452,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.35740517139434813
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.813,
                "test_acc_syn": 0.5097706032285472,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.37070580244064333
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.79325,
                "test_acc_syn": 0.5233644859813084,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.5216927051544189
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.81,
                "test_acc_syn": 0.5055225148683092,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.6672419834136963
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.694,
                "test_acc_syn": 0.6321155480033984,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.6900745558738709
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.81675,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.518174133558749,
            "val_best_fusion_loss": 0.42361457109451295,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.81675,
                "test_acc_syn": 0.518174133558749,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.42361457109451295
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.80975,
                "test_acc_syn": 0.5156382079459002,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.4444242739677429
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.81375,
                "test_acc_syn": 0.5088757396449705,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.5395276069641113
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.789,
                "test_acc_syn": 0.5173288250211328,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.6668619394302369
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.69175,
                "test_acc_syn": 0.63229078613694,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.6907615232467651
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.805,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4951219512195122,
            "val_best_fusion_loss": 0.33435280799865724,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8125,
                "test_acc_syn": 0.5024390243902439,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.3509522759914398
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.805,
                "test_acc_syn": 0.4951219512195122,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.33435280799865724
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7995,
                "test_acc_syn": 0.5292682926829269,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.5107865357398986
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.56075,
                "test_acc_syn": 0.6991869918699187,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.6540880632400513
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.569,
                "test_acc_syn": 0.6422764227642277,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.6887219905853271
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.3,
        "psyn": 0.3,
        "pu1": 0.4,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5063030184227427,
          "test_syn_std": 0.00921480155730886,
          "test_tot_mean": 0.8121666666666666,
          "test_tot_std": 0.00566176258382099
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5092797390986096,
          "test_syn_std": 0.006138493922253134,
          "test_tot_mean": 0.8140833333333334,
          "test_tot_std": 0.0015456030825826347
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5071224842209044,
          "test_syn_std": 0.009434901971070523,
          "test_tot_mean": 0.81175,
          "test_tot_std": 0.004953954649233919
        }
      },
      "timestamp": 1766942421.6006083
    },
    "pu1=0.4000|pu2=0.0000|pred=0.4000|psyn=0.2000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.4,
          "syn": 0.2,
          "u1": 0.4,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.855,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5239948119325551,
            "val_best_fusion_loss": 0.2459105944633484,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.855,
                "test_acc_syn": 0.5239948119325551,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.2459105944633484
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.86075,
                "test_acc_syn": 0.522697795071336,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.29347437143325805
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8255,
                "test_acc_syn": 0.496757457846952,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.3643379855155945
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.82275,
                "test_acc_syn": 0.5343709468223087,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.42611520886421206
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.74825,
                "test_acc_syn": 0.5188067444876784,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.6795875310897828
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.851,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4905422446406053,
            "val_best_fusion_loss": 0.27357364416122437,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.851,
                "test_acc_syn": 0.4905422446406053,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.27357364416122437
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.85625,
                "test_acc_syn": 0.5145018915510718,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.2840707603096962
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.80825,
                "test_acc_syn": 0.49936948297604034,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.3983202147483826
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8235,
                "test_acc_syn": 0.501891551071879,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.4796315360069275
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7,
                "test_acc_syn": 0.5069356872635561,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.6844833755493164
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.86,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5154894671623296,
            "val_best_fusion_loss": 0.3677224576473236,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.85075,
                "test_acc_syn": 0.5266418835192069,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.37273017525672913
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.86,
                "test_acc_syn": 0.5154894671623296,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.3677224576473236
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8245,
                "test_acc_syn": 0.48079306071871125,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.42627796173095706
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8125,
                "test_acc_syn": 0.5043370508054523,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.49032131910324095
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.71775,
                "test_acc_syn": 0.5204460966542751,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.6867519760131836
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.85525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5252918287937743
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.8525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4930643127364439
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.8505,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5266418835192069
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.85475,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.522697795071336,
            "val_best_fusion_loss": 0.2451135039329529,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.85475,
                "test_acc_syn": 0.522697795071336,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.2451135039329529
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.84825,
                "test_acc_syn": 0.5201037613488976,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.26050341963768003
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.85125,
                "test_acc_syn": 0.5071335927367056,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.4684982442855835
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8325,
                "test_acc_syn": 0.5019455252918288,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.6606136846542359
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.722,
                "test_acc_syn": 0.5538261997405967,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.6897211837768554
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.853,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4930643127364439,
            "val_best_fusion_loss": 0.2733159664273262,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.853,
                "test_acc_syn": 0.4930643127364439,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.2733159664273262
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.862,
                "test_acc_syn": 0.510718789407314,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.28210540890693664
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.85325,
                "test_acc_syn": 0.501891551071879,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.4848249220848084
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8395,
                "test_acc_syn": 0.49558638083228246,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.6609042978286743
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.78675,
                "test_acc_syn": 0.5523329129886507,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.6900025868415832
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.85125,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5278810408921933,
            "val_best_fusion_loss": 0.37265390872955323,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.85125,
                "test_acc_syn": 0.5278810408921933,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.37265390872955323
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.852,
                "test_acc_syn": 0.49814126394052044,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.37943140268325803
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.849,
                "test_acc_syn": 0.5055762081784386,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.4991831159591675
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.841,
                "test_acc_syn": 0.5216852540272615,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.6645974588394165
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.83325,
                "test_acc_syn": 0.4969021065675341,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.690243034362793
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.4,
        "psyn": 0.2,
        "pu1": 0.4,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5100088412451633,
          "test_syn_std": 0.0141961616863748,
          "test_tot_mean": 0.8553333333333333,
          "test_tot_std": 0.0036817870057290905
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5149993416831418,
          "test_syn_std": 0.01552019723048581,
          "test_tot_mean": 0.85275,
          "test_tot_std": 0.0019472202409246198
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5145477162333244,
          "test_syn_std": 0.015337730789726613,
          "test_tot_mean": 0.8529999999999999,
          "test_tot_std": 0.0014288690166235445
        }
      },
      "timestamp": 1766945054.1522977
    },
    "pu1=0.4000|pu2=0.0000|pred=0.5000|psyn=0.1000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.5,
          "syn": 0.1,
          "u1": 0.4,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.905,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49343832020997375,
            "val_best_fusion_loss": 0.17848576486110687,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.905,
                "test_acc_syn": 0.49343832020997375,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.17848576486110687
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.90625,
                "test_acc_syn": 0.48556430446194226,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.20539534449577332
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8695,
                "test_acc_syn": 0.5223097112860893,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.31097848892211916
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.879,
                "test_acc_syn": 0.5223097112860893,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.394494411945343
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7525,
                "test_acc_syn": 0.5013123359580053,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.6824454164505005
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.88975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49406175771971494,
            "val_best_fusion_loss": 0.2902805328369141,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.89725,
                "test_acc_syn": 0.5130641330166271,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.30494283229112623
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.88975,
                "test_acc_syn": 0.49406175771971494,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.2902805328369141
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.84925,
                "test_acc_syn": 0.505938242280285,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.33616169333457946
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.83725,
                "test_acc_syn": 0.4845605700712589,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.4416368782520294
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.72275,
                "test_acc_syn": 0.5083135391923991,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.685554461479187
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.86025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4745762711864407,
            "val_best_fusion_loss": 0.2529380615055561,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.89425,
                "test_acc_syn": 0.4963680387409201,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.2756901830434799
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.86025,
                "test_acc_syn": 0.4745762711864407,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.2529380615055561
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.83425,
                "test_acc_syn": 0.4963680387409201,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.30606231212615964
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.86375,
                "test_acc_syn": 0.5036319612590799,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.41025052666664125
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.75525,
                "test_acc_syn": 0.48426150121065376,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.6837109661102295
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.90475,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49606299212598426
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.89675,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4845605700712589
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.89425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4939467312348668
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.90425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49606299212598426,
            "val_best_fusion_loss": 0.1783553171157837,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.90425,
                "test_acc_syn": 0.49606299212598426,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.1783553171157837
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.906,
                "test_acc_syn": 0.48031496062992124,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.2083418846130371
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.90175,
                "test_acc_syn": 0.47244094488188976,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.45219328165054323
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.899,
                "test_acc_syn": 0.4881889763779528,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.6565184020996093
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8785,
                "test_acc_syn": 0.5039370078740157,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.6895853805541993
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.8965,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4845605700712589,
            "val_best_fusion_loss": 0.2819157749414444,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8965,
                "test_acc_syn": 0.48693586698337293,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.30498052179813384
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8965,
                "test_acc_syn": 0.4845605700712589,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.2819157749414444
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.89,
                "test_acc_syn": 0.5225653206650831,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.4741524767875671
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8945,
                "test_acc_syn": 0.505938242280285,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.6594637823104859
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.872,
                "test_acc_syn": 0.4750593824228028,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.6900533962249756
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.90725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48184019370460046,
            "val_best_fusion_loss": 0.2599211862683296,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.89425,
                "test_acc_syn": 0.4915254237288136,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.2754087144136429
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.90725,
                "test_acc_syn": 0.48184019370460046,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.2599211862683296
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.89925,
                "test_acc_syn": 0.5084745762711864,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.45842479944229125
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.86525,
                "test_acc_syn": 0.4939467312348668,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.6583018350601196
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.87775,
                "test_acc_syn": 0.48184019370460046,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.6897343707084655
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.5,
        "psyn": 0.1,
        "pu1": 0.4,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.48735878303870983,
          "test_syn_std": 0.009042183568223925,
          "test_tot_mean": 0.8850000000000001,
          "test_tot_std": 0.018575297216105797
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4915234311440367,
          "test_syn_std": 0.004998714219938371,
          "test_tot_mean": 0.8985833333333334,
          "test_tot_std": 0.004478342947514823
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.48748791863394786,
          "test_syn_std": 0.006164361331581034,
          "test_tot_mean": 0.9026666666666666,
          "test_tot_std": 0.004529226080567081
        }
      },
      "timestamp": 1766947700.3985517
    },
    "pu1=0.4000|pu2=0.0000|pred=0.6000|psyn=0.0000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.6,
          "syn": 0.0,
          "u1": 0.4,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.935,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.15040113627910615,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95025,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.15870716214179992
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.935,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.15040113627910615
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.91725,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.22012657284736634
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9325,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.31281031608581544
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.82825,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.6832493925094605
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.957,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.09014663696289063,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.957,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.09014663696289063
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.95225,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.09030451238155365
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.93125,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.25426126897335055
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.972,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.3527900838851929
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.813,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.6830141353607178
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.95225,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.07705946405418217,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95225,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.07705946405418217
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.95525,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.07806563720107079
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9525,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.22292293906211852
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.93125,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.4066025972366333
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7645,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.6787406778335572
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.9505,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.9575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.952,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.9565,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.14278847157955168,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9505,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.1592139858007431
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9565,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.14278847157955168
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.93325,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.43228549242019654
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9515,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.649767005443573
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.9115,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.6893871903419495
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.9575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.09058124482631684,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9575,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.09058124482631684
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9525,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.10017928838729859
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.949,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.423333603143692
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.94,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.6532224392890931
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.92875,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.6890587091445923
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.952,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.07608253971207887,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.952,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.07608253971207887
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.953,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.1022769743949175
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.949,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.4178177833557129
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9495,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.6518938398361206
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.92275,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.6894770240783692
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.6,
        "psyn": 0.0,
        "pu1": 0.4,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9480833333333333,
          "test_tot_std": 0.009452365958966128
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9533333333333333,
          "test_tot_std": 0.003009245014211309
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9553333333333334,
          "test_tot_std": 0.0023921166824012485
        }
      },
      "timestamp": 1766950349.7081304
    },
    "pu1=0.5000|pu2=0.0000|pred=0.0000|psyn=0.5000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.0,
          "syn": 0.5,
          "u1": 0.5,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 1.0,
            "seed": 0,
            "test_acc_fusion": 0.748,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.619482496194825,
            "val_best_fusion_loss": 0.5040419018268585,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.74075,
                "test_acc_syn": 0.495687468290208,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.5308523106575013
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.73925,
                "test_acc_syn": 0.4941653982749873,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.5297559595108032
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.748,
                "test_acc_syn": 0.619482496194825,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.5040419018268585
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.79025,
                "test_acc_syn": 0.6529680365296804,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.5302443027496337
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.708,
                "test_acc_syn": 0.5976661593099949,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.6878609490394593
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 1,
            "test_acc_fusion": 0.786,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6761421319796954,
            "val_best_fusion_loss": 0.48000045895576476,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.755,
                "test_acc_syn": 0.5106598984771573,
                "val_best_acc_fusion": 0.73,
                "val_best_loss_fusion": 0.5407488346099854
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.75975,
                "test_acc_syn": 0.516751269035533,
                "val_best_acc_fusion": 0.72,
                "val_best_loss_fusion": 0.5320650458335876
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.786,
                "test_acc_syn": 0.6761421319796954,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.48000045895576476
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.798,
                "test_acc_syn": 0.6868020304568528,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.555968816280365
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.688,
                "test_acc_syn": 0.5741116751269035,
                "val_best_acc_fusion": 0.715,
                "val_best_loss_fusion": 0.6885433959960937
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.7975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6775631500742942,
            "val_best_fusion_loss": 0.46901992917060853,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.7455,
                "test_acc_syn": 0.5032194155522536,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.530179557800293
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7455,
                "test_acc_syn": 0.5012382367508668,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.515404977798462
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7975,
                "test_acc_syn": 0.6775631500742942,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.46901992917060853
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.80575,
                "test_acc_syn": 0.7067855373947499,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.564947578907013
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.72925,
                "test_acc_syn": 0.6131748390292224,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.687636387348175
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.74,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49518011161846776
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.7555,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5116751269035533
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.7445,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5017335314512135
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.7435,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4926433282597666,
            "val_best_fusion_loss": 0.518287763595581,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.73975,
                "test_acc_syn": 0.4941653982749873,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.5305884456634522
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7435,
                "test_acc_syn": 0.4926433282597666,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.518287763595581
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.77,
                "test_acc_syn": 0.7097919837645865,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.563398425579071
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.71025,
                "test_acc_syn": 0.8056823947234906,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.5504383516311645
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.70425,
                "test_acc_syn": 0.7488584474885844,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.6454036474227905
              }
            ]
          },
          {
            "best_lambda_kl": 10.0,
            "seed": 1,
            "test_acc_fusion": 0.70725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.798984771573604,
            "val_best_fusion_loss": 0.5105156660079956,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.755,
                "test_acc_syn": 0.5106598984771573,
                "val_best_acc_fusion": 0.73,
                "val_best_loss_fusion": 0.5395951843261719
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7475,
                "test_acc_syn": 0.5030456852791878,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.5248249518871307
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.77575,
                "test_acc_syn": 0.717258883248731,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.5449956822395324
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.70725,
                "test_acc_syn": 0.798984771573604,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.5105156660079956
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.728,
                "test_acc_syn": 0.7568527918781726,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.6480216073989868
              }
            ]
          },
          {
            "best_lambda_kl": 10.0,
            "seed": 2,
            "test_acc_fusion": 0.7055,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.807825656265478,
            "val_best_fusion_loss": 0.4826716089248657,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.74575,
                "test_acc_syn": 0.5037147102526003,
                "val_best_acc_fusion": 0.74,
                "val_best_loss_fusion": 0.5293859434127808
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.752,
                "test_acc_syn": 0.5136206042595344,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.5254467558860779
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.78725,
                "test_acc_syn": 0.6934125804853888,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.5321792554855347
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7055,
                "test_acc_syn": 0.807825656265478,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.4826716089248657
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.70975,
                "test_acc_syn": 0.7974244675581972,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.630698401927948
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.0,
        "psyn": 0.5,
        "pu1": 0.5,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.6577292594162716,
          "test_syn_std": 0.0270507670352659,
          "test_tot_mean": 0.7771666666666667,
          "test_tot_std": 0.021151569419049946
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5028629233244115,
          "test_syn_std": 0.006781249974069972,
          "test_tot_mean": 0.7466666666666666,
          "test_tot_std": 0.006510674994874844
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.6998179186996163,
          "test_syn_std": 0.14653901301581393,
          "test_tot_mean": 0.71875,
          "test_tot_std": 0.017515469353307864
        }
      },
      "timestamp": 1766954077.0375576
    },
    "pu1=0.5000|pu2=0.0000|pred=0.1000|psyn=0.4000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.1,
          "syn": 0.4,
          "u1": 0.5,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.76375,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4792713567839196,
            "val_best_fusion_loss": 0.42253966331481935,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.76375,
                "test_acc_syn": 0.4792713567839196,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.42253966331481935
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.771,
                "test_acc_syn": 0.49246231155778897,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.4483652997016907
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.73875,
                "test_acc_syn": 0.5917085427135679,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.4834049391746521
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.748,
                "test_acc_syn": 0.5722361809045227,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.5296897339820862
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.65825,
                "test_acc_syn": 0.5100502512562815,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.6865732955932617
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.76375,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49426674713337354,
            "val_best_fusion_loss": 0.43738388538360595,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.76375,
                "test_acc_syn": 0.49426674713337354,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.43738388538360595
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7575,
                "test_acc_syn": 0.4912492456246228,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.4399746716022491
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.72125,
                "test_acc_syn": 0.4876282438141219,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.5103441286087036
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.75975,
                "test_acc_syn": 0.5618587809293905,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.5619087100028992
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6855,
                "test_acc_syn": 0.5377187688593844,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.6873344230651856
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.76825,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5063211125158028,
            "val_best_fusion_loss": 0.5114418745040894,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.77775,
                "test_acc_syn": 0.5145385587863464,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.5252678203582763
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.76825,
                "test_acc_syn": 0.5063211125158028,
                "val_best_acc_fusion": 0.755,
                "val_best_loss_fusion": 0.5114418745040894
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.71975,
                "test_acc_syn": 0.5897597977243995,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5370220422744751
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7655,
                "test_acc_syn": 0.6150442477876106,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.5346684527397155
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.69075,
                "test_acc_syn": 0.5543615676359039,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.6863998317718506
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.763,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48178391959798994
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.765,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4966807483403742
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.7775,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.515802781289507
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.76525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48304020100502515,
            "val_best_fusion_loss": 0.4230482000112534,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.76525,
                "test_acc_syn": 0.48304020100502515,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.4230482000112534
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.76775,
                "test_acc_syn": 0.48932160804020103,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.4345345306396484
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7485,
                "test_acc_syn": 0.628140703517588,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.5299524974822998
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.631,
                "test_acc_syn": 0.7600502512562815,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.6267012691497803
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.617,
                "test_acc_syn": 0.696608040201005,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.6874652981758118
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.7625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4924562462281231,
            "val_best_fusion_loss": 0.4206178855895996,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.76375,
                "test_acc_syn": 0.49426674713337354,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.43714954376220705
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7625,
                "test_acc_syn": 0.4924562462281231,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.4206178855895996
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.73175,
                "test_acc_syn": 0.5431502715751357,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.5445270276069641
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.62525,
                "test_acc_syn": 0.751961375980688,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.6632930088043213
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.65125,
                "test_acc_syn": 0.7338563669281835,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.6762121295928956
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.7735,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5145385587863464,
            "val_best_fusion_loss": 0.5112647390365601,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.77775,
                "test_acc_syn": 0.515802781289507,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.5251298475265503
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7735,
                "test_acc_syn": 0.5145385587863464,
                "val_best_acc_fusion": 0.75,
                "val_best_loss_fusion": 0.5112647390365601
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.736,
                "test_acc_syn": 0.6946902654867256,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.5667811059951782
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.68,
                "test_acc_syn": 0.7629582806573957,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.588349974155426
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.651,
                "test_acc_syn": 0.7300884955752213,
                "val_best_acc_fusion": 0.735,
                "val_best_loss_fusion": 0.6801786589622497
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.1,
        "psyn": 0.4,
        "pu1": 0.5,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.49328640547769864,
          "test_syn_std": 0.01106475255364306,
          "test_tot_mean": 0.76525,
          "test_tot_std": 0.002121320343559618
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4980891497426237,
          "test_syn_std": 0.013923802966599676,
          "test_tot_mean": 0.7685,
          "test_tot_std": 0.006416125518306699
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.49667833533983147,
          "test_syn_std": 0.013201165682884083,
          "test_tot_mean": 0.7670833333333333,
          "test_tot_std": 0.004674101220793387
        }
      },
      "timestamp": 1766960016.1099403
    },
    "pu1=0.5000|pu2=0.0000|pred=0.2000|psyn=0.3000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.2,
          "syn": 0.3,
          "u1": 0.5,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.81025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4824120603015075,
            "val_best_fusion_loss": 0.3871427047252655,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.81025,
                "test_acc_syn": 0.4824120603015075,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.3871427047252655
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8115,
                "test_acc_syn": 0.5041876046901173,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.404357498884201
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.76225,
                "test_acc_syn": 0.5100502512562815,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.49261651158332825
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.774,
                "test_acc_syn": 0.5452261306532663,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.4820897054672241
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.669,
                "test_acc_syn": 0.5251256281407035,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.6859431958198547
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.82375,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5325994919559696,
            "val_best_fusion_loss": 0.4060306835174561,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.82375,
                "test_acc_syn": 0.5325994919559696,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.4060306835174561
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.819,
                "test_acc_syn": 0.5351397121083827,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.40940658330917357
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.74175,
                "test_acc_syn": 0.5325994919559696,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.4558348345756531
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.75825,
                "test_acc_syn": 0.5715495342929721,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.5222535181045532
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7115,
                "test_acc_syn": 0.5224386113463166,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.6861247277259827
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.82775,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5301507537688442,
            "val_best_fusion_loss": 0.40916599810123444,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.81425,
                "test_acc_syn": 0.5058626465661642,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.41667973637580874
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.82775,
                "test_acc_syn": 0.5301507537688442,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.40916599810123444
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.77175,
                "test_acc_syn": 0.5268006700167505,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.4980048847198486
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.7375,
                "test_acc_syn": 0.516750418760469,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.5417609131336212
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6465,
                "test_acc_syn": 0.48576214405360135,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.6861150312423706
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.811,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.483249581239531
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.824,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5359864521591872
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.81425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5058626465661642
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.81075,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.483249581239531,
            "val_best_fusion_loss": 0.3866040647029877,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.81075,
                "test_acc_syn": 0.483249581239531,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.3866040647029877
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.7985,
                "test_acc_syn": 0.4899497487437186,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.4190220880508423
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.807,
                "test_acc_syn": 0.47738693467336685,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.5255125641822815
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.588,
                "test_acc_syn": 0.6859296482412061,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.6686721467971801
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.774,
                "test_acc_syn": 0.5134003350083752,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.6902809810638427
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.8235,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5317527519051651,
            "val_best_fusion_loss": 0.4070902466773987,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8235,
                "test_acc_syn": 0.5317527519051651,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.4070902466773987
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.828,
                "test_acc_syn": 0.5486875529212532,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.4122955298423767
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.82,
                "test_acc_syn": 0.5325994919559696,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.5344705247879028
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.68625,
                "test_acc_syn": 0.6900931414055885,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.6652259922027588
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.5695,
                "test_acc_syn": 0.6714648602878917,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.6891279816627502
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.8155,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.518425460636516,
            "val_best_fusion_loss": 0.41094746589660647,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.81375,
                "test_acc_syn": 0.5041876046901173,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.4160487514734268
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8155,
                "test_acc_syn": 0.518425460636516,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.41094746589660647
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.81725,
                "test_acc_syn": 0.5134003350083752,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.528161244392395
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.79625,
                "test_acc_syn": 0.5711892797319933,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.6655149221420288
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.5695,
                "test_acc_syn": 0.6976549413735343,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.6901007318496704
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.2,
        "psyn": 0.3,
        "pu1": 0.5,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5150541020087737,
          "test_syn_std": 0.02310304806429163,
          "test_tot_mean": 0.8205833333333333,
          "test_tot_std": 0.007487025815072048
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5083662266549608,
          "test_syn_std": 0.021602396835303305,
          "test_tot_mean": 0.8164166666666667,
          "test_tot_std": 0.005523937806392141
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5111425979270707,
          "test_syn_std": 0.020460033530249153,
          "test_tot_mean": 0.8165833333333333,
          "test_tot_std": 0.00526123137255488
        }
      },
      "timestamp": 1766963207.8071468
    },
    "pu1=0.5000|pu2=0.0000|pred=0.3000|psyn=0.2000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.3,
          "syn": 0.2,
          "u1": 0.5,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.85575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49869451697127937,
            "val_best_fusion_loss": 0.3060921490192413,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8515,
                "test_acc_syn": 0.4804177545691906,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.3119559709727764
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.85575,
                "test_acc_syn": 0.49869451697127937,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.3060921490192413
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.80625,
                "test_acc_syn": 0.4908616187989556,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.4365310180187225
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.817,
                "test_acc_syn": 0.5117493472584856,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.5029212260246276
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.69925,
                "test_acc_syn": 0.46475195822454307,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.6847783088684082
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.86575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5153452685421995,
            "val_best_fusion_loss": 0.34163952112197876,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.86575,
                "test_acc_syn": 0.5153452685421995,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.34163952112197876
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.869,
                "test_acc_syn": 0.5217391304347826,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.35383472323417664
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.80625,
                "test_acc_syn": 0.510230179028133,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.4133067488670349
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.821,
                "test_acc_syn": 0.48721227621483376,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.4972771978378296
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7625,
                "test_acc_syn": 0.49232736572890023,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.6856368446350097
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.85575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49515738498789347,
            "val_best_fusion_loss": 0.41521703720092773,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.85575,
                "test_acc_syn": 0.49515738498789347,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.41521703720092773
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.85475,
                "test_acc_syn": 0.5072639225181598,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.4232114225625992
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.809,
                "test_acc_syn": 0.4939467312348668,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.49089430332183837
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.77825,
                "test_acc_syn": 0.5060532687651331,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.5232237434387207
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.70675,
                "test_acc_syn": 0.5,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.6841788530349732
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.852,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4751958224543081
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.86525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5140664961636828
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.857,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4939467312348668
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.852,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.47780678851174935,
            "val_best_fusion_loss": 0.31131491631269453,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.852,
                "test_acc_syn": 0.47780678851174935,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.31131491631269453
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8475,
                "test_acc_syn": 0.48433420365535246,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.31971088230609895
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.85325,
                "test_acc_syn": 0.49869451697127937,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.49230782270431517
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8215,
                "test_acc_syn": 0.5078328981723238,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.6635137414932251
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.78475,
                "test_acc_syn": 0.5469973890339426,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.6903605079650879
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.86575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5268542199488491,
            "val_best_fusion_loss": 0.3279487550258636,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.86475,
                "test_acc_syn": 0.5127877237851662,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.34136350274085997
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.86575,
                "test_acc_syn": 0.5268542199488491,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3279487550258636
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.85975,
                "test_acc_syn": 0.5230179028132992,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.4837061071395874
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8435,
                "test_acc_syn": 0.5063938618925832,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.661584906578064
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8395,
                "test_acc_syn": 0.5179028132992327,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.6901191353797913
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.85625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49031476997578693,
            "val_best_fusion_loss": 0.4137048578262329,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.85625,
                "test_acc_syn": 0.49031476997578693,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.4137048578262329
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.848,
                "test_acc_syn": 0.49878934624697335,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.42288396537303924
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8485,
                "test_acc_syn": 0.5,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.5144108533859253
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.85675,
                "test_acc_syn": 0.5145278450363197,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.6678833961486816
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.79675,
                "test_acc_syn": 0.5193704600484261,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.6903599166870117
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.3,
        "psyn": 0.2,
        "pu1": 0.5,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5030657235004574,
          "test_syn_std": 0.008802205992102288,
          "test_tot_mean": 0.8590833333333334,
          "test_tot_std": 0.004714045207910321
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.49440301661761926,
          "test_syn_std": 0.01587216569801896,
          "test_tot_mean": 0.8580833333333334,
          "test_tot_std": 0.0054632611343612475
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4983252594787951,
          "test_syn_std": 0.020809270197079677,
          "test_tot_mean": 0.858,
          "test_tot_std": 0.005748188120326865
        }
      },
      "timestamp": 1766969692.3776326
    },
    "pu1=0.5000|pu2=0.0000|pred=0.4000|psyn=0.1000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.4,
          "syn": 0.1,
          "u1": 0.5,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.905,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48717948717948717,
            "val_best_fusion_loss": 0.2979766285419464,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.90375,
                "test_acc_syn": 0.4717948717948718,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.29799737215042116
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.905,
                "test_acc_syn": 0.48717948717948717,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.2979766285419464
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.85,
                "test_acc_syn": 0.5076923076923077,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.38050166368484495
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.88525,
                "test_acc_syn": 0.5025641025641026,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.4238604700565338
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.76275,
                "test_acc_syn": 0.49743589743589745,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.6842394065856934
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.9045,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5586034912718204,
            "val_best_fusion_loss": 0.31445936441421507,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.90375,
                "test_acc_syn": 0.5411471321695761,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.34054176926612856
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9045,
                "test_acc_syn": 0.5586034912718204,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.31445936441421507
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8815,
                "test_acc_syn": 0.513715710723192,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.35125911235809326
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.872,
                "test_acc_syn": 0.5261845386533666,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.4965685033798218
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7505,
                "test_acc_syn": 0.5461346633416458,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.685340609550476
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.903,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5153846153846153,
            "val_best_fusion_loss": 0.21638292998075484,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9025,
                "test_acc_syn": 0.517948717948718,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.23168459579348563
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.903,
                "test_acc_syn": 0.5153846153846153,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.21638292998075484
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.84675,
                "test_acc_syn": 0.49743589743589745,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.3730440330505371
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.85525,
                "test_acc_syn": 0.5307692307692308,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.47360093593597413
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7385,
                "test_acc_syn": 0.517948717948718,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.6829557061195374
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.90375,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4717948717948718
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.904,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5411471321695761
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.901,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5153846153846153
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.8815,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.44871794871794873,
            "val_best_fusion_loss": 0.25999113082885744,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.903,
                "test_acc_syn": 0.46923076923076923,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.29888846397399904
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8815,
                "test_acc_syn": 0.44871794871794873,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.25999113082885744
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9005,
                "test_acc_syn": 0.5051282051282051,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.45880542039871214
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9035,
                "test_acc_syn": 0.4794871794871795,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.6598804688453674
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.86725,
                "test_acc_syn": 0.4641025641025641,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.6900293970108032
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.90425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5286783042394015,
            "val_best_fusion_loss": 0.3095299988985062,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9035,
                "test_acc_syn": 0.5336658354114713,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.3429248595237732
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.90425,
                "test_acc_syn": 0.5286783042394015,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.3095299988985062
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.88375,
                "test_acc_syn": 0.5311720698254364,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.4750721168518066
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.88575,
                "test_acc_syn": 0.5610972568578554,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.6573008680343628
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8485,
                "test_acc_syn": 0.5311720698254364,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.689746561050415
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.9015,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.517948717948718,
            "val_best_fusion_loss": 0.2161121541261673,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9025,
                "test_acc_syn": 0.517948717948718,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.2322895446419716
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9015,
                "test_acc_syn": 0.517948717948718,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.2161121541261673
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.88575,
                "test_acc_syn": 0.517948717948718,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.44580971479415893
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.90225,
                "test_acc_syn": 0.5307692307692308,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.6572504591941833
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.875,
                "test_acc_syn": 0.5051282051282051,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.6895917129516601
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.4,
        "psyn": 0.1,
        "pu1": 0.5,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5203891979453076,
          "test_syn_std": 0.029372679767662762,
          "test_tot_mean": 0.9041666666666667,
          "test_tot_std": 0.0008498365855987909
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5094422064496877,
          "test_syn_std": 0.028623046340698097,
          "test_tot_mean": 0.9029166666666667,
          "test_tot_std": 0.0013591255358583476
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.49844832363535607,
          "test_syn_std": 0.035436456252111614,
          "test_tot_mean": 0.8957499999999999,
          "test_tot_std": 0.010138622523137302
        }
      },
      "timestamp": 1766976470.7753568
    },
    "pu1=0.5000|pu2=0.0000|pred=0.5000|psyn=0.0000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.5,
          "syn": 0.0,
          "u1": 0.5,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.95275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.16194872945547104,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95275,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.16194872945547104
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.955,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.16711339831352234
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9235,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.23208581328392028
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.924,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.3900166034698486
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.78375,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.6811395883560181
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.951,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.08821700096130371,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9555,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.09098166853189468
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.951,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.08821700096130371
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.93725,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.2590764784812927
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.928,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.43386393308639526
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8615,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.682464907169342
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.9505,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.08019529938697816,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95025,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.09318066537380218
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9505,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.08019529938697816
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.93025,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.27214114904403686
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.898,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.41875021934509277
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7215,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.6803591156005859
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.954,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.95575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.95,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.95375,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.14858926117420196,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.954,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.1615265879034996
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.95375,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.14858926117420196
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9295,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.4239919471740723
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.95225,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.6508803939819336
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.9255,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.6898169851303101
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.95575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.09162413150072098,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95575,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.09162413150072098
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9525,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.1102003276348114
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9425,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.41515296816825864
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.946,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.6534138154983521
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.92825,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.6889874172210694
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.94975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.09401377260684968,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.94975,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.09401377260684968
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.946,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.12110481858253479
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.95075,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.41273361921310425
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.94775,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.6507423973083496
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.9245,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.6894430136680603
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.5,
        "psyn": 0.0,
        "pu1": 0.5,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9514166666666667,
          "test_tot_std": 0.0009646530752325149
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.95325,
          "test_tot_std": 0.002406588179698954
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9530833333333333,
          "test_tot_std": 0.0024944382578492965
        }
      },
      "timestamp": 1766980009.4504929
    },
    "pu1=0.6000|pu2=0.0000|pred=0.0000|psyn=0.4000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.0,
          "syn": 0.4,
          "u1": 0.6,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.80925,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5146389069616135,
            "val_best_fusion_loss": 0.446880202293396,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.80925,
                "test_acc_syn": 0.5146389069616135,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.446880202293396
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.80225,
                "test_acc_syn": 0.5126870527000651,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.46584763526916506
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7855,
                "test_acc_syn": 0.5836044242029929,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.4685251033306122
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.81575,
                "test_acc_syn": 0.6369551073519844,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.4526212787628174
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.72175,
                "test_acc_syn": 0.5484710474951203,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.6848075342178345
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.79125,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.496319018404908,
            "val_best_fusion_loss": 0.48047401905059817,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.79075,
                "test_acc_syn": 0.496319018404908,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.4914886426925659
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.79125,
                "test_acc_syn": 0.496319018404908,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.48047401905059817
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.77,
                "test_acc_syn": 0.5429447852760736,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.5034447622299194
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.79725,
                "test_acc_syn": 0.6116564417177914,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.5313517677783967
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.6865,
                "test_acc_syn": 0.505521472392638,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.6866419792175293
              }
            ]
          },
          {
            "best_lambda_kl": 1.0,
            "seed": 2,
            "test_acc_fusion": 0.80225,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.6137761377613776,
            "val_best_fusion_loss": 0.42594319820404053,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.80475,
                "test_acc_syn": 0.5209102091020911,
                "val_best_acc_fusion": 0.76,
                "val_best_loss_fusion": 0.49395667552947997
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.79625,
                "test_acc_syn": 0.517220172201722,
                "val_best_acc_fusion": 0.77,
                "val_best_loss_fusion": 0.4950360631942749
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.80225,
                "test_acc_syn": 0.6137761377613776,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.42594319820404053
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8045,
                "test_acc_syn": 0.6273062730627307,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.5054385328292846
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.71875,
                "test_acc_syn": 0.5731857318573186,
                "val_best_acc_fusion": 0.78,
                "val_best_loss_fusion": 0.6869247341156006
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.80975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5152895250487963
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.789,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49141104294478527
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.8045,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5202952029520295
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.81025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.516590761223162,
            "val_best_fusion_loss": 0.4473105382919311,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.81025,
                "test_acc_syn": 0.516590761223162,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.4473105382919311
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8035,
                "test_acc_syn": 0.5094339622641509,
                "val_best_acc_fusion": 0.775,
                "val_best_loss_fusion": 0.4563023829460144
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.79,
                "test_acc_syn": 0.6356538711776187,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.5376290059089661
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.66025,
                "test_acc_syn": 0.7690305790500976,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.5754117822647095
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.66175,
                "test_acc_syn": 0.7150292778139232,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.6632474517822265
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.78825,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.496319018404908,
            "val_best_fusion_loss": 0.4718557548522949,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.78925,
                "test_acc_syn": 0.49263803680981594,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.4916784429550171
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.78825,
                "test_acc_syn": 0.496319018404908,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.4718557548522949
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.75425,
                "test_acc_syn": 0.6828220858895706,
                "val_best_acc_fusion": 0.785,
                "val_best_loss_fusion": 0.5352401447296142
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.62275,
                "test_acc_syn": 0.7484662576687117,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.605124990940094
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.62725,
                "test_acc_syn": 0.7233128834355829,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.6842451763153076
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.79875,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5116851168511685,
            "val_best_fusion_loss": 0.48392502188682557,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8045,
                "test_acc_syn": 0.5202952029520295,
                "val_best_acc_fusion": 0.765,
                "val_best_loss_fusion": 0.4939571952819824
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.79875,
                "test_acc_syn": 0.5116851168511685,
                "val_best_acc_fusion": 0.745,
                "val_best_loss_fusion": 0.48392502188682557
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7755,
                "test_acc_syn": 0.7355473554735548,
                "val_best_acc_fusion": 0.79,
                "val_best_loss_fusion": 0.5333334589004517
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.6585,
                "test_acc_syn": 0.7816728167281672,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.5699403309822082
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.689,
                "test_acc_syn": 0.7361623616236163,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.6774938893318176
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.0,
        "psyn": 0.4,
        "pu1": 0.6,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.541578021042633,
          "test_syn_std": 0.05159670934263558,
          "test_tot_mean": 0.8009166666666667,
          "test_tot_std": 0.007408703590297629
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5089985903152038,
          "test_syn_std": 0.012603057028561576,
          "test_tot_mean": 0.8010833333333333,
          "test_tot_std": 0.00880892855131779
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5081982988264129,
          "test_syn_std": 0.008635365816442647,
          "test_tot_mean": 0.7990833333333334,
          "test_tot_std": 0.008984554647962379
        }
      },
      "timestamp": 1766983037.1165788
    },
    "pu1=0.6000|pu2=0.0000|pred=0.1000|psyn=0.3000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.1,
          "syn": 0.3,
          "u1": 0.6,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.82075,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5148683092608326,
            "val_best_fusion_loss": 0.4334226632118225,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.826,
                "test_acc_syn": 0.49447748513169076,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.4468657922744751
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.82075,
                "test_acc_syn": 0.5148683092608326,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.4334226632118225
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.814,
                "test_acc_syn": 0.4825828377230246,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.5021604490280152
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.81925,
                "test_acc_syn": 0.5378079864061173,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.4811631941795349
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7335,
                "test_acc_syn": 0.5318606627017842,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.6862977027893067
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.8175,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4882943143812709,
            "val_best_fusion_loss": 0.38931175231933596,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8175,
                "test_acc_syn": 0.4882943143812709,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.38931175231933596
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8215,
                "test_acc_syn": 0.49414715719063546,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.3943112659454346
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.766,
                "test_acc_syn": 0.5091973244147158,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.4648452925682068
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.76725,
                "test_acc_syn": 0.5309364548494984,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.4897777712345123
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7105,
                "test_acc_syn": 0.5133779264214047,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.6846344566345215
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.82975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5050251256281407,
            "val_best_fusion_loss": 0.35894895672798155,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.82975,
                "test_acc_syn": 0.5050251256281407,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.35894895672798155
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.82375,
                "test_acc_syn": 0.5,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.37852890968322755
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.735,
                "test_acc_syn": 0.52428810720268,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.4713871431350708
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.787,
                "test_acc_syn": 0.585427135678392,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.512807832956314
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.71675,
                "test_acc_syn": 0.5326633165829145,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.6856302738189697
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.8255,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4927782497875956
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.81775,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4891304347826087
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.82875,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5025125628140703
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.826,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49447748513169076,
            "val_best_fusion_loss": 0.4464126205444336,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.826,
                "test_acc_syn": 0.49447748513169076,
                "val_best_acc_fusion": 0.795,
                "val_best_loss_fusion": 0.4464126205444336
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.82325,
                "test_acc_syn": 0.4995751911639762,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.4492106747627258
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7765,
                "test_acc_syn": 0.4800339847068819,
                "val_best_acc_fusion": 0.8,
                "val_best_loss_fusion": 0.5421739768981934
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.71725,
                "test_acc_syn": 0.6406117247238743,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.6643752813339233
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.57475,
                "test_acc_syn": 0.7085811384876806,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.6894963693618774
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.818,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4899665551839465,
            "val_best_fusion_loss": 0.3885860228538513,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.818,
                "test_acc_syn": 0.4899665551839465,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.3885860228538513
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.81425,
                "test_acc_syn": 0.4916387959866221,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.3947875881195068
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.815,
                "test_acc_syn": 0.49665551839464883,
                "val_best_acc_fusion": 0.805,
                "val_best_loss_fusion": 0.5249056172370911
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.75375,
                "test_acc_syn": 0.6438127090301003,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.6664358448982238
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.58625,
                "test_acc_syn": 0.6521739130434783,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.6899994015693665
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.8295,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5050251256281407,
            "val_best_fusion_loss": 0.35925767302513123,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8295,
                "test_acc_syn": 0.5050251256281407,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.35925767302513123
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.83175,
                "test_acc_syn": 0.5058626465661642,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.38637676477432253
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.82075,
                "test_acc_syn": 0.5108877721943048,
                "val_best_acc_fusion": 0.825,
                "val_best_loss_fusion": 0.5226536798477173
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.643,
                "test_acc_syn": 0.7035175879396985,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.6619077205657959
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.60525,
                "test_acc_syn": 0.7328308207705193,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.6897129845619202
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.1,
        "psyn": 0.3,
        "pu1": 0.6,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.502729249756748,
          "test_syn_std": 0.010969581744605548,
          "test_tot_mean": 0.8226666666666667,
          "test_tot_std": 0.005181430518903267
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.49480708246142485,
          "test_syn_std": 0.0056484487059962184,
          "test_tot_mean": 0.824,
          "test_tot_std": 0.00461428939996905
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.49648972198125935,
          "test_syn_std": 0.006310148377006742,
          "test_tot_mean": 0.8245,
          "test_tot_std": 0.004813176359397908
        }
      },
      "timestamp": 1766986081.8438993
    },
    "pu1=0.6000|pu2=0.0000|pred=0.2000|psyn=0.2000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.2,
          "syn": 0.2,
          "u1": 0.6,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.85625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.46956521739130436,
            "val_best_fusion_loss": 0.25583997011184695,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.85625,
                "test_acc_syn": 0.46956521739130436,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.25583997011184695
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.85275,
                "test_acc_syn": 0.4894409937888199,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.25679179906845095
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.82125,
                "test_acc_syn": 0.4906832298136646,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.3419001364707947
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.83075,
                "test_acc_syn": 0.5304347826086957,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.4429939818382263
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.72025,
                "test_acc_syn": 0.5031055900621118,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.6835687971115112
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.857,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4993464052287582,
            "val_best_fusion_loss": 0.37883954286575316,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.857,
                "test_acc_syn": 0.4993464052287582,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.37883954286575316
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.857,
                "test_acc_syn": 0.477124183006536,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.3789815449714661
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.79275,
                "test_acc_syn": 0.534640522875817,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.48451637506484985
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.85575,
                "test_acc_syn": 0.5241830065359477,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.4877689504623413
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7675,
                "test_acc_syn": 0.4980392156862745,
                "val_best_acc_fusion": 0.81,
                "val_best_loss_fusion": 0.6867502498626709
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.8615,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.47642679900744417,
            "val_best_fusion_loss": 0.39248386412858965,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.86075,
                "test_acc_syn": 0.47890818858560796,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.4045588284730911
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8615,
                "test_acc_syn": 0.47642679900744417,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.39248386412858965
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.7665,
                "test_acc_syn": 0.5124069478908189,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.47244197130203247
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.81425,
                "test_acc_syn": 0.5024813895781638,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.5222185111045837
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.69675,
                "test_acc_syn": 0.5148883374689827,
                "val_best_acc_fusion": 0.82,
                "val_best_loss_fusion": 0.6854543089866638
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.8565,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.47080745341614905
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.85625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4980392156862745
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.86075,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4813895781637717
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.85625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.46956521739130436,
            "val_best_fusion_loss": 0.2556769895553589,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.85625,
                "test_acc_syn": 0.46956521739130436,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.2556769895553589
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8615,
                "test_acc_syn": 0.4906832298136646,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.25945393323898314
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.852,
                "test_acc_syn": 0.4645962732919255,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.4583849787712097
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.85675,
                "test_acc_syn": 0.493167701863354,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.65964271068573
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.84375,
                "test_acc_syn": 0.5192546583850932,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.6897172045707702
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.857,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4993464052287582,
            "val_best_fusion_loss": 0.37854034662246705,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.857,
                "test_acc_syn": 0.4993464052287582,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.37854034662246705
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.85775,
                "test_acc_syn": 0.4954248366013072,
                "val_best_acc_fusion": 0.83,
                "val_best_loss_fusion": 0.3910080862045288
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.86225,
                "test_acc_syn": 0.5084967320261438,
                "val_best_acc_fusion": 0.84,
                "val_best_loss_fusion": 0.5252369856834411
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.80375,
                "test_acc_syn": 0.6,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.6651588678359985
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.787,
                "test_acc_syn": 0.4915032679738562,
                "val_best_acc_fusion": 0.815,
                "val_best_loss_fusion": 0.6905779981613159
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.86175,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48635235732009924,
            "val_best_fusion_loss": 0.3849428890645504,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8605,
                "test_acc_syn": 0.4801488833746898,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.40313503563404085
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.86175,
                "test_acc_syn": 0.48635235732009924,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3849428890645504
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8525,
                "test_acc_syn": 0.4801488833746898,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.5059700775146484
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8525,
                "test_acc_syn": 0.49379652605459057,
                "val_best_acc_fusion": 0.845,
                "val_best_loss_fusion": 0.6660563802719116
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.65575,
                "test_acc_syn": 0.5384615384615384,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.6904099750518798
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.2,
        "psyn": 0.2,
        "pu1": 0.6,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4817794738758356,
          "test_syn_std": 0.012733633507041067,
          "test_tot_mean": 0.85825,
          "test_tot_std": 0.002318404623873962
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4834120824220651,
          "test_syn_std": 0.011208928336829483,
          "test_tot_mean": 0.8578333333333333,
          "test_tot_std": 0.0020649186155606543
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4850879933133872,
          "test_syn_std": 0.012190946080555803,
          "test_tot_mean": 0.8583333333333334,
          "test_tot_std": 0.002435273199367099
        }
      },
      "timestamp": 1766992966.036418
    },
    "pu1=0.6000|pu2=0.0000|pred=0.3000|psyn=0.1000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.3,
          "syn": 0.1,
          "u1": 0.6,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.90875,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4892086330935252,
            "val_best_fusion_loss": 0.24121980905532836,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.90625,
                "test_acc_syn": 0.486810551558753,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.25163113832473755
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.90875,
                "test_acc_syn": 0.4892086330935252,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.24121980905532836
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8305,
                "test_acc_syn": 0.47002398081534774,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.3477324283123016
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8535,
                "test_acc_syn": 0.4940047961630695,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.4553997802734375
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8025,
                "test_acc_syn": 0.5251798561151079,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.6818703746795655
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.89775,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5297029702970297,
            "val_best_fusion_loss": 0.29861610889434814,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.90225,
                "test_acc_syn": 0.5024752475247525,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.3033753228187561
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.89775,
                "test_acc_syn": 0.5297029702970297,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.29861610889434814
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.82075,
                "test_acc_syn": 0.4777227722772277,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.40573501229286196
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.87825,
                "test_acc_syn": 0.5099009900990099,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.4622765779495239
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.72375,
                "test_acc_syn": 0.5123762376237624,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.6868111038208008
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.901,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48320413436692505,
            "val_best_fusion_loss": 0.22784552097320557,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.90325,
                "test_acc_syn": 0.48320413436692505,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.22839852213859557
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.901,
                "test_acc_syn": 0.48320413436692505,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.22784552097320557
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.86,
                "test_acc_syn": 0.5193798449612403,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.3874419355392456
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.89125,
                "test_acc_syn": 0.5142118863049095,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.4521904897689819
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.71925,
                "test_acc_syn": 0.5193798449612403,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.6822197580337525
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.90625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.486810551558753
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.90325,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5074257425742574
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.90175,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4806201550387597
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.9065,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49640287769784175,
            "val_best_fusion_loss": 0.251736136674881,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.906,
                "test_acc_syn": 0.486810551558753,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.252367901802063
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9065,
                "test_acc_syn": 0.49640287769784175,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.251736136674881
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.90125,
                "test_acc_syn": 0.4844124700239808,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.4520119690895081
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.859,
                "test_acc_syn": 0.4892086330935252,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.6592311787605286
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8775,
                "test_acc_syn": 0.4676258992805755,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.6899451303482056
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.903,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.504950495049505,
            "val_best_fusion_loss": 0.30297380447387695,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.903,
                "test_acc_syn": 0.504950495049505,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.30297380447387695
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.90075,
                "test_acc_syn": 0.504950495049505,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.3100780487060547
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9015,
                "test_acc_syn": 0.551980198019802,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.48491013526916504
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.88425,
                "test_acc_syn": 0.5148514851485149,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.6609565949440003
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.84125,
                "test_acc_syn": 0.5123762376237624,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.6899284291267395
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.903,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48578811369509045,
            "val_best_fusion_loss": 0.2284412807226181,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.903,
                "test_acc_syn": 0.48578811369509045,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.2284412807226181
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.90125,
                "test_acc_syn": 0.5064599483204134,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.2313600093126297
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.89675,
                "test_acc_syn": 0.49870801033591733,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.44959026932716367
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.89525,
                "test_acc_syn": 0.49870801033591733,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.6584978771209716
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.87825,
                "test_acc_syn": 0.5090439276485789,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.6897974944114685
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.3,
        "psyn": 0.1,
        "pu1": 0.6,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.50070524591916,
          "test_syn_std": 0.020650496613247363,
          "test_tot_mean": 0.9025,
          "test_tot_std": 0.0046142893999689995
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4916188163905901,
          "test_syn_std": 0.011459332115518145,
          "test_tot_mean": 0.9037499999999999,
          "test_tot_std": 0.0018708286933869526
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4957138288141458,
          "test_syn_std": 0.007838167560771468,
          "test_tot_mean": 0.9041666666666667,
          "test_tot_std": 0.0016499158227685862
        }
      },
      "timestamp": 1766999213.4112635
    },
    "pu1=0.6000|pu2=0.0000|pred=0.4000|psyn=0.0000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.4,
          "syn": 0.0,
          "u1": 0.6,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.95725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.17198544919490813,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95925,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.1730167329311371
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.95725,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.17198544919490813
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9365,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.2110580438375473
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9525,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.3564817547798157
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.75325,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.682126522064209
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.953,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.0811240091919899,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.953,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.08549996852874756
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.953,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.0811240091919899
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9215,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.2860126340389252
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.873,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.47679355859756467
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.73675,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.6836925053596496
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.95075,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.06819207668304443,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95075,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.06819207668304443
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.952,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.07544792711734771
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9075,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.2886693096160889
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.907,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.4441728377342224
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.78125,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.6806665420532226
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.9595,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.95175,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.95025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.95775,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.14537286818027495,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95925,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.1740964537858963
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.95775,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.14537286818027495
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.93525,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.4206886959075928
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.95725,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.6488750886917114
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.92775,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.6898637747764588
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.9515,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.08589238196611404,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9515,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.08589238196611404
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.94925,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.11291254341602325
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.94875,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.41783868074417113
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.94875,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.6538497543334961
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.9005,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.6890256357192993
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.95125,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.06875445127487183,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95125,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.06875445127487183
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.94825,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.09777410045266151
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.94225,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.4087727761268616
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.93825,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.6499128532409668
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.9285,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.6893097519874573
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.4,
        "psyn": 0.0,
        "pu1": 0.6,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9536666666666666,
          "test_tot_std": 0.0026951602714660673
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9538333333333333,
          "test_tot_std": 0.004053462169005103
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9535,
          "test_tot_std": 0.003006936425444769
        }
      },
      "timestamp": 1767002248.2289295
    },
    "pu1=0.7000|pu2=0.0000|pred=0.0000|psyn=0.3000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.0,
          "syn": 0.3,
          "u1": 0.7,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.84675,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5092905405405406,
            "val_best_fusion_loss": 0.3549714708328247,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8505,
                "test_acc_syn": 0.5135135135135135,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.35724462151527403
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.84675,
                "test_acc_syn": 0.5092905405405406,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.3549714708328247
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.82175,
                "test_acc_syn": 0.5295608108108109,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.4047857308387756
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8285,
                "test_acc_syn": 0.5228040540540541,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.3811608076095581
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.73,
                "test_acc_syn": 0.5329391891891891,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.6845672965049744
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.85125,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5067340067340067,
            "val_best_fusion_loss": 0.3281726834177971,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.85125,
                "test_acc_syn": 0.5067340067340067,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.3281726834177971
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.85025,
                "test_acc_syn": 0.5042087542087542,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.34241685658693316
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8175,
                "test_acc_syn": 0.5117845117845118,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.43441699266433714
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8305,
                "test_acc_syn": 0.5395622895622896,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.4434473776817322
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7475,
                "test_acc_syn": 0.49915824915824913,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.6841692233085632
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.8355,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48381877022653724,
            "val_best_fusion_loss": 0.330050585269928,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8355,
                "test_acc_syn": 0.48381877022653724,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.330050585269928
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.83725,
                "test_acc_syn": 0.4878640776699029,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.34459868192672727
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.78625,
                "test_acc_syn": 0.511326860841424,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.42807249307632445
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8295,
                "test_acc_syn": 0.5364077669902912,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.42404221534729003
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.66075,
                "test_acc_syn": 0.5283171521035599,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.6851027202606201
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.84975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5118243243243243
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.8495,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5033670033670034
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.83575,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48462783171521034
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.84925,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5101351351351351,
            "val_best_fusion_loss": 0.3576492056250572,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.84925,
                "test_acc_syn": 0.5101351351351351,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3576492056250572
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.84675,
                "test_acc_syn": 0.5016891891891891,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.36333321571350097
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.852,
                "test_acc_syn": 0.5092905405405406,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.5001207625865937
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.70775,
                "test_acc_syn": 0.6410472972972973,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.6597517204284667
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.57125,
                "test_acc_syn": 0.6621621621621622,
                "val_best_acc_fusion": 0.85,
                "val_best_loss_fusion": 0.6893865728378296
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.85025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5058922558922558,
            "val_best_fusion_loss": 0.32817795932292937,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.85025,
                "test_acc_syn": 0.5058922558922558,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.32817795932292937
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.848,
                "test_acc_syn": 0.5126262626262627,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.33740721821784975
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.84875,
                "test_acc_syn": 0.49915824915824913,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.4903812861442566
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.84425,
                "test_acc_syn": 0.5084175084175084,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.6616096687316895
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8365,
                "test_acc_syn": 0.5303030303030303,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.6900073289871216
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.83525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48381877022653724,
            "val_best_fusion_loss": 0.3300331223011017,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.83525,
                "test_acc_syn": 0.48381877022653724,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.3300331223011017
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8395,
                "test_acc_syn": 0.4854368932038835,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.33018007516860964
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8355,
                "test_acc_syn": 0.48220064724919093,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.49260332345962526
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.833,
                "test_acc_syn": 0.47572815533980584,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.662942533493042
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.72475,
                "test_acc_syn": 0.5631067961165048,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.6898128628730774
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.0,
        "psyn": 0.3,
        "pu1": 0.7,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.49994777250036154,
          "test_syn_std": 0.011452583465103958,
          "test_tot_mean": 0.8445,
          "test_tot_std": 0.006623820649745859
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.4999397198021793,
          "test_syn_std": 0.011364330366976684,
          "test_tot_mean": 0.8450000000000001,
          "test_tot_std": 0.006541533968930134
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.49994872041797606,
          "test_syn_std": 0.011536376552775332,
          "test_tot_mean": 0.8449166666666666,
          "test_tot_std": 0.0068475461947246664
        }
      },
      "timestamp": 1767005376.8923879
    },
    "pu1=0.7000|pu2=0.0000|pred=0.1000|psyn=0.2000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.1,
          "syn": 0.2,
          "u1": 0.7,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.87425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5126262626262627,
            "val_best_fusion_loss": 0.276786228120327,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.87425,
                "test_acc_syn": 0.5126262626262627,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.276786228120327
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.87925,
                "test_acc_syn": 0.5202020202020202,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.3033159881830215
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.79725,
                "test_acc_syn": 0.47095959595959597,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.3921142315864563
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.851,
                "test_acc_syn": 0.476010101010101,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.43943029522895816
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7795,
                "test_acc_syn": 0.4911616161616162,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.6817347860336304
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.87875,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5006877579092159,
            "val_best_fusion_loss": 0.28700562566518784,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8785,
                "test_acc_syn": 0.49105914718019256,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.3111233562231064
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.87875,
                "test_acc_syn": 0.5006877579092159,
                "val_best_acc_fusion": 0.885,
                "val_best_loss_fusion": 0.28700562566518784
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.832,
                "test_acc_syn": 0.49931224209078406,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.41414191484451296
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.854,
                "test_acc_syn": 0.5089408528198074,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.45604790925979616
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.73075,
                "test_acc_syn": 0.5103163686382394,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.6854639792442322
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.855,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4975062344139651,
            "val_best_fusion_loss": 0.3219060307741165,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.855,
                "test_acc_syn": 0.4975062344139651,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.3219060307741165
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.85825,
                "test_acc_syn": 0.4837905236907731,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.34065892338752746
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8165,
                "test_acc_syn": 0.4975062344139651,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.41167181730270386
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.842,
                "test_acc_syn": 0.5049875311720698,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.41984530210494997
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7285,
                "test_acc_syn": 0.5211970074812967,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.6847021174430847
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.87425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5113636363636364
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.88025,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4951856946354883
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.855,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49875311720698257
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.874,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5126262626262627,
            "val_best_fusion_loss": 0.277067294716835,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.874,
                "test_acc_syn": 0.5126262626262627,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.277067294716835
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.87275,
                "test_acc_syn": 0.5037878787878788,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.301195367872715
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.876,
                "test_acc_syn": 0.5378787878787878,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.48503740310668947
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.87,
                "test_acc_syn": 0.5315656565656566,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.6601196765899658
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.83175,
                "test_acc_syn": 0.5517676767676768,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.6899162244796753
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.8695,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4828060522696011,
            "val_best_fusion_loss": 0.30265765607357026,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.87925,
                "test_acc_syn": 0.4924346629986245,
                "val_best_acc_fusion": 0.87,
                "val_best_loss_fusion": 0.31171867370605466
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8695,
                "test_acc_syn": 0.4828060522696011,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.30265765607357026
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.874,
                "test_acc_syn": 0.5226960110041265,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.4846840047836304
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.85375,
                "test_acc_syn": 0.530949105914718,
                "val_best_acc_fusion": 0.855,
                "val_best_loss_fusion": 0.661667423248291
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.81725,
                "test_acc_syn": 0.5116918844566712,
                "val_best_acc_fusion": 0.875,
                "val_best_loss_fusion": 0.6900005269050599
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.8555,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5,
            "val_best_fusion_loss": 0.3220003092288971,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8555,
                "test_acc_syn": 0.5,
                "val_best_acc_fusion": 0.88,
                "val_best_loss_fusion": 0.3220003092288971
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.861,
                "test_acc_syn": 0.49501246882793015,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.3516891652345657
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.85675,
                "test_acc_syn": 0.4850374064837905,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.4723085117340088
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.868,
                "test_acc_syn": 0.5087281795511222,
                "val_best_acc_fusion": 0.86,
                "val_best_loss_fusion": 0.662639901638031
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.84025,
                "test_acc_syn": 0.49875311720698257,
                "val_best_acc_fusion": 0.835,
                "val_best_loss_fusion": 0.6903728985786438
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.1,
        "psyn": 0.2,
        "pu1": 0.7,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5036067516498145,
          "test_syn_std": 0.006508671478799602,
          "test_tot_mean": 0.8693333333333334,
          "test_tot_std": 0.010300350587345195
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5017674827353691,
          "test_syn_std": 0.006940040792093482,
          "test_tot_mean": 0.8698333333333332,
          "test_tot_std": 0.01077097437044991
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.49847743829862123,
          "test_syn_std": 0.01222156242138637,
          "test_tot_mean": 0.8663333333333334,
          "test_tot_std": 0.007877534865397638
        }
      },
      "timestamp": 1767007993.5509417
    },
    "pu1=0.7000|pu2=0.0000|pred=0.2000|psyn=0.1000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.2,
          "syn": 0.1,
          "u1": 0.7,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.91625,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5328638497652582,
            "val_best_fusion_loss": 0.23708954095840454,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.91625,
                "test_acc_syn": 0.5328638497652582,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.23708954095840454
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.91325,
                "test_acc_syn": 0.5164319248826291,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.23745063424110413
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8195,
                "test_acc_syn": 0.5140845070422535,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.36926409006118777
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.892,
                "test_acc_syn": 0.48826291079812206,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.40565304160118104
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.74025,
                "test_acc_syn": 0.5469483568075117,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.6823520183563232
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.908,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5217391304347826,
            "val_best_fusion_loss": 0.2603638219833374,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.908,
                "test_acc_syn": 0.5217391304347826,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.2603638219833374
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.91125,
                "test_acc_syn": 0.5,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.3026607763767242
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.867,
                "test_acc_syn": 0.5241545893719807,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.4035440731048584
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8925,
                "test_acc_syn": 0.4975845410628019,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.4924148368835449
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.77425,
                "test_acc_syn": 0.5024154589371981,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.6841961431503296
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.90275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5088161209068011,
            "val_best_fusion_loss": 0.21358140408992768,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.904,
                "test_acc_syn": 0.49622166246851385,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.22291409492492675
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.90275,
                "test_acc_syn": 0.5088161209068011,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.21358140408992768
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.868,
                "test_acc_syn": 0.49622166246851385,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.3620975959300995
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.876,
                "test_acc_syn": 0.4811083123425693,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.4224324369430542
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7235,
                "test_acc_syn": 0.5113350125944585,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.6826493072509766
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.916,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5305164319248826
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.9075,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5193236714975845
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.90225,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.49622166246851385
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.91375,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5328638497652582,
            "val_best_fusion_loss": 0.22866321802139283,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.91625,
                "test_acc_syn": 0.5328638497652582,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.23721374392509462
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.91375,
                "test_acc_syn": 0.5328638497652582,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.22866321802139283
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.907,
                "test_acc_syn": 0.5422535211267606,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.4541096842288971
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8755,
                "test_acc_syn": 0.5140845070422535,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.6589809489250184
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8935,
                "test_acc_syn": 0.5070422535211268,
                "val_best_acc_fusion": 0.865,
                "val_best_loss_fusion": 0.6899833178520203
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.90825,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5193236714975845,
            "val_best_fusion_loss": 0.2594413411617279,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.90825,
                "test_acc_syn": 0.5193236714975845,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.2594413411617279
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.90675,
                "test_acc_syn": 0.5217391304347826,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.26773653745651244
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.86875,
                "test_acc_syn": 0.4830917874396135,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.4837351894378662
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.89975,
                "test_acc_syn": 0.4806763285024155,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.6611518383026123
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8195,
                "test_acc_syn": 0.5483091787439613,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.6891837882995605
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.9035,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4987405541561713,
            "val_best_fusion_loss": 0.22397373378276825,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9035,
                "test_acc_syn": 0.4987405541561713,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.22397373378276825
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.89575,
                "test_acc_syn": 0.4811083123425693,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.2315714767575264
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.899,
                "test_acc_syn": 0.5062972292191436,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.448285129070282
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.89925,
                "test_acc_syn": 0.5012594458438288,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.6580694437026977
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8655,
                "test_acc_syn": 0.4760705289672544,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.6898962593078614
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.2,
        "psyn": 0.1,
        "pu1": 0.7,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5211397003689472,
          "test_syn_std": 0.009826589883757203,
          "test_tot_mean": 0.9090000000000001,
          "test_tot_std": 0.0055565276927232
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5153539219636604,
          "test_syn_std": 0.014279402100880361,
          "test_tot_mean": 0.9085833333333334,
          "test_tot_std": 0.005665441043927863
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5169760251396713,
          "test_syn_std": 0.014029336129996796,
          "test_tot_mean": 0.9085000000000001,
          "test_tot_std": 0.004188277291043012
        }
      },
      "timestamp": 1767010602.8237176
    },
    "pu1=0.7000|pu2=0.0000|pred=0.3000|psyn=0.0000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.3,
          "syn": 0.0,
          "u1": 0.7,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.95925,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.1417882776260376,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95925,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.1417882776260376
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.95825,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.14403620898723601
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.935,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.23001790821552276
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9635,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.37677199244499204
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.74925,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.6827241849899292
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.9535,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.08759384632110595,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95725,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.09002614349126815
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9535,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.08759384632110595
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.91875,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.3111415481567383
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.94125,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.43849732875823977
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8055,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.6829065704345703
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.953,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.059155668020248416,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.953,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.059155668020248416
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.951,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.0740198802947998
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.91375,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.3065285611152649
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9385,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.4383448910713196
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.73425,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.6801711368560791
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.9595,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.958,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.95325,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.95975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.11176624059677125,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95925,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.143989919424057
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.95975,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.11176624059677125
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.95375,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.43023048639297484
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.95825,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.6491967248916626
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.91725,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.6896515607833862
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.95775,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.0905670690536499,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95775,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.0905670690536499
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9505,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.1182576608657837
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.942,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.4108278775215149
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.945,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.653783757686615
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.88275,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.6890032386779785
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.9535,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.05875482201576233,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9535,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.05875482201576233
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9485,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.09384015321731567
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.94075,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.41145251274108885
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.94775,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.6517591619491577
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.9215,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.689440598487854
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.3,
        "psyn": 0.0,
        "pu1": 0.7,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9552499999999999,
          "test_tot_std": 0.002835783254528956
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9569166666666667,
          "test_tot_std": 0.0026640612271909454
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.957,
          "test_tot_std": 0.002606082628518638
        }
      },
      "timestamp": 1767013239.3155177
    },
    "pu1=0.8000|pu2=0.0000|pred=0.0000|psyn=0.2000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.0,
          "syn": 0.2,
          "u1": 0.8,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.90225,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5212903225806451,
            "val_best_fusion_loss": 0.23854790568351747,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.90275,
                "test_acc_syn": 0.5290322580645161,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.24605473279953002
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.90225,
                "test_acc_syn": 0.5212903225806451,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.23854790568351747
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.844,
                "test_acc_syn": 0.5045161290322581,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.31380064964294435
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.883,
                "test_acc_syn": 0.5109677419354839,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.3378061032295227
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.798,
                "test_acc_syn": 0.5251612903225806,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.6817778134346009
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.908,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5164383561643836,
            "val_best_fusion_loss": 0.23167316257953643,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.908,
                "test_acc_syn": 0.5164383561643836,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.23167316257953643
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.90825,
                "test_acc_syn": 0.5232876712328767,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.24438190698623657
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8685,
                "test_acc_syn": 0.5260273972602739,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.3525978899002075
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.892,
                "test_acc_syn": 0.4931506849315068,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.3392627727985382
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.74325,
                "test_acc_syn": 0.5013698630136987,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.6845948791503906
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.89475,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.47058823529411764,
            "val_best_fusion_loss": 0.19628526628017426,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.89475,
                "test_acc_syn": 0.47058823529411764,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.19628526628017426
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.8935,
                "test_acc_syn": 0.465359477124183,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.1989489623904228
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8615,
                "test_acc_syn": 0.47581699346405226,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.30760611772537233
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.85725,
                "test_acc_syn": 0.5019607843137255,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.3885045123100281
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7265,
                "test_acc_syn": 0.5124183006535947,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.6817087697982788
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.90225,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5238709677419355
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.9075,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5150684931506849
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.89525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.4718954248366013
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.90225,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5264516129032258,
            "val_best_fusion_loss": 0.24678643941879272,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.90225,
                "test_acc_syn": 0.5264516129032258,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.24678643941879272
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.90525,
                "test_acc_syn": 0.52,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.24924661040306093
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.90375,
                "test_acc_syn": 0.5174193548387097,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.4481797766685486
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.8915,
                "test_acc_syn": 0.5290322580645161,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.6577913427352905
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.87575,
                "test_acc_syn": 0.5535483870967742,
                "val_best_acc_fusion": 0.895,
                "val_best_loss_fusion": 0.6895930647850037
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.90175,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5150684931506849,
            "val_best_fusion_loss": 0.23078952133655548,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.90175,
                "test_acc_syn": 0.5150684931506849,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.23078952133655548
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.90175,
                "test_acc_syn": 0.5,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.23584634482860564
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8415,
                "test_acc_syn": 0.5287671232876713,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.47441218614578246
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9095,
                "test_acc_syn": 0.5273972602739726,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.6591917252540589
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.85475,
                "test_acc_syn": 0.5273972602739726,
                "val_best_acc_fusion": 0.905,
                "val_best_loss_fusion": 0.6898922967910767
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.8955,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.47320261437908495,
            "val_best_fusion_loss": 0.19516202241182326,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.8955,
                "test_acc_syn": 0.47320261437908495,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.19516202241182326
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.895,
                "test_acc_syn": 0.47320261437908495,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.21989807188510896
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.86975,
                "test_acc_syn": 0.46405228758169936,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.4395603930950165
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.862,
                "test_acc_syn": 0.5372549019607843,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.6574461507797241
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.86125,
                "test_acc_syn": 0.4627450980392157,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.689629852771759
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.0,
        "psyn": 0.2,
        "pu1": 0.8,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5027723046797155,
          "test_syn_std": 0.02284361524494847,
          "test_tot_mean": 0.9016666666666667,
          "test_tot_std": 0.00542499359958659
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5036116285764073,
          "test_syn_std": 0.022712831534634985,
          "test_tot_mean": 0.9016666666666667,
          "test_tot_std": 0.005018023072441526
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5049075734776652,
          "test_syn_std": 0.0228953732939963,
          "test_tot_mean": 0.8998333333333334,
          "test_tot_std": 0.0030709209621147403
        }
      },
      "timestamp": 1767015901.7930615
    },
    "pu1=0.8000|pu2=0.0000|pred=0.1000|psyn=0.1000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.1,
          "syn": 0.1,
          "u1": 0.8,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.9245,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5343137254901961,
            "val_best_fusion_loss": 0.19726433634757995,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.919,
                "test_acc_syn": 0.5294117647058824,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.20402618497610092
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9245,
                "test_acc_syn": 0.5343137254901961,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.19726433634757995
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.86575,
                "test_acc_syn": 0.4730392156862745,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.28620418787002566
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.907,
                "test_acc_syn": 0.49754901960784315,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.32575846433639527
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7325,
                "test_acc_syn": 0.45098039215686275,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.6812101650238037
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.91725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5226130653266332,
            "val_best_fusion_loss": 0.2522166919708252,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.91725,
                "test_acc_syn": 0.5226130653266332,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.2522166919708252
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.92025,
                "test_acc_syn": 0.4949748743718593,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.26199996054172514
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8735,
                "test_acc_syn": 0.5050251256281407,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.357561891078949
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.91325,
                "test_acc_syn": 0.5,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.41097733020782473
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7375,
                "test_acc_syn": 0.5226130653266332,
                "val_best_acc_fusion": 0.89,
                "val_best_loss_fusion": 0.683590669631958
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.91525,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.47493403693931396,
            "val_best_fusion_loss": 0.16210617244243622,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.91525,
                "test_acc_syn": 0.47493403693931396,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.16210617244243622
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.91325,
                "test_acc_syn": 0.46437994722955145,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.16584450423717498
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.8605,
                "test_acc_syn": 0.5092348284960422,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.3401695740222931
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.91975,
                "test_acc_syn": 0.49076517150395776,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.35931629180908203
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.78325,
                "test_acc_syn": 0.49340369393139843,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.6827453327178955
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.919,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5269607843137255
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.91725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5226130653266332
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.915,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.47757255936675463
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.92,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5294117647058824,
            "val_best_fusion_loss": 0.2008533474802971,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.91875,
                "test_acc_syn": 0.5245098039215687,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.20384294629096986
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.92,
                "test_acc_syn": 0.5294117647058824,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.2008533474802971
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.91125,
                "test_acc_syn": 0.5318627450980392,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.4276451563835144
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.92125,
                "test_acc_syn": 0.5343137254901961,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.6549509572982788
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.90175,
                "test_acc_syn": 0.5245098039215687,
                "val_best_acc_fusion": 0.9,
                "val_best_loss_fusion": 0.6895273923873901
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.9165,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5226130653266332,
            "val_best_fusion_loss": 0.24058731973171235,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.91725,
                "test_acc_syn": 0.5201005025125628,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.2536806946992874
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9165,
                "test_acc_syn": 0.5226130653266332,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.24058731973171235
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.91675,
                "test_acc_syn": 0.4949748743718593,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.4628102135658264
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.91925,
                "test_acc_syn": 0.5100502512562815,
                "val_best_acc_fusion": 0.925,
                "val_best_loss_fusion": 0.6569239377975464
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.9035,
                "test_acc_syn": 0.5326633165829145,
                "val_best_acc_fusion": 0.91,
                "val_best_loss_fusion": 0.6896464610099793
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 2,
            "test_acc_fusion": 0.91425,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.45382585751978893,
            "val_best_fusion_loss": 0.16100921988487243,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.91525,
                "test_acc_syn": 0.47757255936675463,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.16359039664268493
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.91425,
                "test_acc_syn": 0.45382585751978893,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.16100921988487243
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.90675,
                "test_acc_syn": 0.46965699208443273,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.43221915006637573
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.904,
                "test_acc_syn": 0.47757255936675463,
                "val_best_acc_fusion": 0.935,
                "val_best_loss_fusion": 0.6547301244735718
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.8895,
                "test_acc_syn": 0.5356200527704486,
                "val_best_acc_fusion": 0.915,
                "val_best_loss_fusion": 0.6893546843528747
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.1,
        "psyn": 0.1,
        "pu1": 0.8,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5106202759187144,
          "test_syn_std": 0.025682122205105462,
          "test_tot_mean": 0.919,
          "test_tot_std": 0.003973873005855446
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5090488030023711,
          "test_syn_std": 0.022327727159359444,
          "test_tot_mean": 0.9170833333333334,
          "test_tot_std": 0.0016372402253657088
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5019502291841015,
          "test_syn_std": 0.03414207511147127,
          "test_tot_mean": 0.9169166666666667,
          "test_tot_std": 0.002365844927763081
        }
      },
      "timestamp": 1767018535.0637598
    },
    "pu1=0.8000|pu2=0.0000|pred=0.2000|psyn=0.0000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.2,
          "syn": 0.0,
          "u1": 0.8,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.963,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.11562074571847916,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.963,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.11562074571847916
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9635,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.13367745280265808
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.92725,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.23572932183742523
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.96425,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.995,
                "val_best_loss_fusion": 0.365067218542099
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.80325,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.681043667793274
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.96275,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.09120983541011811,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95825,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.10693266898393632
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.96275,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.09120983541011811
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9195,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.28817602872848513
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.967,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.4117476511001587
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.77425,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.6843393206596374
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.95375,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.04607599854469299,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95375,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.04607599854469299
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.96075,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.06491405248641968
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.92575,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.29524779319763184
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.944,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.3938533616065979
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.79475,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.6783704853057861
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.963,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.9585,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.9535,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.965,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.10716498017311096,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.96325,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.1156889769434929
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.965,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.10716498017311096
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.96375,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.4306333816051483
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.961,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.6504015302658082
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.92275,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.93,
                "val_best_loss_fusion": 0.6895317983627319
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.9585,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.10820542275905609,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9585,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.10820542275905609
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.949,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.12499753475189208
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.95875,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.4158173811435699
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.957,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.6534203505516052
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.94175,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.6890891218185424
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.9535,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.045446356534957884,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9535,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.045446356534957884
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9585,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.07675955832004547
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.94225,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.4163277804851532
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9525,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.6496693563461303
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.93825,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.6894493889808655
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.2,
        "psyn": 0.0,
        "pu1": 0.8,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9598333333333332,
          "test_tot_std": 0.004302776881141859
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9583333333333334,
          "test_tot_std": 0.0038801489089409194
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.959,
          "test_tot_std": 0.004708148963941825
        }
      },
      "timestamp": 1767021166.6153927
    },
    "pu1=0.9000|pu2=0.0000|pred=0.0000|psyn=0.1000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.0,
          "syn": 0.1,
          "u1": 0.9,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.94675,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5203836930455635,
            "val_best_fusion_loss": 0.1603301042318344,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.94675,
                "test_acc_syn": 0.5203836930455635,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.1603301042318344
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.94525,
                "test_acc_syn": 0.486810551558753,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.17194012463092803
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.934,
                "test_acc_syn": 0.5371702637889688,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.2514882445335388
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.922,
                "test_acc_syn": 0.4580335731414868,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.3100795710086823
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.891,
                "test_acc_syn": 0.5227817745803357,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.6796142315864563
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.952,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48746518105849584,
            "val_best_fusion_loss": 0.16823698371648788,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.952,
                "test_acc_syn": 0.48746518105849584,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.16823698371648788
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.951,
                "test_acc_syn": 0.4958217270194986,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.17210772275924682
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.92725,
                "test_acc_syn": 0.467966573816156,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.26562864005565645
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9415,
                "test_acc_syn": 0.4401114206128134,
                "val_best_acc_fusion": 0.95,
                "val_best_loss_fusion": 0.3331977903842926
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.7495,
                "test_acc_syn": 0.5041782729805014,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.6831657123565674
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.9485,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5085995085995086,
            "val_best_fusion_loss": 0.08835863992571831,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9485,
                "test_acc_syn": 0.5085995085995086,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.08835863992571831
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.94725,
                "test_acc_syn": 0.5208845208845209,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.11373046994209289
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9305,
                "test_acc_syn": 0.4987714987714988,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.24976773977279662
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.934,
                "test_acc_syn": 0.5135135135135135,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.3248942017555237
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.87125,
                "test_acc_syn": 0.5012285012285013,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.678857684135437
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.947,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5227817745803357
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.952,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48746518105849584
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.9485,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5085995085995086
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.94675,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5203836930455635,
            "val_best_fusion_loss": 0.16112813353538513,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.94675,
                "test_acc_syn": 0.5203836930455635,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.16112813353538513
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.94025,
                "test_acc_syn": 0.4676258992805755,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.17720614790916442
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.94325,
                "test_acc_syn": 0.47961630695443647,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.4486940586566925
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.94525,
                "test_acc_syn": 0.5035971223021583,
                "val_best_acc_fusion": 0.96,
                "val_best_loss_fusion": 0.6565249109268189
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.927,
                "test_acc_syn": 0.48201438848920863,
                "val_best_acc_fusion": 0.92,
                "val_best_loss_fusion": 0.6895732593536377
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.95175,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.48746518105849584,
            "val_best_fusion_loss": 0.1693738929182291,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.95175,
                "test_acc_syn": 0.48746518105849584,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.1693738929182291
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.95025,
                "test_acc_syn": 0.5069637883008357,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.17217333897948264
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.942,
                "test_acc_syn": 0.4735376044568245,
                "val_best_acc_fusion": 0.945,
                "val_best_loss_fusion": 0.4348781657218933
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9395,
                "test_acc_syn": 0.49303621169916434,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.6541423535346985
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.934,
                "test_acc_syn": 0.49303621169916434,
                "val_best_acc_fusion": 0.94,
                "val_best_loss_fusion": 0.6893529605865478
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.949,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": 0.5135135135135135,
            "val_best_fusion_loss": 0.08852053895592689,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.949,
                "test_acc_syn": 0.5135135135135135,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.08852053895592689
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.941,
                "test_acc_syn": 0.5282555282555282,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.09107317388057709
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9475,
                "test_acc_syn": 0.5307125307125307,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.4085696542263031
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.94275,
                "test_acc_syn": 0.5012285012285013,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.6489804553985595
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.9355,
                "test_acc_syn": 0.4914004914004914,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.6889787411689758
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.0,
        "psyn": 0.1,
        "pu1": 0.9,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5054827942345227,
          "test_syn_std": 0.013618432097353993,
          "test_tot_mean": 0.9490833333333333,
          "test_tot_std": 0.0021826334756181198
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5062821547461134,
          "test_syn_std": 0.014510755577802731,
          "test_tot_mean": 0.9491666666666667,
          "test_tot_std": 0.002094967514996085
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": 0.5071207958725243,
          "test_syn_std": 0.014178792543531124,
          "test_tot_mean": 0.9491666666666666,
          "test_tot_std": 0.0020446406910642188
        }
      },
      "timestamp": 1767023804.4028692
    },
    "pu1=0.9000|pu2=0.0000|pred=0.1000|psyn=0.0000|pnone=0.0000": {
      "cfg": {
        "batch_size": 64,
        "device": "cuda",
        "dim0": 32,
        "dim1": 32,
        "epochs": 50,
        "frac_red": 0.2,
        "frac_syn": 0.2,
        "frac_unique": 0.2,
        "hidden": 256,
        "inv_destroy_red": true,
        "inv_destroy_unique": true,
        "lambda_kl": 10.0,
        "lambda_shortcut_inv": 0.0,
        "lambda_uni": 0.0,
        "latent_r": 4,
        "latent_s": 1,
        "latent_u": 4,
        "lr": 0.0005,
        "n_test": 4000,
        "n_train": 2000,
        "noise_std": 1.0,
        "out_dir": "runs_refactor",
        "random_block_positions": false,
        "red_strength": 1.0,
        "signal_probs": {
          "red": 0.1,
          "syn": 0.0,
          "u1": 0.9,
          "u2": 0.0
        },
        "syn_strength": 1.0,
        "unique_strength": 1.0,
        "weight_decay_synib": 1e-05
      },
      "kl_vals": [
        0.01,
        0.1,
        1.0,
        10.0,
        100.0
      ],
      "per_seed": {
        "learned_tuned": [
          {
            "best_lambda_kl": 0.01,
            "seed": 0,
            "test_acc_fusion": 0.97475,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.041417425842955706,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.97475,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.041417425842955706
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.97425,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.0738078612089157
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.94175,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.19614938139915467
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9695,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.99,
                "val_best_loss_fusion": 0.295955513715744
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.75425,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.6791394901275635
              }
            ]
          },
          {
            "best_lambda_kl": 0.1,
            "seed": 1,
            "test_acc_fusion": 0.9805,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.07949658825993539,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9745,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.09129809401929379
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9805,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.07949658825993539
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.93475,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.2603763437271118
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.97025,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 1.0,
                "val_best_loss_fusion": 0.34177552938461303
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.76375,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.6825618600845337
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.9695,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.03280871098861098,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9695,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.03280871098861098
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9695,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.06731763355433941
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.948,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.28532238721847536
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.97225,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.327780544757843
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.768,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.6772869968414307
              }
            ]
          }
        ],
        "main": [
          {
            "seed": 0,
            "test_acc_fusion": 0.975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 1,
            "test_acc_fusion": 0.97475,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          },
          {
            "seed": 2,
            "test_acc_fusion": 0.96725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN
          }
        ],
        "synib_tuned": [
          {
            "best_lambda_kl": 0.1,
            "seed": 0,
            "test_acc_fusion": 0.97375,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.03542166955769062,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.9745,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.04280572799732909
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.97375,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.995,
                "val_best_loss_fusion": 0.03542166955769062
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.955,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.995,
                "val_best_loss_fusion": 0.41111777782440184
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.97375,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.6487998294830323
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.96075,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.955,
                "val_best_loss_fusion": 0.6893485283851624
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 1,
            "test_acc_fusion": 0.975,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.09152461532503367,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.975,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.09152461532503367
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.97375,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.10118994817137718
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.9775,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.4133668887615204
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9725,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.6507864594459534
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.96375,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.98,
                "val_best_loss_fusion": 0.6890199208259582
              }
            ]
          },
          {
            "best_lambda_kl": 0.01,
            "seed": 2,
            "test_acc_fusion": 0.96725,
            "test_acc_parts": {
              "red": NaN,
              "syn": NaN,
              "u1": NaN,
              "u2": NaN
            },
            "test_acc_syn": NaN,
            "val_best_fusion_loss": 0.05030182842165232,
            "val_table": [
              {
                "lambda_kl": 0.01,
                "test_acc_fusion": 0.96725,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.985,
                "val_best_loss_fusion": 0.05030182842165232
              },
              {
                "lambda_kl": 0.1,
                "test_acc_fusion": 0.9685,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.975,
                "val_best_loss_fusion": 0.06948948077857495
              },
              {
                "lambda_kl": 1.0,
                "test_acc_fusion": 0.95925,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.965,
                "val_best_loss_fusion": 0.41996877431869506
              },
              {
                "lambda_kl": 10.0,
                "test_acc_fusion": 0.9675,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.6508155155181885
              },
              {
                "lambda_kl": 100.0,
                "test_acc_fusion": 0.95025,
                "test_acc_syn": NaN,
                "val_best_acc_fusion": 0.97,
                "val_best_loss_fusion": 0.689262912273407
              }
            ]
          }
        ]
      },
      "probs": {
        "pnone": 0.0,
        "pred": 0.1,
        "psyn": 0.0,
        "pu1": 0.9,
        "pu2": 0.0
      },
      "seeds": [
        0,
        1,
        2
      ],
      "summary_meanstd": {
        "learned_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9749166666666667,
          "test_tot_std": 0.004492277323981189
        },
        "main": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.9723333333333333,
          "test_tot_std": 0.0035959081683985396
        },
        "synib_tuned": {
          "parts_meanstd": {
            "red": {
              "mean": NaN,
              "std": NaN
            },
            "syn": {
              "mean": NaN,
              "std": NaN
            },
            "u1": {
              "mean": NaN,
              "std": NaN
            },
            "u2": {
              "mean": NaN,
              "std": NaN
            }
          },
          "test_syn_mean": NaN,
          "test_syn_std": NaN,
          "test_tot_mean": 0.972,
          "test_tot_std": 0.00339730285177322
        }
      },
      "timestamp": 1767026433.9418986
    }
  },
  "schema": "sweep_nonoverlap_probs_v2"
}